<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent 06 - Teacher Feedback Panel Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f8fafc;
            padding: 20px;
        }
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e293b;
            margin-bottom: 10px;
        }
        .info {
            color: #64748b;
            margin-bottom: 20px;
            padding: 15px;
            background: #f1f5f9;
            border-radius: 8px;
        }
        .test-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        #panel-container {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            min-height: 600px;
            padding: 20px;
        }
        .log {
            margin-top: 20px;
            padding: 15px;
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 3px 8px;
            border-left: 3px solid #3b82f6;
            padding-left: 10px;
        }
        .log-entry.error { border-left-color: #ef4444; color: #fca5a5; }
        .log-entry.success { border-left-color: #10b981; color: #6ee7b7; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª Agent 06 - Teacher Feedback Panel Test</h1>
        <div class="info">
            <p><strong>í…ŒìŠ¤íŠ¸ ëª©ì :</strong> Agent 06 ì„ ìƒë‹˜ í”¼ë“œë°± íŒ¨ë„ì´ ì œëŒ€ë¡œ ë¡œë“œë˜ê³  ë™ì‘í•˜ëŠ”ì§€ í™•ì¸</p>
            <p><strong>íŒŒì¼ ìœ„ì¹˜:</strong> /agents/agent06_teacher_feedback/ui/teacher_feedback_panel.php</p>
            <p><strong>ì„œë²„ URL:</strong> https://mathking.kr/moodle/local/augmented_teacher/alt42/orchestration/</p>
        </div>

        <button class="test-btn" onclick="loadPanel()">
            ğŸ“¥ Agent 06 íŒ¨ë„ ë¡œë“œ
        </button>

        <div id="panel-container">
            <p style="text-align: center; color: #94a3b8; padding: 40px;">
                ìœ„ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ Agent 06 íŒ¨ë„ì„ ë¡œë“œí•˜ì„¸ìš”.
            </p>
        </div>

        <div class="log" id="log-area">
            <div class="log-entry">í…ŒìŠ¤íŠ¸ ì‹œì‘...</div>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logArea = document.getElementById('log-area');
            const timestamp = new Date().toLocaleTimeString('ko-KR');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        async function loadPanel() {
            log('Agent 06 íŒ¨ë„ ë¡œë“œ ì‹œì‘...', 'info');
            const container = document.getElementById('panel-container');

            try {
                const response = await fetch('agents/agent06_teacher_feedback/ui/teacher_feedback_panel.php');

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const html = await response.text();
                log('HTML ë¡œë“œ ì™„ë£Œ (' + html.length + ' bytes)', 'success');

                container.innerHTML = html;
                log('íŒ¨ë„ ë Œë”ë§ ì™„ë£Œ', 'success');

                // ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
                const scripts = container.querySelectorAll('script');
                log(`ìŠ¤í¬ë¦½íŠ¸ ${scripts.length}ê°œ ë°œê²¬`, 'info');

                scripts.forEach((script, index) => {
                    try {
                        const newScript = document.createElement('script');
                        if (script.src) {
                            newScript.src = script.src;
                            log(`ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ: ${script.src}`, 'info');
                        } else {
                            newScript.textContent = script.textContent;
                            log(`ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ${index + 1} ì‹¤í–‰`, 'success');
                        }
                        document.body.appendChild(newScript);
                    } catch (e) {
                        log(`ìŠ¤í¬ë¦½íŠ¸ ${index + 1} ì‹¤í–‰ ì˜¤ë¥˜: ${e.message}`, 'error');
                    }
                });

                // agent06 ê°ì²´ í™•ì¸
                setTimeout(() => {
                    if (window.agent06) {
                        log('âœ… window.agent06 ê°ì²´ ì´ˆê¸°í™” ì™„ë£Œ', 'success');
                        log(`- userId: ${window.agent06.userId}`, 'info');
                        log(`- currentPeriod: ${window.agent06.currentPeriod}`, 'info');
                    } else {
                        log('âš ï¸ window.agent06 ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'error');
                    }
                }, 500);

            } catch (error) {
                log(`íŒ¨ë„ ë¡œë“œ ì‹¤íŒ¨: ${error.message}`, 'error');
                container.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #ef4444;">
                        <p style="font-size: 18px; margin-bottom: 10px;">âŒ ë¡œë“œ ì‹¤íŒ¨</p>
                        <p style="font-size: 14px; color: #6b7280;">${error.message}</p>
                        <p style="font-size: 12px; color: #94a3b8; margin-top: 10px;">
                            íŒŒì¼ ê²½ë¡œë¥¼ í™•ì¸í•˜ì„¸ìš”: agents/agent06_teacher_feedback/ui/teacher_feedback_panel.php
                        </p>
                    </div>
                `;
            }
        }

        log('í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'success');
    </script>
</body>
</html>
