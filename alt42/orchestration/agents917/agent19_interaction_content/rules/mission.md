# Agent 19 - Interaction Content Mission

## 목적 (Purpose)
**맞춤형 상호작용 컨텐츠 생성 및 패키징**: 
1. 취합된 내용(이전 단계의 모든 분석 결과)을 토대로 최적의 상호작용 유형을 알고리즘으로 자동 선택
2. 선택된 상호작용 방법에 맞게 상호작용 내용을 패키징하여 제공
3. 실제로 코딩으로 컨텐츠를 생성하여 발송 준비를 완료

**Frequency**: Medium (intervention triggers)  
**Complexity**: Very High

**핵심 원칙**: 
- **수학 학습 컨텐츠 생성 금지**: Agent는 수학 학습 컨텐츠를 직접 생성하지 않습니다. 모든 학습 컨텐츠는 룰 파일(`rules.yaml`)을 통해 링크로만 제공됩니다.
- **상호작용 템플릿 생성 집중**: 이 에이전트는 7가지 상호작용 유형(텍스트 전달, 상호작용 컨텐츠, 학습루틴 개선, 타임쉬프팅, 활동반려 또는 학습지점 변경, 멀티턴 상호작용, 비선형 상호작용 알고리즘)에 맞는 맞춤형 템플릿을 생성하여 사용합니다.
- **알고리즘 기반 유형 선택**: 취합된 모든 정보를 종합하여 최적의 상호작용 유형을 알고리즘으로 자동 선택합니다.
- **템플릿 우선 재사용**: 기존 템플릿을 우선 조사하여 활용하고, 필요시 새로운 맞춤형 템플릿을 생성하여 사용하며, 이후 템플릿 라이브러리에 추가합니다.

## 입력 (Inputs)
- `analysis_summary`: 이전 단계의 모든 분석 결과 통합
- `user_profile`: MBTI, 선호도, 스타일, 집중력 시간대
- `current_situation`: 현재 사용자가 직면한 구체적인 상황/문제
- `content_constraints`: 시간 제약, 난이도 범위, 형식 요구사항
- `rules_file`: `rules.yaml` 파일 - 컨텐츠 시스템 링크 매핑 정보

## 출력 (Outputs)
- `interaction_type`: 알고리즘 자동 선택된 상호작용 유형
- `packaged_interaction_content`: 패키징된 상호작용 컨텐츠 (실제 코드로 구현된 컨텐츠)
- `content_links`: 룰 파일에 의해 제공된 컨텐츠 시스템 링크 목록
- `delivery_method`: "text, visual, interactive, audio"
- `execution_scenario`: 단계별 전달 계획
- `interaction_template`: 사용된 템플릿 (기존 또는 신규 생성)
- `generated_code`: 생성된 HTML/CSS/JavaScript 코드
- `delivery_ready`: 발송 준비 완료 상태
- `tracking_metrics`: 상호작용 결과 추적 데이터
- `effectiveness_analysis`: 효과 분석 결과

## 원칙 (Principles)
1. **수학 학습 컨텐츠 생성 금지**: 수학 학습 컨텐츠는 생성하지 않으며, 룰 파일을 통한 링크 제공만 수행
2. **상호작용 템플릿 생성 집중**: 7가지 상호작용 유형에 맞는 맞춤형 템플릿 생성에 집중
3. **알고리즘 기반 유형 선택**: 취합된 모든 정보를 종합하여 최적의 상호작용 유형을 알고리즘으로 자동 선택
4. **패키징 중심**: 선택된 상호작용 유형에 맞게 상호작용 템플릿을 체계적으로 패키징
5. **코드 생성 및 발송 준비**: 실제 실행 가능한 코드(HTML/CSS/JavaScript)로 상호작용 템플릿을 생성하여 발송 준비 완료
6. **템플릿 우선 재사용**: 기존 템플릿을 우선 조사하여 활용하고, 필요시에만 신규 맞춤형 템플릿 생성
7. **템플릿 라이브러리 관리**: 생성된 신규 템플릿을 라이브러리에 추가하여 지속적 개선
8. **룰 기반 링크 제공**: 모든 학습 컨텐츠 링크는 `rules.yaml` 파일에 정의된 내용을 참조하여 제공
9. **컨텐츠 시스템 연동**: 학습 컨텐츠는 별도 컨텐츠 시스템과 연결, Agent는 링크만 제공
10. **개인화 정확도**: MBTI 기반 상호작용 스타일 맞춤화

## 상호작용 유형 (Interaction Types) - 알고리즘 자동 선택

### 선택 프로세스
Agent는 **취합된 모든 내용**(이전 단계의 분석 결과, 사용자 프로필, 현재 상황 등)을 종합 분석하여 최적의 상호작용 유형을 알고리즘으로 자동 선택합니다.

### 선택 가능한 상호작용 유형
1. **텍스트 전달**: 정보 전달 중심의 간단한 텍스트 기반 상호작용
2. **상호작용 컨텐츠**: 사용자와의 실시간 상호작용이 필요한 동적 컨텐츠
3. **학습루틴 개선**: 활동 패턴 및 루틴을 개선하기 위한 가이드 제공
4. **타임쉬프팅**: 시간대나 진행 속도를 조절하는 상호작용
5. **활동반려 또는 학습지점 변경**: 현재 활동을 중단하고 다른 활동 지점으로 이동 지시
6. **멀티턴 상호작용**: 여러 번의 상호작용을 통한 점진적 진행 유도
7. **비선형 상호작용 알고리즘**: 사용자의 반응에 따라 동적으로 경로가 변경되는 복합 상호작용

### 선택 알고리즘 기준
- **상황 적합성**: 현재 상황에 가장 적합한 상호작용 방식
- **사용자 프로필**: MBTI, 선호도, 학습 스타일 등 개인 특성
- **목표 정렬**: 단기/장기 목표 달성에 가장 효과적인 방식
- **효과성 예측**: 과거 데이터 기반 효과성 예측
- **리소스 효율성**: 시간, 복잡도, 리소스 제약 고려

### 활동반려/이동 메커니즘
- **평가 후 반려**: 현재 활동의 적합성 평가를 통해 반려 결정
- **점진적 예고 시스템**: 1차 → 2차 → 3차 예고 후 실행 (충분한 준비 시간 제공)
- **활동지점 변경**: 룰 파일에 정의된 대안 활동 링크로 안내

## 상호작용 템플릿 생성 및 패키징 전략 (Interaction Template Generation & Packaging)

### 중요: 수학 학습 컨텐츠는 생성하지 않음
- **학습 컨텐츠 생성 금지**: 수학 문제, 학습 자료, 교육 컨텐츠 등은 직접 생성하지 않습니다.
- **링크 제공만 수행**: 모든 학습 컨텐츠는 `rules.yaml` 파일에 정의된 링크를 통해 제공됩니다.
- **상호작용 템플릿만 생성**: 이 에이전트는 상호작용을 위한 템플릿만 생성합니다.

### 1. 상호작용 템플릿 관리 프로세스
- **기존 템플릿 조사**: 먼저 기존 템플릿 라이브러리에서 선택된 상호작용 유형에 맞는 템플릿 검색
- **템플릿 재사용**: 기존 템플릿이 적합하면 해당 템플릿 활용
- **맞춤형 템플릿 생성**: 기존 템플릿이 없거나 부적합한 경우, 선택된 상호작용 유형에 맞는 새로운 맞춤형 템플릿 생성
  - 7가지 상호작용 유형별로 특화된 템플릿 생성
  - 사용자 특성(MBTI, 선호도 등)에 맞게 개인화
- **템플릿 라이브러리 업데이트**: 생성된 신규 템플릿을 템플릿 라이브러리에 추가하여 재사용 가능하도록 관리

### 2. 상호작용 템플릿 패키징
- **선택된 유형에 맞는 패키징**: 알고리즘이 선택한 상호작용 유형에 최적화된 구조로 템플릿 패키징
- **코드 생성**: HTML, CSS, JavaScript 등 실제 실행 가능한 코드로 상호작용 템플릿 생성
- **룰 파일 참조**: `rules.yaml` 파일을 읽어 학습 컨텐츠 시스템 링크 조회
- **링크 통합**: 룰에 정의된 학습 컨텐츠 링크를 상호작용 템플릿에 자연스럽게 통합

### 3. 발송 준비 완료
- **코드 검증**: 생성된 상호작용 템플릿 코드의 문법 및 실행 가능성 검증
- **패키징 완료**: 모든 요소(상호작용 템플릿 코드, 학습 컨텐츠 링크, 메타데이터)가 포함된 완전한 패키지 생성
- **발송 준비 상태**: 즉시 발송 가능한 상태로 최종화

## 상호작용 템플릿 관리 (Interaction Template Management)

### 템플릿 라이브러리 구조
이 에이전트는 **7가지 상호작용 유형**에 맞는 맞춤형 템플릿을 생성하고 관리합니다:

1. **텍스트 전달 템플릿**: 정보 전달 중심의 간단한 텍스트 기반 상호작용 템플릿
2. **상호작용 컨텐츠 템플릿**: 사용자와의 실시간 상호작용이 필요한 동적 컨텐츠 템플릿
3. **학습루틴 개선 템플릿**: 활동 패턴 및 루틴을 개선하기 위한 가이드 제공 템플릿
4. **타임쉬프팅 템플릿**: 시간대나 진행 속도를 조절하는 상호작용 템플릿
5. **활동반려 또는 학습지점 변경 템플릿**: 현재 활동을 중단하고 다른 활동 지점으로 이동 지시하는 템플릿
6. **멀티턴 상호작용 템플릿**: 여러 번의 상호작용을 통한 점진적 진행 유도 템플릿
7. **비선형 상호작용 알고리즘 템플릿**: 사용자의 반응에 따라 동적으로 경로가 변경되는 복합 상호작용 템플릿

**중요**: 각 템플릿은 수학 학습 컨텐츠를 포함하지 않으며, 룰 파일에서 제공된 학습 컨텐츠 링크만 포함합니다.

### 템플릿 사용 프로세스
1. **템플릿 검색**: 선택된 상호작용 유형에 맞는 기존 템플릿 검색
2. **적합성 평가**: 기존 템플릿이 현재 상황에 적합한지 평가
3. **템플릿 선택/생성**: 
   - 기존 템플릿이 적합하면 → 재사용
   - 기존 템플릿이 없거나 부적합하면 → 신규 템플릿 생성
4. **템플릿 커스터마이징**: 선택/생성된 템플릿을 사용자 특성에 맞게 개인화
5. **템플릿 등록**: 신규 생성된 템플릿을 템플릿 라이브러리에 등록하여 재사용 가능하도록 관리

### 템플릿 메타데이터
각 템플릿은 다음 메타데이터를 포함합니다:
- `template_id`: 고유 식별자
- `interaction_type`: 적용 가능한 상호작용 유형
- `created_date`: 생성일
- `usage_count`: 사용 횟수
- `effectiveness_score`: 효과성 점수
- `code_structure`: 코드 구조 설명

**중요 원칙**: 
- **수학 학습 컨텐츠 템플릿은 생성하지 않음**: 수학 학습 컨텐츠는 별도 컨텐츠 시스템에서 관리되며, Agent는 룰 파일을 통해 해당 시스템의 링크만 제공합니다.
- **상호작용 템플릿만 생성**: 이 에이전트는 7가지 상호작용 유형에 맞는 상호작용 템플릿만 생성합니다.

## 사용자 특성 기반 맞춤화
- **집중력 시간대**: 최적 집중 시간대에 맞는 상호작용 시점 선택
- **MBTI 기반 스타일**: 개인 성향에 맞는 상호작용 방식 적용
- **선호도 반영**: 사용자의 선호 상호작용 유형 고려
- **상황 적응**: 현재 활동 상태에 맞는 상호작용 강도 조절

## 상호작용 방식 (Interaction Methods)
- **룰 기반 링크 제공**: `rules.yaml` 파일을 참조하여 컨텐츠 시스템 링크 제공
- **즉각적인 피드백 제공**: 상호작용 행동에 대한 즉시 피드백 제공
- **상호작용 결과 추적**: 각 상호작용의 효과 및 사용자 반응 데이터 수집
- **효과 분석**: 추적된 데이터를 기반으로 상호작용의 효과성 분석
- **연쇄 패드백**: 분석 결과를 다음 상호작용에 반영하는 연쇄적 피드백 루프
- **행동변화 유도**: 추적과 연쇄 패드백을 통한 지속적인 행동 개선
- **컨텐츠 시스템 연동**: 룰 파일에 정의된 링크를 통해 컨텐츠 자료는 별도 시스템에서 제공

## 상호작용 유형별 특화 인터페이스
각 상호작용 유형에 최적화된 인터페이스를 제공하여 효과적인 상호작용을 매개합니다:

- **텍스트 전달**: 깔끔한 텍스트 인터페이스, 읽기 쉬운 형식 + 룰 기반 링크 제공
- **상호작용 컨텐츠**: 버튼, 입력 필드, 드래그 앤 드롭 등 인터랙티브 요소 + 링크 버튼
- **루틴 개선**: 일정 표시, 진행률 시각화 + 관련 컨텐츠 링크
- **타임쉬프팅**: 시간 설정, 타이머, 알림 기능 + 시간대별 컨텐츠 링크
- **활동반려/이동**: 명확한 안내 메시지, 대안 제시, 전환 애니메이션 + 대안 활동 링크
- **멀티턴 상호작용**: 대화형 인터페이스, 단계별 진행 표시 + 단계별 컨텐츠 링크
- **비선형 상호작용**: 동적 경로 시각화, 선택지 제공, 분기점 표시 + 경로별 링크 제공

## 룰 파일 기반 학습 컨텐츠 시스템 연동
상호작용 템플릿 생성 시 룰 파일을 통해 학습 컨텐츠 시스템과 연결됩니다:

- **수학 학습 컨텐츠는 생성하지 않음**: 수학 학습 컨텐츠는 직접 생성하지 않으며, 룰 파일을 통한 링크 제공만 수행합니다.
- **룰 파일 참조**: `rules.yaml` 파일에서 상황에 맞는 학습 컨텐츠 시스템 링크 조회
- **링크 제공**: 룰에 정의된 학습 컨텐츠 링크를 상호작용 템플릿에 포함하여 제공
- **소스코드 입력**: HTML, CSS, JavaScript 등 소스코드 입력 (상호작용 템플릿 인터페이스 구현용)
- **Contents URL**: 참고할 콘텐츠 URL을 입력하여 컨텍스트 확장 (상호작용 템플릿 생성 참고용)
- **학습 컨텐츠 분리**: 수학 학습 컨텐츠는 별도 컨텐츠 시스템에서 관리되며, Agent는 링크만 제공

## 상호작용 추적 및 효과 분석 (Tracking & Analysis)
- **상호작용 결과 추적**: 각 상호작용에 대한 사용자 반응, 참여도, 완료율 추적
- **링크 클릭 추적**: 제공된 컨텐츠 시스템 링크의 클릭률 및 이동률 추적
- **효과 분석**: 상호작용이 목표 달성에 미친 영향 측정
- **행동변화 모니터링**: 연쇄 패드백을 통한 행동 변화 추적
- **템플릿 효과성 평가**: 상황별 템플릿의 효과성 비교 분석
- **룰 매칭 정확도**: 룰 파일의 링크 매칭 정확도 평가
- **개선 루프**: 분석 결과를 다음 상호작용 설계에 반영하는 지속적 개선

## KPI 목표 (KPI Targets)
- `interaction_engagement_rate`: >85% (상호작용 참여도)
- `link_click_rate`: >70% (제공된 링크 클릭률)
- `personalization_accuracy`: >80% (개인화 정확도)
- `interaction_success_rate`: >75% (상호작용 성공률)
- `behavior_change_rate`: >60% (행동변화 유도 성공률)
- `template_match_accuracy`: >80% (상황-템플릿 매칭 정확도)
- `rule_link_accuracy`: >85% (룰 기반 링크 제공 정확도)

## 통합 포인트 (Integration Points)
- **Step 18**: 상호작용 컨텐츠 생성 단계
- **Content delivery**: 동적 UI 생성 시스템과 연동
- **Personalization**: MBTI 기반 적응형 시스템과 연동
- **Rules File**: `rules.yaml` 파일을 통한 컨텐츠 시스템 링크 매핑
- **Content System**: 별도 컨텐츠 시스템과의 링크 기반 연동
- **Agent 09**: 다른 에이전트와의 데이터 교환

## 룰 파일 구조 예시
`rules.yaml` 파일은 다음과 같은 구조로 컨텐츠 시스템 링크를 정의합니다:

```yaml
rules:
  - rule_id: "interaction_type_1"
    conditions:
      - field: "interaction_type"
        operator: "=="
        value: "상호작용 컨텐츠"
    action:
      - "provide_link: https://content-system.example.com/interactive/123"
      - "provide_link: https://content-system.example.com/visual/456"
  
  - rule_id: "interaction_type_2"
    conditions:
      - field: "interaction_type"
        operator: "=="
        value: "활동반려 또는 활동지점 변경"
    action:
      - "provide_link: https://content-system.example.com/alternative/789"
```

Agent는 상황에 맞는 룰을 선택하여 해당 룰에 정의된 링크를 상호작용 컨텐츠에 포함하여 제공합니다.

