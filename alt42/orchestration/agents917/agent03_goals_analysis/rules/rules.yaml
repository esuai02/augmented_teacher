# Auto-generated rules.yaml for goals_analysis_agent
# Generated at: 2025-01-21
# Source: agent03_goals_analysis_questions.md → agent03_goals_analysis_mission.md → natural request extension

version: "1.0"
scenario: "goals_analysis"
description: "목표와 계획의 연계성, 회복탄력성, 시간 관리, 루틴 저항도, 커리큘럼 정합성 분석 및 최적화"

rules:
  # ========== S1: 목표-계획 불일치 감지 관련 룰 ==========
  
  - rule_id: "R1a_weekly_completion_rate_analysis"
    priority: 95
    description: "주간 목표 달성률 저하 시 분기목표와 주간목표 불일치 진단"
    conditions:
      - field: "weekly_completion_rate"
        operator: "<"
        value: 70
      - field: "quarterly_goal_id"
        operator: "!="
        value: null
      - field: "weekly_goal_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'goal_plan_mismatch_diagnosis'"
      - "generate_description: 'quarterly_weekly_alignment_analysis'"
      - "display_message: '분기 목표와 주간 목표가 어디서 엇나갔는지 분석 중입니다. 달성률 저하 원인을 파악하여 연결 고리를 확인합니다.'"
    confidence: 0.92
    rationale: "S1: 주간 달성률 70% 미만은 목표-계획 불일치의 핵심 지표"

  - rule_id: "R1b_schedule_variability_reflection"
    priority: 93
    description: "일정 변동률이 높을 때 계획 수립 시 변수 반영 여부 분석"
    conditions:
      - field: "schedule_variability"
        operator: ">"
        value: 30
      - field: "exam_schedule_reflected"
        operator: "=="
        value: false
    action:
      - "analyze: 'planning_variable_reflection'"
      - "generate_description: 'schedule_variability_impact_analysis'"
      - "display_message: '주간 계획 수립 시 시험 일정이나 컨디션 같은 변수가 충분히 반영되었는지 검토합니다.'"
    confidence: 0.9
    rationale: "S1: 일정 변동률 30% 초과 시 변수 반영 여부가 핵심 원인"

  - rule_id: "R1c_execution_flow_interruption"
    priority: 91
    description: "실행 데이터 기반 흐름 단절 지점 식별"
    conditions:
      - field: "execution_breakpoints"
        operator: "!="
        value: null
      - field: "weekly_completion_rate"
        operator: "<"
        value: 70
    action:
      - "analyze: 'execution_flow_interruption_points'"
      - "generate_description: 'execution_data_breakpoint_analysis'"
      - "display_message: '이번 주 실행 데이터를 기준으로 어느 단계에서 흐름이 끊겼는지 분석합니다.'"
    confidence: 0.89
    rationale: "S1: 실행 데이터 분석으로 단절 지점 정확히 파악 가능"

  - rule_id: "R1d_goal_vs_plan_adjustment_decision"
    priority: 88
    description: "목표 수정 vs 계획 방식 변경 판단"
    conditions:
      - field: "goal_reality_score"
        operator: "<"
        value: 60
      - field: "planning_method_score"
        operator: "<"
        value: 60
    action:
      - "analyze: 'goal_or_plan_adjustment_decision'"
      - "recommend: 'adjustment_strategy_selection'"
      - "display_message: '목표를 수정해야 할지, 아니면 계획 방식을 바꿔야 할지 종합적으로 판단합니다.'"
    confidence: 0.87
    rationale: "S1: 목표와 계획 방식 모두 문제일 수 있어 종합 판단 필요"

  # ========== S2: 시간 부족 딜레마 발생 관련 룰 ==========
  
  - rule_id: "R2a_time_pressure_factor_identification"
    priority: 94
    description: "시간 압박 요인 분석 (학교, 피로, 계획 오류)"
    conditions:
      - field: "time_shortage_logs"
        operator: ">="
        value: 3
      - field: "time_pressure_factor"
        operator: "!="
        value: null
    action:
      - "analyze: 'time_pressure_root_cause'"
      - "generate_description: 'time_shortage_factor_analysis'"
      - "display_message: '이번 주 가장 시간을 압박한 요인을 분석합니다. (학교 일정, 피로, 계획 오류 중 원인 파악)'"
    confidence: 0.91
    rationale: "S2: 시간 부족 로그 3회 이상 시 근본 원인 분석 필수"

  - rule_id: "R2b_priority_adjustment_suggestion"
    priority: 92
    description: "우선순위 조정을 통한 활동 줄이기/연기 제안"
    conditions:
      - field: "time_shortage_logs"
        operator: ">="
        value: 2
      - field: "goal_count"
        operator: ">"
        value: 5
    action:
      - "recommend: 'priority_based_activity_reduction'"
      - "generate_description: 'priority_adjustment_strategy'"
      - "display_message: '우선순위를 조정한다면 어떤 활동을 줄이거나 연기할 수 있을지 제안합니다.'"
    confidence: 0.9
    rationale: "S2: 목표가 많고 시간 부족 시 우선순위 조정이 핵심"

  - rule_id: "R2c_resilience_recovery_strategy"
    priority: 90
    description: "회복탄력 전략으로 짧은 세션/보충시간 활용 제안"
    conditions:
      - field: "time_shortage_logs"
        operator: ">="
        value: 2
      - field: "recovery_buffer_time"
        operator: "<"
        value: 60
    action:
      - "recommend: 'resilience_recovery_session_design'"
      - "generate_description: 'short_session_utilization_guide'"
      - "display_message: '회복탄력 전략으로 짧은 세션이나 보충시간을 활용할 수 있는 방안을 제안합니다.'"
    confidence: 0.88
    rationale: "S2: 시간 부족 시 회복탄력성 있는 대안이 핵심"

  - rule_id: "R2d_time_pressure_motivation_analysis"
    priority: 87
    description: "일정 압박이 동력인지 부담인지 분석"
    conditions:
      - field: "time_shortage_logs"
        operator: ">="
        value: 2
      - field: "motivation_score_under_pressure"
        operator: "!="
        value: null
    action:
      - "analyze: 'time_pressure_motivation_impact'"
      - "generate_description: 'pressure_as_motivation_or_burden'"
      - "display_message: '일정 압박이 학습 동력으로 작용하는지, 아니면 부담으로 작용하는지 분석합니다.'"
    confidence: 0.86
    rationale: "S2: 압박의 긍정/부정 효과를 파악하여 대응 전략 수립"

  # ========== S3: 회복탄력성 저하 감지 관련 룰 ==========
  
  - rule_id: "R3a_disruption_emotion_analysis"
    priority: 93
    description: "일정 흐트러짐 시 감정 반응 분석 (좌절, 무관심, 의욕)"
    conditions:
      - field: "recovery_time_avg"
        operator: ">"
        value: 3
      - field: "disruption_emotion_data"
        operator: "!="
        value: null
    action:
      - "analyze: 'disruption_emotional_response'"
      - "generate_description: 'emotional_resilience_pattern'"
      - "display_message: '일정이 흐트러졌을 때 어떤 감정이 먼저 느껴졌는지 분석합니다. (좌절, 무관심, 의욕 중?)'"
    confidence: 0.91
    rationale: "S3: 복귀 시간 3일 초과 시 감정 반응이 회복 속도 결정"

  - rule_id: "R3b_recovery_support_analysis"
    priority: 91
    description: "복귀 과정에서 도움 받은 부분 분석 (교사 조언, 루틴, 포모도르)"
    conditions:
      - field: "recovery_time_avg"
        operator: ">"
        value: 3
      - field: "recovery_support_used"
        operator: "!="
        value: null
    action:
      - "analyze: 'recovery_support_effectiveness'"
      - "generate_description: 'recovery_helper_identification'"
      - "display_message: '복귀 과정에서 도움을 받은 부분이 있었는지 분석합니다. (교사 조언, 루틴, 포모도르)'"
    confidence: 0.89
    rationale: "S3: 회복 지원 요인 파악으로 향후 대응 전략 수립"

  - rule_id: "R3c_buffer_time_effectiveness"
    priority: 89
    description: "여유 시간 배치 및 회복 효과 분석"
    conditions:
      - field: "recovery_time_avg"
        operator: ">"
        value: 3
      - field: "buffer_time_available"
        operator: "!="
        value: null
    action:
      - "analyze: 'buffer_time_utilization'"
      - "generate_description: 'buffer_time_recovery_impact'"
      - "display_message: '평소 여유 시간을 어디에 배치해 두었는지, 그게 회복에 도움이 됐는지 분석합니다.'"
    confidence: 0.87
    rationale: "S3: 여유 시간 활용이 회복탄력성 핵심 요소"

  - rule_id: "R3d_rhythm_recovery_step_suggestion"
    priority: 88
    description: "리듬 재생성을 위한 작은 단계 제안"
    conditions:
      - field: "recovery_time_avg"
        operator: ">"
        value: 3
      - field: "rhythm_recovery_status"
        operator: "=="
        value: "in_progress"
    action:
      - "recommend: 'gradual_rhythm_recovery_steps'"
      - "generate_description: 'small_step_recovery_plan'"
      - "display_message: '다시 리듬을 만들기 위해 이번 주 어떤 작은 단계부터 시작할 수 있을지 제안합니다.'"
    confidence: 0.86
    rationale: "S3: 회복은 작은 단계부터 시작하는 것이 효과적"

  # ========== S4: 목표 과부하 또는 미루기 증가 관련 룰 ==========
  
  - rule_id: "R4a_goal_overload_vs_focus_analysis"
    priority: 92
    description: "목표 개수 과다 vs 집중력 저하 판단"
    conditions:
      - field: "goal_count"
        operator: ">"
        value: 8
      - field: "focus_score"
        operator: "<"
        value: 60
    action:
      - "analyze: 'goal_overload_or_focus_issue'"
      - "generate_description: 'goal_count_vs_focus_analysis'"
      - "display_message: '목표 개수가 너무 많다고 느껴지는지, 아니면 집중이 잘 안 되는지 분석합니다.'"
    confidence: 0.9
    rationale: "S4: 목표 과부하와 집중력 저하는 다른 대응 전략 필요"

  - rule_id: "R4b_procrastination_root_cause"
    priority: 90
    description: "미루기 원인 분석 (시간 부족 vs 동기 저하)"
    conditions:
      - field: "procrastination_count"
        operator: ">="
        value: 3
      - field: "pomodoro_completion_rate"
        operator: "<"
        value: 70
    action:
      - "analyze: 'procrastination_root_cause'"
      - "generate_description: 'time_vs_motivation_procrastination'"
      - "display_message: '미루게 된 이유가 시간 부족인지, 동기 저하인지 분석합니다.'"
    confidence: 0.89
    rationale: "S4: 미루기 3회 이상, 포모도르 종료율 70% 미만 시 원인 분석 필수"

  - rule_id: "R4c_core_goal_identification"
    priority: 88
    description: "현재 목표 중 핵심 2개 선별"
    conditions:
      - field: "goal_count"
        operator: ">"
        value: 5
      - field: "procrastination_count"
        operator: ">="
        value: 2
    action:
      - "recommend: 'core_goal_selection'"
      - "generate_description: 'essential_goal_identification'"
      - "display_message: '현재 목표 중 가장 핵심 2개만 골라본다면 무엇인지 제안합니다.'"
    confidence: 0.87
    rationale: "S4: 목표 과부하 시 핵심만 선별하여 집중력 회복"

  - rule_id: "R4d_selective_omission_strategy"
    priority: 86
    description: "주간 계획에서 선택적 생략 허용 범위 제안"
    conditions:
      - field: "goal_count"
        operator: ">"
        value: 6
      - field: "weekly_completion_rate"
        operator: "<"
        value: 60
    action:
      - "recommend: 'selective_omission_framework'"
      - "generate_description: 'flexible_goal_completion_strategy'"
      - "display_message: '주간 계획에서 어디까지 선택적 생략을 허용해볼 수 있을지 제안합니다.'"
    confidence: 0.85
    rationale: "S4: 완벽주의를 완화하여 실행 가능성 향상"

  # ========== S5: 루틴 저항도 상승 관련 룰 ==========
  
  - rule_id: "R5a_routine_resistance_point_identification"
    priority: 91
    description: "루틴 시작 시 귀찮게 느껴지는 부분 식별"
    conditions:
      - field: "emotion_score"
        operator: "<"
        value: 5
      - field: "routine_start_resistance"
        operator: "!="
        value: null
    action:
      - "analyze: 'routine_resistance_points'"
      - "generate_description: 'routine_barrier_identification'"
      - "display_message: '요즘 루틴을 시작할 때 가장 귀찮게 느껴지는 부분을 분석합니다.'"
    confidence: 0.89
    rationale: "S5: 감정 점수 5 미만 시 루틴 저항 지점 파악 필수"

  - rule_id: "R5b_concentration_breaking_factor"
    priority: 89
    description: "수업준비/포모도르 초기 5분 집중 방해 요소 분석"
    conditions:
      - field: "emotion_score"
        operator: "<"
        value: 5
      - field: "initial_5min_distraction_count"
        operator: ">="
        value: 2
    action:
      - "analyze: 'initial_concentration_barriers'"
      - "generate_description: 'warmup_distraction_analysis'"
      - "display_message: '수업준비 또는 포모도르 초기 5분에 집중을 깨는 요소가 있는지 분석합니다.'"
    confidence: 0.87
    rationale: "S5: 초기 집중 방해는 루틴 저항의 핵심 원인"

  - rule_id: "R5c_rhythm_recovery_change_suggestion"
    priority: 87
    description: "학습 리듬 회복을 위한 변화 제안"
    conditions:
      - field: "emotion_score"
        operator: "<"
        value: 5
      - field: "routine_participation_rate"
        operator: "<"
        value: 70
    action:
      - "recommend: 'rhythm_recovery_changes'"
      - "generate_description: 'routine_adaptation_strategy'"
      - "display_message: '학습 리듬을 다시 올리기 위해 변화를 주고 싶은 부분을 제안합니다.'"
    confidence: 0.86
    rationale: "S5: 저항도 상승 시 변화를 통한 리듬 회복 필요"

  - rule_id: "R5d_hard_day_recovery_speed_analysis"
    priority: 85
    description: "힘든 날 후 회복 속도 패턴 분석"
    conditions:
      - field: "emotion_score"
        operator: "<"
        value: 5
      - field: "hard_day_recovery_time"
        operator: "!="
        value: null
    action:
      - "analyze: 'hard_day_recovery_pattern'"
      - "generate_description: 'resilience_after_difficulty'"
      - "display_message: '감정 패턴상 힘든 날 후 회복 속도는 어떤지 분석합니다.'"
    confidence: 0.84
    rationale: "S5: 힘든 날 회복 패턴 파악으로 사전 대응 전략 수립"

  # ========== S6: 커리큘럼-목표 불일치 감지 관련 룰 ==========
  
  - rule_id: "R6a_quarterly_curriculum_mismatch"
    priority: 92
    description: "분기 목표와 장기 커리큘럼 불일치 지점 분석"
    conditions:
      - field: "curriculum_progress_deviation"
        operator: ">"
        value: 20
      - field: "quarterly_goal_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'quarterly_curriculum_alignment'"
      - "generate_description: 'curriculum_goal_mismatch_analysis'"
      - "display_message: '이번 분기 목표가 장기 커리큘럼과 어디서 엇갈리고 있는지 분석합니다.'"
    confidence: 0.9
    rationale: "S6: 커리큘럼 진도 편차 20% 초과 시 불일치 심각"

  - rule_id: "R6b_exam_result_curriculum_impact"
    priority: 90
    description: "최근 시험 결과가 커리큘럼 조정에 미친 영향 분석"
    conditions:
      - field: "curriculum_progress_deviation"
        operator: ">"
        value: 20
      - field: "recent_exam_result"
        operator: "!="
        value: null
    action:
      - "analyze: 'exam_result_curriculum_adjustment'"
      - "generate_description: 'exam_impact_on_curriculum'"
      - "display_message: '최근 시험 결과가 커리큘럼 조정에 영향을 줬는지 분석합니다.'"
    confidence: 0.88
    rationale: "S6: 시험 결과는 커리큘럼 조정의 주요 트리거"

  - rule_id: "R6c_curriculum_pace_depth_adequacy"
    priority: 88
    description: "진학 목표 대비 커리큘럼 속도/깊이 적절성 평가"
    conditions:
      - field: "admission_goal"
        operator: "!="
        value: null
      - field: "curriculum_pace_score"
        operator: "!="
        value: null
    action:
      - "analyze: 'curriculum_pace_depth_alignment'"
      - "generate_description: 'admission_goal_curriculum_fit'"
      - "display_message: '진학 목표에 비해 현재 커리큘럼의 속도나 깊이는 적절한지 평가합니다.'"
    confidence: 0.87
    rationale: "S6: 진학 목표는 커리큘럼 설계의 기준점"

  - rule_id: "R6d_competitive_curriculum_comparison"
    priority: 86
    description: "경쟁 커리큘럼 데이터와 비교한 보완 영역 분석"
    conditions:
      - field: "curriculum_progress_deviation"
        operator: ">"
        value: 15
      - field: "competitive_curriculum_data"
        operator: "!="
        value: null
    action:
      - "analyze: 'competitive_curriculum_gap'"
      - "generate_description: 'curriculum_improvement_areas'"
      - "display_message: '전국 규모의 경쟁 커리큘럼과 비교했을 때 보완해야 할 영역을 분석합니다.'"
    confidence: 0.85
    rationale: "S6: 경쟁력 분석을 통한 커리큘럼 최적화"

  # ========== S7: 교사 피드백 불일치 관련 룰 ==========
  
  - rule_id: "R7a_teacher_core_goal_identification"
    priority: 91
    description: "교사가 판단한 핵심 목표 추출 및 AI 추천과 비교"
    conditions:
      - field: "teacher_feedback_mismatch_count"
        operator: ">="
        value: 2
      - field: "teacher_core_goal"
        operator: "!="
        value: null
    action:
      - "analyze: 'teacher_ai_goal_comparison'"
      - "generate_description: 'core_goal_mismatch_analysis'"
      - "display_message: '선생님이 보기에 이 학생의 핵심 목표는 무엇인지, AI 추천과 차이가 나는 이유를 분석합니다.'"
    confidence: 0.9
    rationale: "S7: 교사 피드백 불일치 2회 이상 시 핵심 목표 재정의 필요"

  - rule_id: "R7b_teacher_judgment_factors"
    priority: 89
    description: "교사 판단 근거 분석 (정서, 집중력, 지속성 등)"
    conditions:
      - field: "teacher_feedback_mismatch_count"
        operator: ">="
        value: 2
      - field: "teacher_judgment_factors"
        operator: "!="
        value: null
    action:
      - "analyze: 'teacher_judgment_basis'"
      - "generate_description: 'emotional_focus_persistence_analysis'"
      - "display_message: '교사의 판단 근거(정서, 집중력, 지속성 등)를 모델에 어떻게 반영할지 분석합니다.'"
    confidence: 0.88
    rationale: "S7: 교사 직관의 근거를 모델에 통합하여 정확도 향상"

  - rule_id: "R7c_ai_recommendation_adjustment"
    priority: 87
    description: "교사 피드백 기반 AI 추천 목표 조정"
    conditions:
      - field: "teacher_feedback_mismatch_count"
        operator: ">="
        value: 2
      - field: "teacher_core_goal"
        operator: "!="
        value: null
    action:
      - "recommend: 'ai_goal_adjustment_with_teacher_input'"
      - "generate_description: 'teacher_informed_goal_refinement'"
      - "display_message: '교사 피드백을 반영하여 AI 추천 목표를 조정합니다.'"
    confidence: 0.86
    rationale: "S7: 교사 피드백 통합으로 목표 정확도 향상"

  # ========== S8: 시험 직전 재정렬 관련 룰 ==========
  
  - rule_id: "R8a_exam_efficiency_analysis"
    priority: 94
    description: "시험 8주 전 현재 목표 중 효율 낮은 부분 식별"
    conditions:
      - field: "exam_weeks_remaining"
        operator: "<="
        value: 8
      - field: "exam_weeks_remaining"
        operator: ">="
        value: 6
      - field: "goal_efficiency_score"
        operator: "!="
        value: null
    action:
      - "analyze: 'exam_prep_goal_efficiency'"
      - "generate_description: 'low_efficiency_goal_identification'"
      - "display_message: '시험 8주 전 현재 목표 중 가장 효율이 낮은 부분을 식별합니다.'"
    confidence: 0.92
    rationale: "S8: 시험 8주 전 모드 진입 시 효율성 최적화 필수"

  - rule_id: "R8b_exam_prep_loop_completion"
    priority: 92
    description: "시험 기간 핵심 개념-유형-기출 루프 완성도 확인"
    conditions:
      - field: "exam_weeks_remaining"
        operator: "<="
        value: 8
      - field: "concept_type_past_loop_status"
        operator: "!="
        value: null
    action:
      - "analyze: 'exam_prep_loop_completion'"
      - "generate_description: 'concept_type_past_loop_analysis'"
      - "display_message: '시험 기간 동안 핵심 개념-유형-기출 루프가 완성되어 있는지 확인합니다.'"
    confidence: 0.91
    rationale: "S8: 시험 대비의 핵심은 개념-유형-기출 루프 완성"

  - rule_id: "R8c_proactive_schedule_adjustment"
    priority: 90
    description: "일정 압박 완화를 위한 선제적 조정 제안"
    conditions:
      - field: "exam_weeks_remaining"
        operator: "<="
        value: 8
      - field: "schedule_pressure_forecast"
        operator: ">"
        value: 70
    action:
      - "recommend: 'proactive_schedule_optimization'"
      - "generate_description: 'preemptive_time_management'"
      - "display_message: '일정 압박을 줄이기 위해 지금 선제적으로 조정할 부분을 제안합니다.'"
    confidence: 0.89
    rationale: "S8: 시험 전 선제적 조정으로 압박 최소화"

  - rule_id: "R8d_quarterly_exam_timeline_alignment"
    priority: 88
    description: "분기목표와 시험목표 간 시간축 불일치 검증"
    conditions:
      - field: "exam_weeks_remaining"
        operator: "<="
        value: 8
      - field: "quarterly_goal_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'quarterly_exam_timeline_conflict'"
      - "generate_description: 'goal_timeline_alignment_check'"
      - "display_message: '분기목표와 시험목표 간의 시간축 불일치가 없는지 검증합니다.'"
    confidence: 0.87
    rationale: "S8: 시험 전 목표 일관성 확보 필수"

  # ========== 추가 상세 분석 룰 ==========
  
  - rule_id: "R9a_quarterly_goal_comprehensive_analysis"
    priority: 96
    description: "분기목표 종합 분석: 학년별/분기별 상황 반영 및 장기목표 연계성"
    conditions:
      - field: "quarterly_goal_id"
        operator: "!="
        value: null
      - field: "long_term_goal_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'quarterly_goal_comprehensive_review'"
      - "generate_description: 'quarterly_long_term_alignment_report'"
      - "display_message: '분기목표가 학년별/분기별 상황을 종합 반영하고 장기목표와 연계되어 있는지 분석합니다.'"
    confidence: 0.93
    rationale: "분기목표는 장기 목표와의 연결고리, 종합 분석 필수"

  - rule_id: "R9b_weekly_goal_variable_reflection"
    priority: 94
    description: "주간목표 변수 반영도 및 회복탄력성 대안 준비도 분석"
    conditions:
      - field: "weekly_goal_id"
        operator: "!="
        value: null
      - field: "school_schedule_reflected"
        operator: "=="
        value: false
    action:
      - "analyze: 'weekly_goal_variable_coverage'"
      - "generate_description: 'resilience_alternative_readiness'"
      - "display_message: '주간목표가 학교일정이나 변수들을 충분히 반영하고, 회복탄력성 있는 대안이 준비되어 있는지 분석합니다.'"
    confidence: 0.91
    rationale: "주간목표는 변수 대응력이 핵심"

  - rule_id: "R9c_proactive_buffer_time_management"
    priority: 92
    description: "선제적 여유시간 확보 방식 운영 여부 분석"
    conditions:
      - field: "weekly_goal_id"
        operator: "!="
        value: null
      - field: "buffer_time_allocation"
        operator: "<"
        value: 20
    action:
      - "analyze: 'proactive_buffer_management'"
      - "generate_description: 'buffer_time_strategy_analysis'"
      - "display_message: '일정들이 딜레이되는 것이 아니라 선제적으로 여유시간을 확보하는 방식으로 운영되는지 분석합니다.'"
    confidence: 0.9
    rationale: "선제적 여유시간 확보가 회복탄력성 핵심"

  - rule_id: "R9d_holiday_schedule_reconciliation"
    priority: 90
    description: "휴가/연휴 시 일정 사전 안내 및 재조정 체계 분석"
    conditions:
      - field: "holiday_period_detected"
        operator: "=="
        value: true
      - field: "schedule_reconciliation_status"
        operator: "!="
        value: null
    action:
      - "analyze: 'holiday_schedule_management'"
      - "generate_description: 'holiday_reconciliation_process'"
      - "display_message: '휴가나 연휴 등 학원을 오지 못하는 상황에 대해 사전에 체계적으로 안내되고 재조정되는지 분석합니다.'"
    confidence: 0.88
    rationale: "휴가/연휴 대응은 학습 연속성 핵심"

  - rule_id: "R9e_quarterly_goal_motivation_impact"
    priority: 88
    description: "분기목표가 학습 동력으로 연결되는지 분석"
    conditions:
      - field: "quarterly_goal_id"
        operator: "!="
        value: null
      - field: "goal_motivation_score"
        operator: "<"
        value: 60
    action:
      - "analyze: 'goal_motivation_connection'"
      - "generate_description: 'goal_as_learning_driver'"
      - "display_message: '분기목표가 실질적으로 달성에 대한 부담감을 발생시켜 학습의 동력으로 연결되는지 분석합니다.'"
    confidence: 0.87
    rationale: "목표는 동력이 되어야 함, 부담만 되면 역효과"

  - rule_id: "R10a_today_goal_time_adequacy"
    priority: 93
    description: "오늘목표 시간표상 시간량 고려 및 분량 적절성 분석"
    conditions:
      - field: "today_goal_id"
        operator: "!="
        value: null
      - field: "available_time_hours"
        operator: "!="
        value: null
    action:
      - "analyze: 'today_goal_time_adequacy'"
      - "generate_description: 'goal_volume_time_match_analysis'"
      - "display_message: '오늘목표가 시간표상의 시간의 양을 고려하고 분량이 적절한지 분석합니다.'"
    confidence: 0.91
    rationale: "오늘목표는 실행 가능성이 최우선"

  - rule_id: "R10b_weekly_goal_remaining_hurdles"
    priority: 91
    description: "주간목표 잔여 활동 허들 사전 검토 분석"
    conditions:
      - field: "today_goal_id"
        operator: "!="
        value: null
      - field: "weekly_goal_remaining_activities"
        operator: "!="
        value: null
    action:
      - "analyze: 'remaining_activity_hurdles'"
      - "generate_description: 'weekly_goal_completion_barriers'"
      - "display_message: '주간목표 전체 경로상의 오늘목표 분량 적절성 및 잔여 활동에서의 허들이 사전에 검토되었는지 분석합니다.'"
    confidence: 0.9
    rationale: "사전 허들 검토로 주간목표 달성 안정성 확보"

  - rule_id: "R10c_proactive_execution_tone"
    priority: 89
    description: "다음 수업시간 연계 선제적 실행 톤 여부 분석"
    conditions:
      - field: "today_goal_id"
        operator: "!="
        value: null
      - field: "next_class_connection"
        operator: "=="
        value: false
    action:
      - "analyze: 'proactive_execution_pattern'"
      - "generate_description: 'next_class_preparation_tone'"
      - "display_message: '다음 수업시간과 연계하여 선제적 실행의 톤으로 실행되는지 분석합니다.'"
    confidence: 0.88
    rationale: "선제적 실행이 학습 효율성 향상"

  - rule_id: "R10d_procrastination_detection_response"
    priority: 87
    description: "미루기 요소 감지 시 조치 여부 분석"
    conditions:
      - field: "procrastination_count"
        operator: ">="
        value: 2
      - field: "procrastination_response_taken"
        operator: "=="
        value: false
    action:
      - "analyze: 'procrastination_response_effectiveness'"
      - "alert: '미루기 패턴 감지, 즉시 조치 필요'"
      - "display_message: '미루는 요소가 감지되었을 때 조치를 취하는지, 아니면 방치되는지 분석합니다.'"
    confidence: 0.86
    rationale: "미루기 조기 대응이 학습 연속성 핵심"

  - rule_id: "R11a_class_prep_warmup_effectiveness"
    priority: 92
    description: "수업준비 웜업 활동의 장애물 제거 효과 분석"
    conditions:
      - field: "class_prep_session_id"
        operator: "!="
        value: null
      - field: "warmup_barrier_removal_score"
        operator: "!="
        value: null
    action:
      - "analyze: 'class_prep_warmup_effectiveness'"
      - "generate_description: 'warmup_barrier_removal_analysis'"
      - "display_message: '수업의 초기 웜업활동으로 당일활동의 장애물을 효과적으로 제거할 수 있는지 분석합니다.'"
    confidence: 0.9
    rationale: "수업준비 웜업은 학습 효율성의 시작점"

  - rule_id: "R11b_normal_state_recovery_time"
    priority: 90
    description: "정상상태 도달 시간 및 안정성 분석"
    conditions:
      - field: "class_prep_session_id"
        operator: "!="
        value: null
      - field: "normal_state_recovery_time_minutes"
        operator: ">"
        value: 10
    action:
      - "analyze: 'normal_state_recovery_pattern'"
      - "generate_description: 'quick_stable_state_achievement'"
      - "display_message: '지난 과정에 대한 효과적인 웜업으로 정상상태에 안정적이고 빠른 시간에 도달하는지 분석합니다.'"
    confidence: 0.89
    rationale: "빠른 정상상태 도달이 학습 효율성 핵심"

  - rule_id: "R11c_pomodoro_initial_class_prep_routine"
    priority: 88
    description: "포모도르 초기 활동으로 수업준비 배치 효과 분석"
    conditions:
      - field: "pomodoro_session_id"
        operator: "!="
        value: null
      - field: "class_prep_in_initial_pomodoro"
        operator: "=="
        value: true
    action:
      - "analyze: 'pomodoro_class_prep_integration'"
      - "generate_description: 'initial_pomodoro_prep_routine'"
      - "display_message: '포모도르 초기 활동으로 수업준비활동이 효과적으로 배치되는 루틴이 진행 중인지 분석합니다.'"
    confidence: 0.87
    rationale: "포모도르와 수업준비 통합이 루틴 효율성 향상"

  - rule_id: "R12a_pomodoro_activity_placement"
    priority: 91
    description: "포모도르 활동 배치 분석: 징검다리 활동과 본 활동"
    conditions:
      - field: "pomodoro_session_id"
        operator: "!="
        value: null
      - field: "bridge_activity_placed"
        operator: "=="
        value: false
    action:
      - "analyze: 'pomodoro_activity_structure'"
      - "generate_description: 'bridge_main_activity_placement'"
      - "display_message: '오늘활동에 대한 징검다리 활동들과 본 활동들이 잘 배치되어 있는지 분석합니다.'"
    confidence: 0.9
    rationale: "징검다리 활동은 학습 전환의 핵심"

  - rule_id: "R12b_emotion_data_meaning_analysis"
    priority: 89
    description: "학생 감정표현 데이터 의미 분석"
    conditions:
      - field: "emotion_score"
        operator: "!="
        value: null
      - field: "emotion_data_count"
        operator: ">="
        value: 3
    action:
      - "analyze: 'emotion_data_interpretation'"
      - "generate_description: 'emotional_learning_state_analysis'"
      - "display_message: '학생의 감정표현 데이터에 대한 의미를 분석합니다.'"
    confidence: 0.88
    rationale: "감정 데이터는 학습 심리 파악의 핵심"

  - rule_id: "R12c_activity_selection_psychology"
    priority: 87
    description: "활동 선택과 시간간격에 표현된 학습심리 분석"
    conditions:
      - field: "pomodoro_session_id"
        operator: "!="
        value: null
      - field: "activity_selection_pattern"
        operator: "!="
        value: null
    action:
      - "analyze: 'activity_selection_psychology'"
      - "generate_description: 'learning_psychology_from_timing'"
      - "display_message: '활동의 선택과 시간간격에 표현된 학생의 학습심리를 분석합니다.'"
    confidence: 0.86
    rationale: "활동 선택 패턴은 학습 동기 상태 반영"

  - rule_id: "R12d_short_term_goal_burden_analysis"
    priority: 85
    description: "단기목표 부담감 및 집중 세션 유지 인지근력 분석"
    conditions:
      - field: "pomodoro_session_id"
        operator: "!="
        value: null
      - field: "focus_duration_minutes"
        operator: "<"
        value: 25
    action:
      - "analyze: 'short_term_goal_cognitive_load'"
      - "generate_description: 'focus_endurance_analysis'"
      - "display_message: '단기목표에 대한 부담감과 활동종료를 위한 집중된 세션을 유지하는 인지근력을 분석합니다.'"
    confidence: 0.85
    rationale: "인지근력은 학습 지속성의 핵심"

  - rule_id: "R12e_activity_selection_flexibility"
    priority: 83
    description: "활동선택 경직도 vs 자연스러운 흐름 분석"
    conditions:
      - field: "pomodoro_session_id"
        operator: "!="
        value: null
      - field: "activity_flexibility_score"
        operator: "<"
        value: 60
    action:
      - "analyze: 'activity_selection_flexibility'"
      - "generate_description: 'rigid_vs_natural_flow'"
      - "display_message: '활동선택이 경직되었는지 자연스러운 흐름으로 리듬있게 이어지는지 분석합니다.'"
    confidence: 0.84
    rationale: "자연스러운 흐름이 학습 동기 유지에 중요"

  - rule_id: "R13a_departure_check_comprehensive_analysis"
    priority: 92
    description: "귀가검사 종합 분석: 당일 학습활동 및 포모도르 데이터 통합"
    conditions:
      - field: "departure_check_session_id"
        operator: "!="
        value: null
      - field: "daily_learning_summary"
        operator: "!="
        value: null
    action:
      - "analyze: 'departure_check_comprehensive_review'"
      - "generate_description: 'daily_learning_pomodoro_integration'"
      - "display_message: '귀가검사 활동 인터페이스에서 전달되는 데이터와 당일 학습활동, 포모도르 데이터를 종합 분석합니다.'"
    confidence: 0.91
    rationale: "귀가검사는 일일 학습 종합 평가 지점"

  - rule_id: "R13b_personal_routine_progress_analysis"
    priority: 90
    description: "퍼스널루틴 진행상황 분석"
    conditions:
      - field: "departure_check_session_id"
        operator: "!="
        value: null
      - field: "personal_routine_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'personal_routine_progress'"
      - "generate_description: 'routine_adherence_analysis'"
      - "display_message: '현재 진행중인 퍼스널루틴의 진행상황을 분석합니다.'"
    confidence: 0.89
    rationale: "퍼스널루틴 진행도는 학습 일관성 지표"

  - rule_id: "R13c_routine_resistance_analysis"
    priority: 88
    description: "루틴 저항감 분석 및 대안 자동조절 기능 적절성"
    conditions:
      - field: "departure_check_session_id"
        operator: "!="
        value: null
      - field: "routine_resistance_score"
        operator: ">"
        value: 5
    action:
      - "analyze: 'routine_resistance_pattern'"
      - "recommend: 'routine_auto_adjustment'"
      - "display_message: '루틴에 대한 저항감을 분석하고 대안에 대한 자동조절 기능의 동작과 적절성을 분석합니다.'"
    confidence: 0.87
    rationale: "저항감 감지 시 자동 조절이 루틴 지속성 핵심"

  - rule_id: "R14a_curriculum_long_term_flow_analysis"
    priority: 94
    description: "장기 커리큘럼 흐름 분석: 고3까지 연계 및 변경 흐름"
    conditions:
      - field: "curriculum_progress_id"
        operator: "!="
        value: null
      - field: "long_term_curriculum_trend"
        operator: "!="
        value: null
    action:
      - "analyze: 'long_term_curriculum_flow'"
      - "generate_description: 'curriculum_flow_prediction'"
      - "display_message: '분기목표와 연계하여 장기적인 커리큘럼(고3까지)과 커리큘럼 변경의 흐름을 분석합니다.'"
    confidence: 0.92
    rationale: "장기 흐름 분석이 학습 계획의 기반"

  - rule_id: "R14b_admission_goal_curriculum_fit"
    priority: 92
    description: "진학목표 대비 커리큘럼 적합도 분석"
    conditions:
      - field: "admission_goal"
        operator: "!="
        value: null
      - field: "curriculum_progress_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'admission_curriculum_alignment'"
      - "generate_description: 'curriculum_goal_fit_analysis'"
      - "display_message: '학생의 진학목표(특목고, 대학 등)와 입시준비 최적화를 위한 커리큘럼 적합도를 분석합니다.'"
    confidence: 0.91
    rationale: "진학목표는 커리큘럼 설계의 기준"

  - rule_id: "R14c_competitive_curriculum_analysis"
    priority: 90
    description: "전국 규모 경쟁 커리큘럼 비교 분석"
    conditions:
      - field: "curriculum_progress_id"
        operator: "!="
        value: null
      - field: "competitive_curriculum_data"
        operator: "!="
        value: null
    action:
      - "analyze: 'competitive_curriculum_comparison'"
      - "generate_description: 'curriculum_competitiveness_report'"
      - "display_message: '전국 규모의 경쟁사들의 커리큘럼과의 경쟁력을 분석하여 리포트를 생성합니다.'"
    confidence: 0.89
    rationale: "경쟁력 분석이 커리큘럼 최적화의 핵심"

  - rule_id: "R15a_goal_quality_score_analysis"
    priority: 88
    description: "목표 품질 점수 종합 분석"
    conditions:
      - field: "goal_quality_score"
        operator: "<"
        value: 60
      - field: "goal_id"
        operator: "!="
        value: null
    action:
      - "analyze_goal_quality: true"
      - "generate_description: 'goal_quality_comprehensive_analysis'"
      - "display_message: '목표 품질 점수를 종합 분석하여 개선 방안을 제시합니다.'"
    confidence: 0.87
    rationale: "목표 품질 60 미만 시 개선 필요"

  - rule_id: "R15b_completion_rate_calculation"
    priority: 86
    description: "달성률 계산 및 트렌드 분석"
    conditions:
      - field: "completion_rate"
        operator: "!="
        value: null
      - field: "goal_id"
        operator: "!="
        value: null
    action:
      - "calculate_completion_rate: true"
      - "generate_description: 'completion_rate_trend_analysis'"
      - "display_message: '달성률을 계산하고 트렌드를 분석합니다.'"
    confidence: 0.85
    rationale: "달성률은 목표 효과성의 핵심 지표"

  - rule_id: "R15c_category_balance_check"
    priority: 84
    description: "카테고리 균형 확인 및 조정 제안"
    conditions:
      - field: "category_balance"
        operator: "!="
        value: null
      - field: "category_deviation"
        operator: ">"
        value: 30
    action:
      - "check_category_balance: true"
      - "rebalance_categories: true"
      - "display_message: '카테고리 균형을 확인하고 필요시 조정을 제안합니다.'"
    confidence: 0.83
    rationale: "카테고리 편차 30% 초과 시 균형 조정 필요"

  - rule_id: "R15d_long_term_goal_breakdown"
    priority: 82
    description: "장기 목표 세분화 제안"
    conditions:
      - field: "goal_type"
        operator: "=="
        value: "long_term"
      - field: "goal_duration_months"
        operator: ">"
        value: 6
    action:
      - "breakdown_long_term_goals: true"
      - "suggest_intermediate_milestones: true"
      - "display_message: '장기 목표를 세분화하여 중간 마일스톤을 제안합니다.'"
    confidence: 0.81
    rationale: "6개월 이상 장기 목표는 세분화 필요"

  - rule_id: "R15e_realistic_timeline_suggestion"
    priority: 80
    description: "현실적 기간 제안"
    conditions:
      - field: "completion_rate"
        operator: "<"
        value: 60
      - field: "goal_duration_months"
        operator: "!="
        value: null
    action:
      - "suggest_realistic_timeline: true"
      - "generate_description: 'realistic_timeline_adjustment'"
      - "display_message: '달성률 저하를 고려하여 현실적인 기간을 제안합니다.'"
    confidence: 0.79
    rationale: "달성률 60% 미만 시 기간 재조정 필요"

  # ========== S0: 학원 정보 수집 관련 룰 ==========
  
  - rule_id: "S0_R1_academy_info_collection"
    priority: 97
    description: "학원 정보 수집: 학원명, 반 수준, 진도, 일정"
    conditions:
      - field: "academy_name"
        operator: "=="
        value: null
      - field: "student_id"
        operator: "!="
        value: null
    action:
      - "collect: 'academy_information'"
      - "generate_description: 'academy_info_required'"
      - "display_message: '학원 정보를 수집합니다. 학원명, 반 수준, 현재 진도, 수업 일정을 확인합니다.'"
    confidence: 0.95
    rationale: "학원 정보는 목표 연계의 필수 데이터"

  - rule_id: "S0_R2_academy_progress_mapping"
    priority: 96
    description: "학원 진도와 학교 교과서 단원 매핑"
    conditions:
      - field: "academy_progress_unit"
        operator: "!="
        value: null
      - field: "school_textbook_unit"
        operator: "!="
        value: null
    action:
      - "analyze: 'academy_school_unit_mapping'"
      - "generate_description: 'unit_progress_alignment'"
      - "display_message: '학원 진도와 학교 교과서 단원을 매핑하여 목표 연계성을 확인합니다.'"
    confidence: 0.94
    rationale: "학원 진도와 학교 단원 매핑이 목표 연계의 기반"

  - rule_id: "S0_R3_academy_class_level_assessment"
    priority: 95
    description: "학원 반 수준 평가 및 목표 난이도 조정"
    conditions:
      - field: "academy_class_level"
        operator: "!="
        value: null
      - field: "goal_difficulty"
        operator: "!="
        value: null
    action:
      - "analyze: 'academy_level_goal_fit'"
      - "adjust: 'goal_difficulty_by_academy_level'"
      - "display_message: '학원 반 수준에 맞는 목표 난이도를 조정합니다.'"
    confidence: 0.93
    rationale: "학원 반 수준이 목표 난이도 결정에 영향"

  - rule_id: "S0_R4_academy_schedule_conflict_check"
    priority: 94
    description: "학원 수업 일정과 목표 일정 충돌 검사"
    conditions:
      - field: "academy_schedule"
        operator: "!="
        value: null
      - field: "weekly_goal_schedule"
        operator: "!="
        value: null
    action:
      - "check: 'schedule_conflict'"
      - "generate_description: 'academy_goal_schedule_alignment'"
      - "display_message: '학원 수업 일정과 목표 일정의 충돌을 검사하고 조정합니다.'"
    confidence: 0.92
    rationale: "학원 일정과 목표 일정 충돌 방지 필수"

  # ========== R16: 수학 학습 단계별 목표 관련 룰 ==========
  
  - rule_id: "R16a_math_learning_stage_structure"
    priority: 93
    description: "수학 학습 단계별(개념/유형/심화/기출) 목표 구조 분석"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "math_unit_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'math_learning_stage_structure'"
      - "generate_description: 'concept_type_advanced_past_loop'"
      - "display_message: '수학 목표가 개념 이해 → 유형 연습 → 심화 → 기출 단계로 구성되어 있는지 분석합니다.'"
    confidence: 0.91
    rationale: "수학 학습 단계별 구조가 목표 효과성의 핵심"

  - rule_id: "R16b_concept_stage_goal_adequacy"
    priority: 91
    description: "개념 이해 단계 목표 적절성 검증"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "learning_stage"
        operator: "=="
        value: "concept"
      - field: "concept_goal_duration_days"
        operator: "!="
        value: null
    action:
      - "analyze: 'concept_stage_goal_adequacy'"
      - "validate: 'concept_goal_duration_by_unit_difficulty'"
      - "display_message: '개념 이해 단계 목표의 기간과 분량이 단원 난이도에 맞는지 검증합니다.'"
    confidence: 0.89
    rationale: "개념 단계 목표가 적절해야 유형 단계로 진행 가능"

  - rule_id: "R16c_type_stage_goal_adequacy"
    priority: 90
    description: "유형 연습 단계 목표 적절성 검증"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "learning_stage"
        operator: "=="
        value: "type"
      - field: "type_goal_duration_days"
        operator: "!="
        value: null
    action:
      - "analyze: 'type_stage_goal_adequacy'"
      - "validate: 'type_goal_duration_by_unit_difficulty'"
      - "display_message: '유형 연습 단계 목표의 기간과 분량이 단원 난이도에 맞는지 검증합니다.'"
    confidence: 0.88
    rationale: "유형 단계 목표가 적절해야 심화 단계로 진행 가능"

  - rule_id: "R16d_advanced_past_stage_goal_adequacy"
    priority: 89
    description: "심화/기출 단계 목표 적절성 검증"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "learning_stage"
        operator: "in"
        value: ["advanced", "past"]
      - field: "advanced_past_goal_duration_days"
        operator: "!="
        value: null
    action:
      - "analyze: 'advanced_past_stage_goal_adequacy'"
      - "validate: 'advanced_past_goal_duration_by_unit_difficulty'"
      - "display_message: '심화/기출 단계 목표의 기간과 분량이 단원 난이도와 시험 일정에 맞는지 검증합니다.'"
    confidence: 0.87
    rationale: "심화/기출 단계 목표가 시험 대비의 핵심"

  # ========== R17: 학원-학교 목표 연계 관련 룰 ==========
  
  - rule_id: "R17a_academy_school_goal_alignment"
    priority: 92
    description: "학원 진도와 학교 시험 목표 연계 분석"
    conditions:
      - field: "academy_progress_unit"
        operator: "!="
        value: null
      - field: "school_exam_scope"
        operator: "!="
        value: null
      - field: "quarterly_goal_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'academy_school_goal_alignment'"
      - "generate_description: 'academy_progress_exam_goal_connection'"
      - "display_message: '학원 진도와 학교 시험 목표를 연계하여 목표를 설정합니다.'"
    confidence: 0.9
    rationale: "학원 진도 기반 학교 시험 목표 연계가 학습 효율성 향상"

  - rule_id: "R17b_academy_homework_goal_integration"
    priority: 91
    description: "학원 과제를 목표에 통합"
    conditions:
      - field: "academy_homework_exists"
        operator: "=="
        value: true
      - field: "weekly_goal_id"
        operator: "!="
        value: null
    action:
      - "integrate: 'academy_homework_into_goals'"
      - "generate_description: 'homework_goal_consistency'"
      - "display_message: '학원 과제를 주간 목표에 통합하여 일관성 있는 목표 관리를 합니다.'"
    confidence: 0.89
    rationale: "학원 과제 통합이 목표 일관성 유지의 핵심"

  - rule_id: "R17c_academy_school_conflict_resolution"
    priority: 88
    description: "학원 진도와 학교 진도 충돌 시 목표 조정"
    conditions:
      - field: "academy_progress_unit"
        operator: "!="
        value: null
      - field: "school_progress_unit"
        operator: "!="
        value: null
      - field: "progress_conflict_detected"
        operator: "=="
        value: true
    action:
      - "analyze: 'academy_school_conflict'"
      - "recommend: 'goal_adjustment_for_conflict_resolution'"
      - "display_message: '학원 진도와 학교 진도 충돌 시 목표를 조정하여 최적의 학습 경로를 제안합니다.'"
    confidence: 0.87
    rationale: "진도 충돌 해결이 학습 혼란 방지의 핵심"

  # ========== R18: 단원 연계성 기반 목표 관련 룰 ==========
  
  - rule_id: "R18a_unit_prerequisite_check"
    priority: 90
    description: "단원 선후관계 기반 목표 순서 검증"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "math_unit_id"
        operator: "!="
        value: null
      - field: "unit_prerequisite_db"
        operator: "!="
        value: null
    action:
      - "check: 'unit_prerequisite_order'"
      - "validate: 'goal_sequence_by_unit_dependency'"
      - "display_message: '단원 선후관계를 확인하여 목표 순서가 올바른지 검증합니다.'"
    confidence: 0.89
    rationale: "단원 선후관계 준수가 목표 달성 가능성의 기반"

  - rule_id: "R18b_linked_unit_simultaneous_goal"
    priority: 88
    description: "연계 단원 동시 학습 목표 제안"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "math_unit_id"
        operator: "!="
        value: null
      - field: "linked_unit_id"
        operator: "!="
        value: null
    action:
      - "recommend: 'linked_unit_simultaneous_goal'"
      - "generate_description: 'simultaneous_learning_strategy'"
      - "display_message: '연계 단원을 동시에 학습하면 효과적인 경우 목표를 함께 설정합니다.'"
    confidence: 0.87
    rationale: "연계 단원 동시 학습이 이해도 향상에 효과적"

  # ========== R19: 수준별 수학 목표 관련 룰 ==========
  
  - rule_id: "R19a_math_learning_style_goal_differentiation"
    priority: 89
    description: "수학 학습 스타일별 목표 차별화"
    conditions:
      - field: "math_learning_style"
        operator: "!="
        value: null
      - field: "goal_subject"
        operator: "=="
        value: "math"
    action:
      - "differentiate: 'goal_by_math_learning_style'"
      - "generate_description: 'learning_style_specific_goal_structure'"
      - "display_message: '수학 학습 스타일(계산형/개념형/응용형)에 맞게 목표를 차별화합니다.'"
    confidence: 0.88
    rationale: "학습 스타일별 목표 차별화가 목표 달성률 향상"

  - rule_id: "R19b_student_level_goal_duration_adjustment"
    priority: 87
    description: "학생 수준별 목표 기간 조정"
    conditions:
      - field: "student_level"
        operator: "!="
        value: null
      - field: "goal_duration_days"
        operator: "!="
        value: null
    action:
      - "adjust: 'goal_duration_by_student_level'"
      - "generate_description: 'level_based_duration_optimization'"
      - "display_message: '학생 수준(하위권/중위권/상위권)에 맞게 목표 기간을 조정합니다.'"
    confidence: 0.86
    rationale: "수준별 목표 기간 조정이 현실성 향상"

  - rule_id: "R19c_student_level_goal_volume_adjustment"
    priority: 85
    description: "학생 수준별 목표 분량 조정"
    conditions:
      - field: "student_level"
        operator: "!="
        value: null
      - field: "goal_volume"
        operator: "!="
        value: null
    action:
      - "adjust: 'goal_volume_by_student_level'"
      - "generate_description: 'level_based_volume_optimization'"
      - "display_message: '학생 수준에 맞게 목표 분량을 조정합니다. (하위권: 적게, 상위권: 많게)'"
    confidence: 0.85
    rationale: "수준별 목표 분량 조정이 실행 가능성 향상"

  # ========== R20: 출제 비중 기반 목표 관련 룰 ==========
  
  - rule_id: "R20a_exam_weight_based_goal_weight"
    priority: 86
    description: "출제 비중 기반 목표 가중치 조정"
    conditions:
      - field: "exam_unit_weight"
        operator: "!="
        value: null
      - field: "goal_id"
        operator: "!="
        value: null
      - field: "exam_weeks_remaining"
        operator: "<="
        value: 8
    action:
      - "adjust: 'goal_weight_by_exam_weight'"
      - "generate_description: 'exam_weight_goal_priority_alignment'"
      - "display_message: '시험 출제 비중에 따라 목표 가중치를 조정하여 우선순위를 정합니다.'"
    confidence: 0.85
    rationale: "출제 비중 반영이 시험 대비 효율성 향상"

  - rule_id: "R20b_unit_weight_goal_time_allocation"
    priority: 84
    description: "단원별 출제 비중에 따른 목표 시간 배분"
    conditions:
      - field: "exam_unit_weight"
        operator: "!="
        value: null
      - field: "total_study_time_hours"
        operator: "!="
        value: null
      - field: "exam_weeks_remaining"
        operator: "<="
        value: 8
    action:
      - "allocate: 'study_time_by_unit_weight'"
      - "generate_description: 'weight_based_time_distribution'"
      - "display_message: '단원별 출제 비중에 따라 목표 학습 시간을 배분합니다.'"
    confidence: 0.83
    rationale: "출제 비중 기반 시간 배분이 시험 대비 효율성 극대화"

  # ========== R21: 교육과정 정합성 관련 룰 ==========
  
  - rule_id: "R21a_curriculum_standard_goal_validation"
    priority: 85
    description: "교육과정 표준과 목표 적절성 검증"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "curriculum_standard_db"
        operator: "!="
        value: null
      - field: "goal_content"
        operator: "!="
        value: null
    action:
      - "validate: 'goal_against_curriculum_standard'"
      - "generate_description: 'curriculum_compliance_check'"
      - "display_message: '교육과정 표준과 비교하여 목표가 적절한지 검증합니다.'"
    confidence: 0.84
    rationale: "교육과정 표준 준수가 목표 타당성의 기반"

  - rule_id: "R21b_unit_curriculum_mapping_analysis"
    priority: 83
    description: "단원별 커리큘럼 매핑 분석"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "math_unit_id"
        operator: "!="
        value: null
      - field: "long_term_curriculum_trend"
        operator: "!="
        value: null
    action:
      - "analyze: 'unit_curriculum_mapping'"
      - "generate_description: 'unit_position_in_long_term_curriculum'"
      - "display_message: '현재 목표 단원이 장기 커리큘럼의 어느 위치에 해당하는지 분석합니다.'"
    confidence: 0.82
    rationale: "단원별 커리큘럼 매핑이 장기 학습 계획의 기반"

  # ========== R22: 수학 특화 회복 전략 관련 룰 ==========
  
  - rule_id: "R22a_difficult_unit_recovery_strategy"
    priority: 82
    description: "어려운 단원 회복 전략: 쉬운 문제로 시작"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "unit_difficulty_score"
        operator: ">"
        value: 7
      - field: "recovery_time_avg"
        operator: ">"
        value: 3
    action:
      - "recommend: 'easy_problem_recovery_strategy'"
      - "generate_description: 'difficult_unit_gradual_recovery'"
      - "display_message: '어려운 단원은 쉬운 문제부터 시작하여 점진적으로 회복하는 전략을 제안합니다.'"
    confidence: 0.81
    rationale: "어려운 단원 회복은 쉬운 문제부터 시작하는 것이 효과적"

  - rule_id: "R22b_easy_unit_rapid_progress_strategy"
    priority: 80
    description: "쉬운 단원 빠른 진행 전략"
    conditions:
      - field: "goal_subject"
        operator: "=="
        value: "math"
      - field: "unit_difficulty_score"
        operator: "<"
        value: 4
      - field: "weekly_completion_rate"
        operator: ">"
        value: 80
    action:
      - "recommend: 'rapid_progress_strategy'"
      - "generate_description: 'easy_unit_fast_track'"
      - "display_message: '쉬운 단원은 빠르게 진행하여 시간을 확보하는 전략을 제안합니다.'"
    confidence: 0.79
    rationale: "쉬운 단원 빠른 진행이 전체 학습 효율성 향상"

  # ========== R23: 학원 과제 통합 관련 룰 ==========
  
  - rule_id: "R23a_academy_homework_goal_synchronization"
    priority: 81
    description: "학원 과제와 목표 동기화"
    conditions:
      - field: "academy_homework_exists"
        operator: "=="
        value: true
      - field: "weekly_goal_id"
        operator: "!="
        value: null
      - field: "homework_goal_sync_status"
        operator: "=="
        value: false
    action:
      - "synchronize: 'academy_homework_with_goals'"
      - "generate_description: 'homework_goal_integration'"
      - "display_message: '학원 과제를 목표에 통합하여 일관성 있는 학습 관리가 되도록 합니다.'"
    confidence: 0.8
    rationale: "학원 과제 통합이 목표 일관성 및 학습 효율성 향상"

  # ========== R24: 귀가검사(Goinghome) 데이터 기반 분석 룰 ==========
  
  - rule_id: "R24a_calmness_routine_analysis"
    priority: 88
    description: "침착함 점수 기반 루틴 저항도 분석"
    conditions:
      - field: "calmness"
        operator: "<"
        value: 3
      - field: "routine_start_resistance"
        operator: "!="
        value: null
    action:
      - "analyze: 'calmness_routine_correlation'"
      - "generate_description: 'low_calmness_routine_impact'"
      - "display_message: '침착함 점수가 낮아 루틴 시작 저항도가 높을 수 있습니다. 감정 안정화 전략을 분석합니다.'"
    confidence: 0.87
    rationale: "침착함 점수 3 미만 시 루틴 저항도 상승 가능성 분석"

  - rule_id: "R24b_inefficiency_goal_mismatch"
    priority: 90
    description: "비효율성 감지 시 목표-계획 불일치 심층 분석"
    conditions:
      - field: "inefficiency"
        operator: ">"
        value: 3
      - field: "weekly_completion_rate"
        operator: "<"
        value: 70
    action:
      - "analyze: 'inefficiency_goal_plan_mismatch'"
      - "generate_description: 'inefficiency_root_cause_analysis'"
      - "display_message: '학생이 비효율성을 느끼고 있으며 주간 달성률이 저하되었습니다. 목표-계획 불일치 원인을 분석합니다.'"
    confidence: 0.89
    rationale: "비효율성 점수와 달성률 저하의 상관관계 분석"

  - rule_id: "R24c_missed_opportunity_resilience"
    priority: 89
    description: "놓친 기회 감지 시 회복탄력성 분석"
    conditions:
      - field: "missed_opportunity"
        operator: ">"
        value: 2
      - field: "recovery_time_avg"
        operator: ">"
        value: 2
    action:
      - "analyze: 'missed_opportunity_recovery_pattern'"
      - "generate_description: 'opportunity_loss_resilience_impact'"
      - "display_message: '놓친 기회가 감지되었습니다. 회복탄력성 패턴과 연계하여 대응 전략을 분석합니다.'"
    confidence: 0.88
    rationale: "놓친 기회와 회복 시간의 상관관계 분석"

  - rule_id: "R24d_positive_moment_motivation"
    priority: 85
    description: "긍정적 순간 활용 동기 부여 전략"
    conditions:
      - field: "positive_moment"
        operator: "!="
        value: null
      - field: "goal_motivation_score"
        operator: "<"
        value: 60
    action:
      - "analyze: 'positive_moment_motivation_leverage'"
      - "recommend: 'motivation_enhancement_from_positive'"
      - "display_message: '긍정적인 순간이 기록되어 있습니다. 이를 활용한 동기 부여 전략을 제안합니다.'"
    confidence: 0.84
    rationale: "긍정적 경험을 동기 부여 자원으로 활용"

  - rule_id: "R24e_pace_anxiety_time_pressure"
    priority: 91
    description: "속도 불안 감지 시 시간 압박 요인 분석"
    conditions:
      - field: "pace_anxiety"
        operator: ">"
        value: 3
      - field: "time_shortage_logs"
        operator: ">="
        value: 2
    action:
      - "analyze: 'pace_anxiety_time_correlation'"
      - "generate_description: 'pace_anxiety_root_cause'"
      - "display_message: '속도 불안이 감지되었습니다. 시간 압박 요인과의 연관성을 분석하고 완화 전략을 제안합니다.'"
    confidence: 0.9
    rationale: "속도 불안과 시간 부족의 상관관계 분석"

  # ========== R25: 스트레스 레벨 기반 분석 룰 ==========
  
  - rule_id: "R25a_stress_level_resilience_impact"
    priority: 92
    description: "스트레스 레벨이 높을 때 회복탄력성 영향 분석"
    conditions:
      - field: "stress_level"
        operator: ">"
        value: 7
      - field: "recovery_time_avg"
        operator: ">"
        value: 2
    action:
      - "analyze: 'stress_resilience_correlation'"
      - "alert: '높은 스트레스 레벨로 인한 회복탄력성 저하 감지'"
      - "display_message: '스트레스 레벨이 높고 회복 시간이 길어지고 있습니다. 스트레스 관리 전략을 분석합니다.'"
    confidence: 0.91
    rationale: "스트레스 레벨 7 초과 시 회복탄력성 저하 가능성 분석"

  - rule_id: "R25b_stress_routine_resistance"
    priority: 90
    description: "스트레스 레벨과 루틴 저항도 연관 분석"
    conditions:
      - field: "stress_level"
        operator: ">"
        value: 6
      - field: "emotion_score"
        operator: "<"
        value: 5
    action:
      - "analyze: 'stress_routine_resistance_correlation'"
      - "recommend: 'stress_reduction_routine_adaptation'"
      - "display_message: '스트레스와 낮은 감정 점수로 인해 루틴 저항도가 높아질 수 있습니다. 적응 전략을 제안합니다.'"
    confidence: 0.89
    rationale: "스트레스와 루틴 저항도의 상관관계 분석"

  - rule_id: "R25c_stress_goal_overload"
    priority: 88
    description: "스트레스와 목표 과부하 상관관계 분석"
    conditions:
      - field: "stress_level"
        operator: ">"
        value: 6
      - field: "goal_count"
        operator: ">"
        value: 6
    action:
      - "analyze: 'stress_goal_overload_correlation'"
      - "recommend: 'goal_reduction_for_stress_relief'"
      - "display_message: '높은 스트레스와 많은 목표가 감지되었습니다. 목표 개수 조정을 통한 스트레스 완화 전략을 제안합니다.'"
    confidence: 0.87
    rationale: "스트레스와 목표 과부하의 상관관계 분석"

  # ========== R26: 포모도로(Goinghome) 데이터 기반 분석 룰 ==========
  
  - rule_id: "R26a_pomodoro_goinghome_integration"
    priority: 87
    description: "귀가검사 포모도로 데이터와 목표 달성 연계 분석"
    conditions:
      - field: "pomodoro"
        operator: "!="
        value: null
      - field: "today_goal_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'goinghome_pomodoro_goal_correlation'"
      - "generate_description: 'daily_pomodoro_effectiveness'"
      - "display_message: '귀가검사 시점의 포모도로 데이터와 오늘 목표 달성 간의 연관성을 분석합니다.'"
    confidence: 0.86
    rationale: "귀가검사 포모도로 데이터 활용으로 일일 학습 효과성 분석"

  - rule_id: "R26b_pomodoro_calmness_effectiveness"
    priority: 85
    description: "포모도로 수행과 침착함의 상관관계 분석"
    conditions:
      - field: "pomodoro"
        operator: ">="
        value: 3
      - field: "calmness"
        operator: "!="
        value: null
    action:
      - "analyze: 'pomodoro_calmness_correlation'"
      - "generate_description: 'pomodoro_emotional_impact'"
      - "display_message: '포모도로 수행 횟수와 침착함 점수의 상관관계를 분석하여 최적의 학습 패턴을 파악합니다.'"
    confidence: 0.84
    rationale: "포모도로와 감정 상태의 상관관계 분석"

  # ========== R27: 종합 귀가검사 분석 룰 ==========
  
  - rule_id: "R27a_goinghome_comprehensive_analysis"
    priority: 93
    description: "귀가검사 데이터 종합 분석 및 목표 연계"
    conditions:
      - field: "calmness"
        operator: "!="
        value: null
      - field: "inefficiency"
        operator: "!="
        value: null
      - field: "departure_check_session_id"
        operator: "!="
        value: null
    action:
      - "analyze: 'goinghome_comprehensive_review'"
      - "generate_description: 'daily_learning_emotional_summary'"
      - "display_message: '귀가검사 데이터(침착함, 비효율성, 놓친기회, 긍정적순간, 속도불안)를 종합 분석하여 목표 조정 방안을 제시합니다.'"
    confidence: 0.92
    rationale: "귀가검사 데이터 종합 분석으로 일일 학습 상태 파악"

  - rule_id: "R27b_goinghome_goal_adjustment"
    priority: 91
    description: "귀가검사 분석 기반 다음날 목표 조정 제안"
    conditions:
      - field: "inefficiency"
        operator: ">"
        value: 3
      - field: "missed_opportunity"
        operator: ">"
        value: 2
    action:
      - "recommend: 'next_day_goal_adjustment'"
      - "generate_description: 'goinghome_based_goal_optimization'"
      - "display_message: '오늘 비효율성과 놓친 기회가 감지되었습니다. 내일 목표를 현실적으로 조정하는 방안을 제안합니다.'"
    confidence: 0.9
    rationale: "귀가검사 결과 기반 선제적 목표 조정"

# Default fallback rule
default_rule:
  rule_id: "default"
  action:
    - "display_message: '목표 분석 정보를 수집하고 분석 중입니다.'"
  confidence: 0.5
  rationale: "기본 목표 분석 루틴 적용"

# ========== 데이터 기반 질문 연계 정보 ==========
# 
# 이 rules.yaml 파일은 questions.html의 포괄형 질문과 data_based_questions.js의 데이터 기반 질문과 연계됩니다.
#
# 포괄형 질문 1: "이 학생의 목표와 계획이 실제 학습 리듬 속에서 얼마나 유기적으로 작동하고 있나요?"
#   - 연계 룰: R1a~R1d (목표-계획 불일치 감지)
#   - 데이터 소스: quarterly_goal, weekly_goal, daily_goal, goal_connection_strength, goal_reality_score, schedule_variability, resilience_index
#   - 온톨로지: GoalPlanOrganicOperation, GoalConnectionStrength, ResilienceIndex
#
# 포괄형 질문 2: "현재 학생의 학습 궤도가 장기 커리큘럼과 목표 궤적 위에 안정적으로 놓여 있나요?"
#   - 연계 룰: R3a~R3d (학습 궤도 안정성 분석)
#   - 데이터 소스: quarterly_goal, long_term_curriculum, curriculum_goal_alignment, exam_schedule_reflection_rate, orbit_deviation
#   - 온톨로지: LearningOrbitStability, CurriculumGoalAlignment, OrbitReentryStrategy
#   - 연계 에이전트: Agent 02 (시험일정), Agent 09 (학습관리)
#
# 포괄형 질문 3: "이 학생의 목표 설계 구조는 변동 상황에서도 회복 가능하고, 선생님의 노하우가 반영된 형태인가요?"
#   - 연계 룰: R4a~R4d (목표 설계 구조 회복 가능성)
#   - 데이터 소스: goal_staging_level, goal_elasticity, schedule_change_response_strategy, emotion_based_recovery_pattern, teacher_feedback_reflection_rate
#   - 온톨로지: GoalDesignResilience, GoalStagingElasticity, TeacherKnowhowRecovery
#   - 연계 에이전트: Agent 05 (학습감정), Agent 06 (교사피드백)
#
# 자세한 데이터 기반 질문 정의는 data_based_questions.js의 agent03 섹션을 참조하세요.

# ========== 귀가검사 및 온보딩 데이터 필드 정의 ==========
# 
# 이 섹션은 alt42_goinghome 및 alt42o_onboarding 테이블에서 가져오는 필드를 정의합니다.
#
# alt42_goinghome 테이블 필드 (R24~R27 룰에서 사용):
#   - calmness: 침착함 점수 (1-5), 학습 시 감정 안정도
#   - inefficiency: 비효율성 점수 (1-5), 학습 효율성 자가 평가
#   - missed_opportunity: 놓친 기회 점수 (1-5), 기회 활용도
#   - positive_moment: 긍정적 순간 (텍스트), 동기 부여 자원
#   - pace_anxiety: 속도 불안 점수 (1-5), 시간 압박 스트레스
#   - pomodoro: 포모도로 완료 횟수 (정수), 집중 세션 수
#   - student_name: 학생 이름 (식별용, 조건에서 미사용)
#   - responses: 응답 데이터 (JSON, 조건에서 미사용)
#   - report_id: 리포트 ID (참조용, 조건에서 미사용)
#   - date: 작성 날짜 (타임스탬프, 조건에서 미사용)
#
# alt42o_onboarding 테이블 필드 (R25 룰에서 사용):
#   - stress_level: 스트레스 레벨 (1-10), 전반적 스트레스 상태
#
# alt42g_goal_analysis 테이블 필드:
#   - id: 분석 ID (참조용, 조건에서 미사용)
#   - analysis_type: 분석 유형 (quarter/weekly/today/correlation)
#   - effectiveness_score: 효과성 점수 (0-100)
#
# 연계 룰 요약:
#   - R24a: calmness + routine_start_resistance → 침착함-루틴 저항 분석
#   - R24b: inefficiency + weekly_completion_rate → 비효율성-목표 불일치 분석
#   - R24c: missed_opportunity + recovery_time_avg → 놓친기회-회복탄력성 분석
#   - R24d: positive_moment + goal_motivation_score → 긍정순간-동기부여 분석
#   - R24e: pace_anxiety + time_shortage_logs → 속도불안-시간압박 분석
#   - R25a~c: stress_level 기반 회복탄력성/루틴저항도/목표과부하 분석
#   - R26a~b: pomodoro 기반 목표달성/감정상태 분석
#   - R27a~b: 귀가검사 종합 분석 및 목표 조정
