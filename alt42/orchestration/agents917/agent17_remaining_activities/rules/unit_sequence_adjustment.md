# 단원 연계성 기반 활동 순서 조정 룰

## 목적
수학 단원 간 선후관계 및 연계성을 고려하여 잔여 활동의 순서를 조정하여 효율적인 학습을 지원합니다.

---

## 데이터 소스
- `math_unit_relations.yaml` (agent02 참고): 단원 간 선후관계 및 연계성 정보
- 학생 설문: 어떤 단원을 먼저 배웠는지
- 선생님 체크리스트: 단원 선후관계 정의

---

## 단원 연계성 유형

### 1. 선후관계 (Prerequisites)
- **정의**: 한 단원이 다른 단원의 기초가 되는 관계
- **특징**: 선행 단원 완료 후 후속 단원 학습 필요
- **예시**: 정수와 유리수 → 일차방정식 → 함수

### 2. 연계 단원 (Related Units)
- **정의**: 서로 연관되어 함께 학습하면 효과적인 단원
- **특징**: 동시 학습 또는 연속 학습 권장
- **예시**: 함수 + 그래프, 일차함수 + 연립방정식

---

## 순서 조정 알고리즘

### Step 1: 선후관계 검증
```
for each activity in remaining_activities:
    unit = activity.unit
    prerequisites = get_prerequisites(unit)
    
    for prereq in prerequisites:
        if not is_completed(prereq):
            # 선행 단원 미완료 → 후속 단원 연기
            postpone_activity(activity)
            add_to_waiting_list(activity, prereq)
```

### Step 2: 연계 단원 그룹화
```
related_groups = []
for each activity in remaining_activities:
    unit = activity.unit
    related_units = get_related_units(unit)
    
    # 연계 단원이 잔여 활동에 포함되어 있는지 확인
    related_activities = find_related_activities(related_units)
    
    if related_activities:
        # 연계 단원 그룹 생성
        group = create_group(activity, related_activities)
        related_groups.append(group)
```

### Step 3: 순서 재배치
```
# 1. 선후관계 준수
ordered_activities = sort_by_prerequisites(remaining_activities)

# 2. 연계 단원 그룹화
grouped_activities = group_related_units(ordered_activities)

# 3. 최종 순서 결정
final_sequence = []
for group in grouped_activities:
    if group.type == "sequential":
        # 순차 학습: 선행 단원 → 후속 단원
        final_sequence.extend(group.activities)
    elif group.type == "simultaneous":
        # 동시 학습: 연계 단원 함께 배치
        final_sequence.extend(group.activities)
```

---

## 순서 조정 규칙

### Rule 1: 선후관계 필수 준수
- **조건**: 선행 단원이 미완료인 경우
- **규칙**: 후속 단원은 선행 단원 완료 후에만 진행
- **예시**: 일차방정식 미완료 → 함수 단원 연기

### Rule 2: 연계 단원 동시 학습
- **조건**: 연계 단원이 모두 잔여 활동에 포함된 경우
- **규칙**: 연계 단원을 연속 세션으로 배치
- **예시**: 함수 + 그래프 → 연속 2세션 배치

### Rule 3: 기초 단원 우선순위
- **조건**: 선후관계가 있는 단원들 중
- **규칙**: 기초 단원(선행 단원)을 우선 배정
- **예시**: 정수와 유리수 → 일차방정식 → 함수 순서

### Rule 4: 시간 부족 시 선후관계 우선
- **조건**: 시간이 부족하여 일부 단원만 선택해야 할 때
- **규칙**: 선후관계를 고려하여 필수 단원 우선 선택
- **예시**: 정수와 유리수 + 일차방정식 선택, 함수는 연기

---

## 활동 조정 프로세스

### Step 1: 단원 정보 추출
1. 각 잔여 활동의 단원 정보 확인
2. `math_unit_relations.yaml`에서 단원별 선후관계 및 연계 정보 조회

### Step 2: 선후관계 검증
1. 각 활동의 선행 단원 확인
2. 선행 단원 완료 여부 확인
3. 미완료 선행 단원이 있는 활동 식별

### Step 3: 연계 단원 그룹화
1. 각 활동의 연계 단원 확인
2. 연계 단원이 잔여 활동에 포함되어 있는지 확인
3. 연계 단원 그룹 생성

### Step 4: 순서 재배치
1. 선후관계 기반 순서 정렬
2. 연계 단원 그룹화 적용
3. 최종 활동 순서 결정

### Step 5: 활동 계획 수립
1. 재배치된 순서로 활동 계획 생성
2. 선행 단원 미완료 활동은 대기 목록에 추가
3. 코칭 메시지 생성

---

## 코칭 템플릿

### 선후관계 미준수 시
- "일차방정식 단원을 먼저 완료한 후 함수 단원을 진행해야 합니다."
- "정수와 유리수 단원이 함수 학습의 기초가 되므로 먼저 완료합시다."
- "선행 단원이 완료되지 않아 함수 단원을 연기하고, 일차방정식 단원부터 진행합시다."

### 연계 단원 동시 학습 권장
- "함수와 그래프는 서로 연관되어 있으니 함께 학습하면 효과적입니다."
- "일차함수와 연립방정식은 연계 학습을 권장합니다."
- "이차함수와 이차방정식은 반드시 함께 학습해야 합니다."

### 기초 단원 우선
- "기초 단원(정수와 유리수)을 먼저 완료해야 후속 단원을 제대로 학습할 수 있습니다."
- "기초가 안 되면 심화 단원을 학습해도 효과가 떨어집니다."

### 시간 부족 시 선후관계 우선
- "시간이 부족하니 기초 단원부터 완료하고, 후속 단원은 내일로 연기합시다."
- "선후관계를 고려하여 필수 단원만 선별하여 완료합시다."

---

## 데이터 수집 필요 항목

### 학생 설문
- "어떤 단원을 먼저 배웠나요?"
- "어떤 단원들이 서로 연관되어 있나요?"
- "어떤 단원을 먼저 배워야 다른 단원을 이해할 수 있나요?"

### 선생님 체크리스트
- [ ] 학년별 단원 선후관계 정의
- [ ] 연계 단원 동시 학습 전략
- [ ] 기초 단원 우선순위 설정

### 선생님 텍스트 입력
- "방정식 단원 완료 후 함수 단원 진행"
- "함수와 그래프는 동시 학습 권장"
- "정수와 유리수 → 일차방정식 → 함수 순서 필수"
- "일차함수와 연립방정식은 함께 공부하면 효과적"
- "이차함수와 이차방정식은 반드시 함께 학습해야 함"

---

## 예시 시나리오

### 시나리오 1: 선후관계 미준수
**상황**:
- 잔여 활동: 함수 단원, 일차방정식 단원
- 일차방정식 단원: 미완료
- 함수 단원: 선행 단원(일차방정식) 필요

**선후관계 검증**:
- 함수 단원의 선행 단원: 일차방정식
- 일차방정식 미완료 → 함수 단원 연기

**순서 조정**:
1. 일차방정식 단원 우선 배정
2. 함수 단원은 일차방정식 완료 후 진행

**코칭**: "일차방정식 단원을 먼저 완료한 후 함수 단원을 진행해야 합니다. 함수 학습의 기초가 되므로 반드시 선행 단원을 완료합시다."

### 시나리오 2: 연계 단원 동시 학습
**상황**:
- 잔여 활동: 함수 단원, 함수와 그래프 단원
- 두 단원은 연계 단원 (동시 학습 권장)

**연계 단원 그룹화**:
- 함수 + 함수와 그래프 → 연계 그룹 생성

**순서 조정**:
- 함수 단원 → 함수와 그래프 단원 (연속 세션)

**코칭**: "함수와 그래프는 서로 연관되어 있으니 함께 학습하면 효과적입니다. 함수 단원을 완료한 직후 함수와 그래프 단원을 진행합시다."

### 시나리오 3: 시간 부족 시 선후관계 우선
**상황**:
- 가용 시간: 2시간
- 잔여 활동: 정수와 유리수, 일차방정식, 함수
- 예상 시간: 각 1시간씩 (총 3시간)

**선후관계**:
- 정수와 유리수 → 일차방정식 → 함수

**순서 조정**:
- 시간 부족 (2시간 < 3시간)
- 선후관계 고려하여 필수 단원 선별
- 정수와 유리수 + 일차방정식 선택 (2시간)
- 함수 단원 연기

**코칭**: "시간이 부족하니 기초 단원(정수와 유리수, 일차방정식)부터 완료하고, 함수 단원은 내일로 연기합시다. 선후관계를 고려하여 필수 단원만 선별하여 완료합시다."

---

## 단원 연계성 예시 (agent02 참고)

### 중학교 1학년
- **정수와 유리수** → **일차방정식** → **함수** (순차 학습)
- **함수** + **함수와 그래프** (동시 학습 권장)

### 중학교 2학년
- **일차함수** + **연립방정식** (연계 학습 권장)
- **일차방정식** → **일차함수** (순차 학습)

### 중학교 3학년
- **이차함수** + **이차방정식** (연계 학습 필수)
- **연립방정식** → **이차방정식** (순차 학습)

---

Last Updated: 2025-01-21

