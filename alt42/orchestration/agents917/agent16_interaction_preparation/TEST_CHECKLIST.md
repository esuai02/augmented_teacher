# Agent 16 Interaction Preparation - Test Checklist

## 테스트 개요

이 문서는 Agent 16 (상호작용 준비) 패널의 완전한 기능 검증을 위한 체크리스트입니다.

## 사전 준비

### 데이터베이스 설정
- [ ] 마이그레이션 스크립트 실행 완료
- [ ] `agent16_interaction_scenarios` 테이블 생성 확인
- [ ] 테이블 권한 확인 (INSERT, SELECT, DELETE)

### 파일 접근성
- [ ] `/agents/agent16_interaction_preparation/ui/panel.js` 접근 가능
- [ ] `/agents/agent16_interaction_preparation/ui/panel.css` 접근 가능
- [ ] 모든 API 엔드포인트 (generate, save, list, delete) 접근 가능

### 환경 설정
- [ ] Moodle 로그인 상태 확인
- [ ] `window.currentUserId` 값 정상 설정 확인
- [ ] 브라우저 콘솔 에러 없음

## 1. Standalone 페이지 테스트

**테스트 URL**: `https://mathking.kr/moodle/local/augmented_teacher/alt42/orchestration/agents/agent16_interaction_preparation/index.php`

### 페이지 로드
- [ ] 페이지가 정상적으로 로드됨
- [ ] 헤더 "Agent 16 - 상호작용 준비" 표시됨
- [ ] "상호작용 준비 패널 열기" 버튼 표시됨
- [ ] 브라우저 콘솔에 에러 없음

### 패널 열기
- [ ] 버튼 클릭 시 패널이 오른쪽에서 슬라이드 인
- [ ] 패널 헤더 "상호작용 준비" 표시됨
- [ ] 3개 탭 (상호작용 모드, 시나리오 생성, 생성 결과) 표시됨
- [ ] 닫기 버튼 (×) 표시됨

### 패널 닫기
- [ ] 닫기 버튼 클릭 시 패널이 슬라이드 아웃
- [ ] ESC 키 누를 때 패널 닫힘
- [ ] 패널 외부 클릭 시 패널 닫힘

## 2. 상호작용 모드 탭 테스트

### 모드 카드 표시
- [ ] 9개 모드 카드가 그리드로 표시됨:
  - [ ] 커리큘럼
  - [ ] 맞춤학습
  - [ ] 시험대비
  - [ ] 단기미션
  - [ ] 자기성찰
  - [ ] 자기주도
  - [ ] 도제학습
  - [ ] 시간성찰
  - [ ] 탐구학습
- [ ] 각 카드에 모드명과 요약 설명 표시됨
- [ ] 각 카드에 "상세보기" 버튼 표시됨

### 모드 선택
- [ ] 카드 클릭 시 선택 상태로 변경 (보라색 테두리)
- [ ] 선택된 카드에 체크 표시 (✓) 나타남
- [ ] 다른 카드 선택 시 이전 선택 해제됨
- [ ] GPT 링크 섹션 업데이트됨

### GPT 링크
- [ ] 모드 선택 시 "GPT와 대화하기" 링크 활성화됨
- [ ] 링크 클릭 시 새 탭에서 해당 모드의 GPT 채팅 열림
- [ ] 9개 모드 각각의 GPT 링크가 정확함

### 상세보기 모달
- [ ] "상세보기" 버튼 클릭 시 모달 열림
- [ ] 모달에 전체 모드 설명 표시됨
- [ ] "이 모드 선택" 버튼 작동
- [ ] "닫기" 버튼으로 모달 닫힘
- [ ] 모달 외부 클릭으로 닫힘

## 3. 시나리오 생성 탭 테스트

### 모드 미선택 상태
- [ ] 모드를 선택하지 않고 탭 이동 시 경고 메시지 표시
- [ ] "모드 선택하러 가기" 버튼으로 첫 번째 탭으로 이동

### 입력 폼
- [ ] 선택된 모드 정보 표시됨 (배지)
- [ ] VibeCoding 프롬프트 textarea 표시
- [ ] DBTracking 프롬프트 textarea 표시
- [ ] placeholder 텍스트 표시됨
- [ ] "시나리오 생성" 버튼 표시
- [ ] "초기화" 버튼 표시

### 유효성 검증
- [ ] 빈 프롬프트로 생성 시도 시 경고 알림
- [ ] 두 프롬프트 모두 입력 시 생성 진행

### 시나리오 생성 - GPT API
- [ ] API 키 설정된 경우: GPT-4o API 호출 성공
- [ ] 생성 중 로딩 상태 표시 ("생성 중...")
- [ ] 생성 완료 시 결과 영역 표시
- [ ] 마크다운이 HTML로 정상 렌더링됨

### 시나리오 생성 - Fallback
- [ ] API 키 미설정/실패 시 폴백 시나리오 생성
- [ ] 폴백 시나리오에 기본 정보 포함됨:
  - [ ] 생성 시각
  - [ ] 선택된 모드
  - [ ] VibeCoding 맥락
  - [ ] DBTracking 데이터
  - [ ] 추천 상호작용 전략
- [ ] 폴백 시나리오 하단에 참고 메시지 표시

### 시나리오 결과 표시
- [ ] 생성된 시나리오가 HTML로 렌더링됨
- [ ] 헤더, 리스트, 강조 등 마크다운 요소 정상 표시
- [ ] "복사" 버튼 표시
- [ ] "저장" 버튼 표시

### 복사 기능
- [ ] "복사" 버튼 클릭 시 클립보드에 복사됨
- [ ] 복사 성공 시 버튼 텍스트 변경 ("✅ 복사됨!")
- [ ] 2초 후 원래 상태로 복귀

### 저장 기능
- [ ] "저장" 버튼 클릭 시 DB에 저장됨
- [ ] 저장 중 로딩 상태 표시
- [ ] 저장 성공 시 버튼 텍스트 변경 ("✅ 저장 완료!")
- [ ] 브라우저 콘솔에 성공 메시지 출력
- [ ] 저장 실패 시 에러 메시지 표시

### 초기화 기능
- [ ] "초기화" 버튼 클릭 시 두 textarea 초기화
- [ ] 결과 영역 숨겨짐

## 4. 생성 결과 탭 테스트

### 빈 상태
- [ ] 저장된 시나리오가 없을 때 빈 상태 메시지 표시
- [ ] "시나리오 생성하기" 버튼으로 두 번째 탭 이동

### 시나리오 목록
- [ ] 저장된 모든 시나리오 카드 표시
- [ ] 카드별 정보:
  - [ ] 가이드 모드 배지
  - [ ] 생성 일시
  - [ ] 시나리오 미리보기 (150자)
- [ ] 카드 hover 효과 (배경색 변경, 그림자)

### 액션 버튼
- [ ] 각 카드에 3개 버튼 표시:
  - [ ] 👁️ 상세보기
  - [ ] 📋 복사
  - [ ] 🗑️ 삭제

### 상세보기 모달
- [ ] "상세보기" 클릭 시 모달 열림
- [ ] 모달 헤더에 모드명과 생성 일시 표시
- [ ] 모달 본문에 전체 시나리오 표시 (마크다운 렌더링)
- [ ] "복사" 버튼으로 복사 가능
- [ ] "닫기" 버튼으로 모달 닫힘

### 복사 기능
- [ ] "복사" 버튼 클릭 시 시나리오 복사됨
- [ ] 카드 배경색이 녹색으로 1초간 변경 (시각적 피드백)
- [ ] 브라우저 콘솔에 성공 메시지 출력

### 삭제 기능
- [ ] "삭제" 버튼 클릭 시 확인 대화상자 표시
- [ ] "확인" 시 API 호출하여 삭제
- [ ] 삭제 중 페이드 아웃 애니메이션
- [ ] 삭제 완료 시 카드 제거됨
- [ ] 마지막 카드 삭제 시 빈 상태로 전환
- [ ] "취소" 시 삭제 취소

### 새로고침
- [ ] "새로고침" 버튼 클릭 시 목록 다시 로드
- [ ] 로딩 중 상태 표시

## 5. API 엔드포인트 테스트

### generate_scenario.php
- [ ] POST 요청 정상 처리
- [ ] 필수 파라미터 검증 (userid, guideMode, vibeCodingPrompt, dbTrackingPrompt)
- [ ] GPT API 호출 성공 (API 키 설정 시)
- [ ] 에러 발생 시 JSON 에러 응답
- [ ] 에러 로그에 파일/라인 정보 포함

### save_scenario.php
- [ ] POST 요청 정상 처리
- [ ] 필수 파라미터 검증 (userid, guideMode, scenario)
- [ ] DB INSERT 성공
- [ ] scenarioId 반환
- [ ] 권한 검증 (타 사용자 시나리오 저장 불가)
- [ ] 에러 로그에 파일/라인 정보 포함

### list_scenarios.php
- [ ] GET 요청 정상 처리
- [ ] userid 파라미터 처리
- [ ] 최근 50개 시나리오 반환
- [ ] 생성일 기준 내림차순 정렬
- [ ] 권한 검증 (타 사용자 시나리오 조회 불가)
- [ ] 빈 배열 반환 정상 처리

### delete_scenario.php
- [ ] POST 요청 정상 처리
- [ ] scenarioId 검증
- [ ] 시나리오 존재 확인
- [ ] 권한 검증 (타 사용자 시나리오 삭제 불가)
- [ ] DB DELETE 성공
- [ ] 에러 로그에 파일/라인 정보 포함

## 6. 반응형 디자인 테스트

### 데스크톱 (>768px)
- [ ] 패널 너비 480px
- [ ] 오른쪽에서 슬라이드 인
- [ ] 모든 요소 정상 표시

### 태블릿 (≤768px)
- [ ] 패널 전체 화면 너비
- [ ] 슬라이드 인 애니메이션 유지
- [ ] 터치 인터랙션 정상 작동

### 모바일
- [ ] 모달이 화면에 맞게 조정됨
- [ ] 스크롤 정상 작동
- [ ] 버튼 터치 영역 충분

## 7. 브라우저 호환성

### Chrome
- [ ] 모든 기능 정상 작동
- [ ] CSS 렌더링 정상
- [ ] 애니메이션 부드러움

### Firefox
- [ ] 모든 기능 정상 작동
- [ ] CSS 렌더링 정상
- [ ] 애니메이션 부드러움

### Safari
- [ ] 모든 기능 정상 작동
- [ ] CSS 렌더링 정상
- [ ] 애니메이션 부드러움

### Edge
- [ ] 모든 기능 정상 작동
- [ ] CSS 렌더링 정상
- [ ] 애니메이션 부드러움

## 8. 성능 테스트

### 로딩 성능
- [ ] panel.js 로드 시간 < 500ms
- [ ] panel.css 로드 시간 < 200ms
- [ ] 패널 초기화 시간 < 100ms

### 렌더링 성능
- [ ] 패널 열기 애니메이션 60fps
- [ ] 모드 카드 렌더링 < 100ms
- [ ] 시나리오 목록 렌더링 (50개) < 500ms

### API 응답 시간
- [ ] generate_scenario.php < 30초 (GPT API)
- [ ] save_scenario.php < 1초
- [ ] list_scenarios.php < 1초
- [ ] delete_scenario.php < 1초

## 9. 보안 테스트

### 인증/권한
- [ ] 비로그인 사용자 API 접근 차단
- [ ] 타 사용자 시나리오 조회/수정/삭제 차단
- [ ] 관리자 권한 검증 (필요시)

### SQL Injection
- [ ] 모든 DB 쿼리에 prepared statement 사용
- [ ] 사용자 입력 파라미터 검증

### XSS
- [ ] 시나리오 텍스트 렌더링 시 HTML 이스케이프
- [ ] 모달 제목/내용 XSS 방지

## 10. 에러 핸들링

### 네트워크 에러
- [ ] API 타임아웃 시 에러 메시지
- [ ] 네트워크 오프라인 시 적절한 안내

### DB 에러
- [ ] 테이블 미생성 시 안내 메시지
- [ ] 연결 실패 시 재시도 안내

### 입력 에러
- [ ] 빈 입력 검증
- [ ] 잘못된 형식 입력 검증

## 11. 사용자 경험

### 피드백
- [ ] 모든 액션에 시각적 피드백
- [ ] 로딩 중 명확한 상태 표시
- [ ] 성공/실패 명확한 메시지

### 접근성
- [ ] 키보드 네비게이션 가능
- [ ] ESC 키로 패널/모달 닫기
- [ ] 버튼에 명확한 레이블

### 일관성
- [ ] UI 요소 스타일 일관성
- [ ] 색상 팔레트 일관성
- [ ] 애니메이션 속도 일관성

## 테스트 결과 기록

### 테스트 환경
- **브라우저**: ___________________
- **OS**: ___________________
- **화면 해상도**: ___________________
- **테스트 일시**: ___________________
- **테스터**: ___________________

### 발견된 이슈
1.
2.
3.

### 개선 사항
1.
2.
3.

### 최종 평가
- [ ] 모든 핵심 기능 정상 작동
- [ ] 주요 브라우저 호환성 확인
- [ ] 성능 기준 충족
- [ ] 보안 요구사항 충족
- [ ] 프로덕션 배포 준비 완료

---

**테스트 완료일**: ___________________
**승인자**: ___________________
**버전**: 1.0
