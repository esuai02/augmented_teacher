# Agent 16 - Interaction Preparation Strategy Step 2
# 세계관 선택 및 스토리 구조 설계

## 목적
Step 1에서 수집한 데이터를 기반으로 적절한 세계관을 선택하고, 학생이 몰입할 수 있는 스토리 구조를 설계한다.

---

## 1. 수학 학습 단계별 세계관 매핑

### 1.1 개념 학습 단계 → 세계관 매핑

**기본 매핑**:
- 탐구학습 모드 (기본값)
- 도제학습 모드 (질문 빈도 높을 때)

**매핑 로직**:
```
if student_question_frequency == high:
    select_worldview = "도제학습"
elif math_learning_style == "개념형":
    select_worldview = "탐구학습"
else:
    select_worldview = "도제학습"
```

**스토리 테마**:
- 탐구학습: "개념을 탐구하는 여정"
- 도제학습: "선생님과 함께하는 개념 이해"

**톤 설정**:
- 탐구학습: 호기심 유도형
- 도제학습: 안내형

**데이터 가정**: 선생님 체크리스트 입력
- "개념 학습 단계: 탐구학습 모드 권장"

---

### 1.2 유형 연습 단계 → 세계관 매핑

**기본 매핑**:
- 단기미션 모드 (동기 저하 시)
- 자기주도 모드 (동기 높을 때)

**매핑 로직**:
```
if student_motivation == low or student_level == "하위권":
    select_worldview = "단기미션"
elif student_level == "상위권":
    select_worldview = "자기주도"
else:
    select_worldview = "단기미션"
```

**스토리 테마**:
- 단기미션: "오늘 3개 유형 완료 목표"
- 자기주도: "자율적 연습의 시간"

**톤 설정**:
- 단기미션: 목표 지향형
- 자기주도: 자율 강조형

**데이터 가정**: 선생님 체크리스트 입력
- "유형 연습 단계: 단기미션 모드 권장"

---

### 1.3 심화 문제 단계 → 세계관 매핑

**기본 매핑**:
- 자기성찰 모드 (피로 낮을 때)
- 맞춤학습 모드 (피로 높을 때)

**매핑 로직**:
```
if student_fatigue == high or student_level == "하위권":
    select_worldview = "맞춤학습"
else:
    select_worldview = "자기성찰"
```

**스토리 테마**:
- 자기성찰: "틀려도 성장하는 시간"
- 맞춤학습: "나에게 맞는 난이도"

**톤 설정**:
- 자기성찰: 성장 강조형
- 맞춤학습: 격려 중심형

**데이터 가정**: 선생님 체크리스트 입력
- "심화 문제 단계: 자기성찰 모드 권장"

---

### 1.4 기출 문제 단계 → 세계관 매핑

**기본 매핑**:
- 시험대비 모드 (D-day ≤ 7일)
- 시간성찰 모드 (D-day > 7일 또는 시간 관리 이슈)

**매핑 로직**:
```
if exam_d_day <= 7:
    select_worldview = "시험대비"
elif time_management_issue == true:
    select_worldview = "시간성찰"
else:
    select_worldview = "시험대비"
```

**스토리 테마**:
- 시험대비: "D-__일, 마지막 스퍼트"
- 시간성찰: "시간과 함께 걷는 느낌"

**톤 설정**:
- 시험대비: 긴장 완화형
- 시간성찰: 시간 관리 강조형

**데이터 가정**: 선생님 체크리스트 입력
- "기출 문제: 시험대비 모드 (D-14일 이내)"

---

## 2. 학원 수업 맥락 기반 세계관 선택

### 2.1 학원 수업 전 상호작용 준비

**준비 유형별 매핑**:
- 예습 가이드 → 맞춤학습 모드
- 개념 리마인드 → 도제학습 모드
- 문제 선행 학습 → 단기미션 모드

**스토리 테마**: "학원 수업을 위한 준비"

**톤 설정**: 안내형

**데이터 가정**: 학생설문 입력
- "학원 수업 전 어떤 도움이 필요하신가요?"

---

### 2.2 학원 수업 후 상호작용 준비

**이해도별 매핑**:
- 완전 이해 → 자기주도 모드
- 부분 이해 → 도제학습 모드
- 이해 부족 → 자기성찰 모드

**스토리 테마**: "학원 수업 복습 및 정리"

**톤 설정**: 지원형

**데이터 가정**: 선생님 체크리스트 입력
- "학원 수업 후: 복습 상호작용 준비"

---

## 3. 문제 풀이 중 실시간 세계관 선택

### 3.1 막힘 감지 시 즉시 세계관 선택

**문제 유형별 매핑**:
- 개념 문제 막힘 → 도제학습 모드
- 계산 문제 막힘 → 단기미션 모드

**스토리 테마**: "막힘을 돌파하는 순간"

**톤 설정**: 지원형

**준비 사항**:
- 적절한 힌트 준비
- 단계별 안내 준비

**데이터 가정**: 선생님 체크리스트 입력
- "문제 풀이 중 막힘 감지 시간: __분 (기본값: 5분)"

---

### 3.2 계산 실수 패턴 감지 시

**세계관**: 자기성찰 모드

**스토리 테마**: "실수를 통해 개선하는 시간"

**톤 설정**: 격려 중심형

**준비 사항**:
- 계산 실수 유형별 주의 안내
- 반복 실수 방지 전략

**데이터 가정**: 선생님 텍스트 입력
- "계산 실수 패턴 감지 시: 주의 안내 상호작용 준비"

---

### 3.3 문제 풀이 진도 기반 준비

**세계관**: 시간성찰 모드

**스토리 테마**: "시간과 함께 걷는 느낌"

**톤 설정**: 시간 관리 강조형

**준비 사항**:
- 시간 관리 전략 안내
- 진도 조정 제안

**데이터 수집**: 자동 수집 (문제 풀이 로그)

---

## 4. 단원별 취약점 기반 세계관 선택

### 4.1 취약 단원 학습 시

**기본 세계관**: 도제학습 모드

**우선순위**: 높음

**스토리 테마**: "취약 단원 집중 지원"

**톤 설정**: 지원형

**준비 사항**:
- 단원별 특성 반영 지원
- 집중적인 개념 설명
- 단계별 문제 풀이 안내

**데이터 가정**: 학생설문 입력
- "어떤 단원에서 가장 도움이 필요하신가요?"

---

### 4.2 단원별 특성 반영 전략

**단원별 전략**:
- 함수 단원 → 그래프 이해 중심
- 도형 단원 → 작도 과정 중심
- 통계 단원 → 데이터 해석 중심
- 방정식 단원 → 단계별 풀이 과정 중심

**세계관 조정**:
- 그래프 이해 중심 → 탐구학습 모드 강화
- 작도 과정 중심 → 도제학습 모드 강화
- 데이터 해석 중심 → 탐구학습 모드 강화

**데이터 가정**: 선생님 텍스트 입력
- "함수 단원: 그래프 이해 중심 상호작용"

---

## 5. 학생 수준별 차별화

### 5.1 수준별 기본 세계관

**하위권**:
- 세계관: 자기성찰 모드
- 톤: 격려 중심
- 테마: "작은 성공의 의미"

**중위권**:
- 세계관: 단기미션 모드
- 톤: 도전 중심
- 테마: "목표 달성의 기쁨"

**상위권**:
- 세계관: 탐구학습 모드
- 톤: 심화 중심
- 테마: "창의적 사고의 즐거움"

**데이터 가정**: 선생님 체크리스트 입력
- "하위권: 격려 중심 → 자기성찰 모드"

---

### 5.2 학습 스타일 기반 조정

**계산형**:
- 조정: 단기미션 모드 강화
- 이유: 반복 연습 선호

**개념형**:
- 조정: 탐구학습 모드 강화
- 이유: 개념 탐색 선호

**응용형**:
- 조정: 자기주도 모드 강화
- 이유: 자율적 선택 선호

**충돌 처리**:
- 기존 세계관 선택이 있으면 유지하되 톤만 조정

---

## 6. 상호작용 연속성 유지

### 6.1 이전 상호작용 고려

**호환성 확인**:
- 이전 세계관과 현재 선택 세계관 호환성 검사
- 호환되면 이전 세계관 유지
- 호환 안 되면 자연스러운 전환

**캐릭터 일관성**:
- 멘토봇, 탐구조교, 루틴마스터 등 캐릭터 유지
- 캐릭터별 톤 일관성 유지

**감정 톤 유지**:
- 이전 상호작용의 감정 톤 보존
- 급격한 톤 변화 방지

---

### 6.2 개인화 깊이 강화

**효과성 추적**:
- 세계관별 상호작용 효과성 분석
- 학생별 선호 세계관 식별

**우선순위 조정**:
- 선호 세계관 우선 선택
- 효과성 데이터 기반 최적화

**데이터 수집**:
- 상호작용 후 학생 반응 기록
- 효과성 지표 수집 (학습 지속성, 정답률 향상 등)

---

## 7. 최종 출력 구조

### 7.1 선택된 세계관 및 스토리 구조
```yaml
selected_worldview: "탐구학습" | "도제학습" | "시험대비" | ...
narrative_theme: "개념을 탐구하는 여정"
tone: "호기심 유도형"
character: "탐구조교"
priority: "high" | "medium" | "low"
prepared_content:
  hints: [...]
  step_by_step_guide: [...]
  encouragement_messages: [...]
  time_management_tips: [...]
```

### 7.2 다음 에이전트로 전달
- Agent 17 (상호작용 콘텐츠 생성)로 구조화된 설계 정보 전달
- 세계관, 테마, 톤, 준비된 콘텐츠 전달

---

## 8. 우선순위 결정 로직

### 8.1 우선순위 기준
1. **긴급도**: 문제 풀이 중 막힘 > 학원 수업 전후 > 일반 학습
2. **취약도**: 취약 단원 > 보통 단원
3. **학생 수준**: 하위권 > 중위권 > 상위권
4. **학습 단계**: 기출 > 심화 > 유형연습 > 개념학습

### 8.2 충돌 해결
- 여러 조건이 충돌할 때 우선순위 기준 적용
- 긴급도가 가장 높은 조건 우선
- 학생 수준이 낮을수록 우선순위 높음

---

**참고**: 이 단계는 학생이 몰입할 수 있는 상호작용을 준비하는 핵심 단계입니다. 세계관 선택의 적절성이 상호작용 효과성을 결정합니다.

