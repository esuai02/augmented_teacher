# Agent16 페르소나 시스템 개요

## 1. 소개

Agent16(상호작용 준비 에이전트)의 페르소나 시스템은 학습자의 메시지를 분석하여
적절한 세계관과 페르소나를 선택하고, 맞춤형 응답을 생성하는 시스템입니다.

**버전**: 1.0.0
**최종 수정**: 2025-06-02

---

## 2. 시스템 구조

```
persona_system/
├── api/                    # REST API 엔드포인트
│   └── chat.php           # 채팅 API (GET/POST)
│
├── engine/                 # 핵심 엔진
│   └── Agent16PersonaEngine.php  # Agent16 전용 엔진
│
├── personas/               # 페르소나 정의
│   ├── personas.md        # 페르소나 상세 문서
│   └── ontology.jsonld    # 시맨틱 온톨로지
│
├── docs/                   # 문서 (현재 폴더)
│   ├── 00_시스템_개요.md
│   ├── 01_페르소나_정의_가이드.md
│   ├── 02_세계관_설정_가이드.md
│   ├── 03_API_사용_가이드.md
│   ├── 04_엔진_확장_가이드.md
│   ├── 05_규칙_작성_가이드.md
│   ├── 06_DB_스키마_가이드.md
│   └── 07_통합_배포_가이드.md
│
└── (rules/rules.yaml)     # 상위 폴더 - 규칙 파일
```

---

## 3. 핵심 개념

### 3.1 세계관 (Worldview)

학습 상황을 분류하는 9가지 프레임워크입니다:

| ID | 한글명 | 설명 | 우선순위 |
|----|--------|------|----------|
| curriculum | 커리큘럼 | 정규 교육과정 기반 | 1 |
| personalized | 맞춤학습 | 개인화된 학습 경험 | 2 |
| exam_prep | 시험대비 | 시험 준비 집중 모드 | 3 |
| short_mission | 단기미션 | 단기 목표 달성 중심 | 4 |
| self_reflection | 자기성찰 | 메타인지 및 자기 분석 | 5 |
| self_directed | 자기주도 | 학습자 주도적 학습 | 6 |
| apprenticeship | 도제학습 | 멘토-학습자 관계 | 7 |
| time_reflection | 시간성찰 | 시간 관리 및 회고 | 8 |
| inquiry | 탐구학습 | 탐구 기반 학습 | 9 |

### 3.2 페르소나 (Persona)

세계관에 따라 활성화되는 9가지 AI 인격입니다:

| 페르소나 ID | 이름 | 세계관 | 톤 |
|-------------|------|--------|-----|
| A16_P1 | 체계적 가이드 | 커리큘럼 | Professional |
| A16_P2 | 맞춤 코치 | 맞춤학습 | Supportive |
| A16_P3 | 시험 전략가 | 시험대비 | Analytical |
| A16_P4 | 미션 매니저 | 단기미션 | Motivational |
| A16_P5 | 성찰 촉진자 | 자기성찰 | Reflective |
| A16_P6 | 자율 지원자 | 자기주도 | Empowering |
| A16_P7 | 멘토 | 도제학습 | Mentoring |
| A16_P8 | 시간 관리자 | 시간성찰 | Practical |
| A16_P9 | 탐구 안내자 | 탐구학습 | Curious |

### 3.3 상황 그룹 (Situation Group)

학습 맥락을 분류하는 7가지 상황입니다:

| 상황 | 설명 | 기본 페르소나 |
|------|------|---------------|
| S0 | 상태 감지 | A16_P2 |
| S1 | 세계관 매핑 | 세계관별 |
| S2 | 학원 맥락 | A16_P1 |
| S3 | 실시간 상호작용 | A16_P4 |
| S4 | 취약점 기반 준비 | A16_P3 |
| S5 | 수준 차별화 | A16_P2 |
| S6 | 연속성 | 이전 유지 |

---

## 4. 데이터 흐름

```
[사용자 메시지]
       │
       ▼
┌─────────────────┐
│  API (chat.php) │  ← HTTP POST 요청
└────────┬────────┘
         │
         ▼
┌─────────────────────────────┐
│  Agent16PersonaEngine       │
│  ├─ detectWorldview()       │  ← 세계관 감지
│  ├─ detectSituationGroup()  │  ← 상황 그룹 판단
│  ├─ selectPersonaByWorldview() │ ← 페르소나 선택
│  └─ generateResponse()      │  ← 응답 생성
└────────┬────────────────────┘
         │
         ▼
┌─────────────────┐
│  AgentStateSync │  ← 상태 저장 (DB)
└────────┬────────┘
         │
         ▼
[JSON 응답]
```

---

## 5. 기술 스택

- **언어**: PHP 7.1.9
- **데이터베이스**: MySQL 5.7
- **플랫폼**: Moodle 3.7
- **온톨로지**: JSON-LD (W3C 표준)
- **API**: RESTful JSON

---

## 6. 의존성

### 6.1 공통 라이브러리 (ontology_engineering/persona_engine/)

```php
// 필수 의존성
require_once('core/PersonaEngineInterface.php');
require_once('core/AbstractPersonaEngine.php');
require_once('communication/AgentStateSync.php');
```

### 6.2 Moodle 연동

```php
include_once("/home/moodle/public_html/moodle/config.php");
global $DB, $USER;
require_login();
```

---

## 7. 빠른 시작

### 7.1 API 호출 예시

```bash
# 채팅 요청
curl -X POST \
  'https://mathking.kr/moodle/local/augmented_teacher/alt42/orchestration/agents/agent16_interaction_preparation/persona_system/api/chat.php' \
  -H 'Content-Type: application/json' \
  -d '{"message": "시험이 다가오는데 어떻게 준비할까요?"}'
```

### 7.2 응답 예시

```json
{
  "success": true,
  "agent_id": "agent16",
  "persona": {
    "id": "A16_P3",
    "name": "시험 전략가",
    "tone": "Analytical",
    "confidence": 0.85
  },
  "response": {
    "text": "시험 준비 전략을 함께 세워볼게요...",
    "suggestions": ["출제 빈도 분석", "취약점 점검"]
  },
  "analysis": {
    "detected_worldview": "exam_prep",
    "worldview_confidence": 0.85
  }
}
```

---

## 8. 관련 문서

| 문서 | 설명 |
|------|------|
| [01_페르소나_정의_가이드.md](./01_페르소나_정의_가이드.md) | 페르소나 추가/수정 방법 |
| [02_세계관_설정_가이드.md](./02_세계관_설정_가이드.md) | 세계관 트리거 설정 |
| [03_API_사용_가이드.md](./03_API_사용_가이드.md) | API 상세 문서 |
| [04_엔진_확장_가이드.md](./04_엔진_확장_가이드.md) | 엔진 커스터마이징 |
| [05_규칙_작성_가이드.md](./05_규칙_작성_가이드.md) | rules.yaml 작성법 |
| [06_DB_스키마_가이드.md](./06_DB_스키마_가이드.md) | 데이터베이스 구조 |
| [07_통합_배포_가이드.md](./07_통합_배포_가이드.md) | 배포 및 통합 절차 |

---

## 9. 지원 및 문의

- **프로젝트**: Augmented Teacher (ALT42)
- **담당**: ALT42 Orchestration Team
- **서버 URL**: https://mathking.kr/moodle/local/augmented_teacher/alt42/orchestration/

---

*이 문서는 Agent16 페르소나 시스템의 전체적인 개요를 제공합니다.*
*상세한 구현 방법은 각 개별 가이드를 참조하세요.*
