<?php
/**
 * Agent09 Intervention Message Templates
 *
 * ê°œì… ìœ í˜• ë° ë ˆë²¨ë³„ ë©”ì‹œì§€ í…œí”Œë¦¿ ì •ì˜
 * URL: https://mathking.kr/moodle/local/augmented_teacher/alt42/orchestration/agents/agent09_learning_management/persona_system/templates/message_templates.php
 *
 * @package AugmentedTeacher\Agent09\PersonaSystem\Templates
 * @version 1.0
 */

/**
 * ê°œì… ë ˆë²¨ ì •ì˜
 */
$interventionLevels = [
    'notice' => [
        'code' => 'ì£¼ì˜',
        'priority' => 1,
        'color' => '#FFA500',  // Orange
        'icon' => 'âš ï¸',
        'description' => 'ê´€ì‹¬ ëª¨ë‹ˆí„°ë§ í•„ìš”',
        'auto_follow_up_days' => 7,
        'escalation_threshold' => 14  // 14ì¼ ë‚´ ê°œì„  ì—†ìœ¼ë©´ ê²½ê³ ë¡œ
    ],
    'warning' => [
        'code' => 'ê²½ê³ ',
        'priority' => 2,
        'color' => '#FF6B6B',  // Red-Orange
        'icon' => 'ğŸ””',
        'description' => 'ì ê·¹ì  ê°œì… í•„ìš”',
        'auto_follow_up_days' => 3,
        'escalation_threshold' => 7
    ],
    'critical' => [
        'code' => 'ê¸´ê¸‰',
        'priority' => 3,
        'color' => '#DC3545',  // Red
        'icon' => 'ğŸš¨',
        'description' => 'ì¦‰ê° ì¡°ì¹˜ í•„ìš”',
        'auto_follow_up_days' => 1,
        'escalation_threshold' => 3,
        'notify_teacher' => true
    ]
];

/**
 * ê°œì… ìœ í˜• ì •ì˜
 */
$interventionTypes = [
    'encouragement' => [
        'name' => 'ê²©ë ¤',
        'description' => 'ë™ê¸°ë¶€ì—¬ ë° ê¸ì •ì  í”¼ë“œë°±',
        'suitable_for' => ['low_motivation', 'irregular_attendance', 'goal_struggling']
    ],
    'reminder' => [
        'name' => 'ë¦¬ë§ˆì¸ë”',
        'description' => 'í•™ìŠµ í™œë™ ìƒê¸°',
        'suitable_for' => ['missed_session', 'pending_review', 'upcoming_test']
    ],
    'guidance' => [
        'name' => 'ê°€ì´ë“œ',
        'description' => 'í•™ìŠµ ë°©ë²• ì•ˆë‚´',
        'suitable_for' => ['study_method', 'time_management', 'goal_setting']
    ],
    'alert' => [
        'name' => 'ê²½ê³  ì•Œë¦¼',
        'description' => 'ìœ„í—˜ ìƒí™© ì•Œë¦¼',
        'suitable_for' => ['dropout_risk', 'declining_performance', 'burnout_signs']
    ],
    'celebration' => [
        'name' => 'ì¶•í•˜',
        'description' => 'ì„±ì·¨ ì¶•í•˜ ë° ì¸ì •',
        'suitable_for' => ['goal_achieved', 'streak_milestone', 'score_improvement']
    ],
    'check_in' => [
        'name' => 'ì•ˆë¶€ í™•ì¸',
        'description' => 'ìƒíƒœ í™•ì¸ ë° ê´€ì‹¬ í‘œí˜„',
        'suitable_for' => ['long_absence', 'recent_struggle', 'emotional_concern']
    ]
];

/**
 * ì§€í‘œë³„ ê°œì… ë©”ì‹œì§€ í…œí”Œë¦¿
 */
$indicatorMessages = [

    // ===================================================
    // ì¶œê²° (Attendance) ê´€ë ¨ ë©”ì‹œì§€
    // ===================================================
    'attendance' => [
        'notice' => [
            'encouragement' => [
                '{name}ë‹˜, ìš”ì¦˜ ì¶œì„ì´ ì¡°ê¸ˆ ë¶ˆê·œì¹™í•´ì¡Œì–´ìš”. ë‹¤ì‹œ ë£¨í‹´ì„ ì¡ì•„ë³¼ê¹Œìš”?',
                'ì¶œì„ íŒ¨í„´ì´ ë³€í–ˆë„¤ìš”. ë­”ê°€ ì–´ë ¤ìš´ ì¼ì´ ìˆìœ¼ì‹ ê°€ìš”?',
                '{name}ë‹˜ì˜ ê·œì¹™ì ì¸ ëª¨ìŠµì´ ê·¸ë¦¬ì›Œìš”. ë‹¤ì‹œ ë§Œë‚˜ìš”!'
            ],
            'reminder' => [
                'ì˜¤ëŠ˜ í•™ìŠµ ì‹œê°„ì´ì—ìš”! í•¨ê»˜ ì‹œì‘í•´ë³¼ê¹Œìš”?',
                'ì–´ì œ ëª» ì˜¤ì…¨ë„¤ìš”. ì˜¤ëŠ˜ì€ ê¼­ ë§Œë‚˜ìš”!',
                '{name}ë‹˜, ì˜¤ëŠ˜ ì¶œì„ ì²´í¬ ìŠì§€ ë§ˆì„¸ìš”!'
            ]
        ],
        'warning' => [
            'encouragement' => [
                '{name}ë‹˜, ì¶œì„ì´ ë§ì´ ì¤„ì—ˆì–´ìš”. ë¬´ìŠ¨ ì¼ ìˆìœ¼ì„¸ìš”? ì–˜ê¸°í•´ì£¼ì„¸ìš”.',
                'ìš”ì¦˜ ë§ì´ ëª» ëµ€ì–´ìš”. ê±±ì •ë¼ìš”. ì ê¹ì´ë¼ë„ ì™€ì£¼ì‹¤ ìˆ˜ ìˆì–´ìš”?',
                'ì–´ë–¤ ì–´ë ¤ì›€ì´ë“  í•¨ê»˜ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”. ë‹¤ì‹œ ì‹œì‘í•´ë´ìš”.'
            ],
            'check_in' => [
                '{name}ë‹˜, ìš”ì¦˜ ì–´ë–»ê²Œ ì§€ë‚´ì„¸ìš”? í˜ë“  ì¼ ìˆìœ¼ë©´ ì–˜ê¸°í•´ì£¼ì„¸ìš”.',
                'ì¶œì„ì´ ëœ¸í•´ì„œ ê±±ì •ì´ì—ìš”. ê´œì°®ìœ¼ì„¸ìš”?',
                'ë¬´ì—‡ì´ í•™ìŠµì„ ì–´ë µê²Œ í•˜ê³  ìˆë‚˜ìš”? ê°™ì´ ë°©ë²•ì„ ì°¾ì•„ë´ìš”.'
            ]
        ],
        'critical' => [
            'alert' => [
                'âš ï¸ {name}ë‹˜, ì¥ê¸° ê²°ì„ ìƒíƒœì…ë‹ˆë‹¤. ì—°ë½ ë¶€íƒë“œë ¤ìš”.',
                'ğŸš¨ ì¶œì„ë¥ ì´ ë§¤ìš° ë‚®ì•„ìš”. ë‹´ì„ì„ ìƒë‹˜ê»˜ë„ ì•Œë ¤ë“œë¦´ê²Œìš”.',
                'í•™ìŠµ ì§€ì†ì´ ì–´ë ¤ìš´ ìƒí™©ì¸ ê²ƒ ê°™ì•„ìš”. ê¼­ ì—°ë½ì£¼ì„¸ìš”.'
            ],
            'check_in' => [
                '{name}ë‹˜, ì˜¤ëœë§Œì´ì—ìš”. ë¬´ìŠ¨ ì¼ ìˆìœ¼ì…¨ë‚˜ìš”?',
                'ì—°ë½ì´ ì•ˆ ë¼ì„œ ë§ì´ ê±±ì •í–ˆì–´ìš”. ìƒí™© ì•Œë ¤ì£¼ì‹¤ ìˆ˜ ìˆì–´ìš”?',
                'ì–´ë–¤ ë„ì›€ì´ í•„ìš”í•˜ì„¸ìš”? í•¨ê»˜ ë°©ë²•ì„ ì°¾ì•„ë´ìš”.'
            ]
        ]
    ],

    // ===================================================
    // ëª©í‘œ (Goal) ê´€ë ¨ ë©”ì‹œì§€
    // ===================================================
    'goal' => [
        'notice' => [
            'guidance' => [
                'ëª©í‘œ ë‹¬ì„±ë¥ ì´ ì¡°ê¸ˆ ë‚®ì•„ìš”. ëª©í‘œë¥¼ ì¢€ ë” í˜„ì‹¤ì ìœ¼ë¡œ ì¡°ì •í•´ë³¼ê¹Œìš”?',
                'í° ëª©í‘œë¥¼ ì‘ì€ ë‹¨ê³„ë¡œ ë‚˜ëˆ ë³´ë©´ ì–´ë–¨ê¹Œìš”?',
                'ëª©í‘œ ì„¤ì • ë°©ë²•ì„ í•¨ê»˜ ë‹¤ì‹œ ì ê²€í•´ë´ìš”.'
            ],
            'encouragement' => [
                'ëª©í‘œê°€ ì¢€ ì–´ë ¤ì› ë‚˜ìš”? ì¡°ì •í•´ë„ ê´œì°®ì•„ìš”.',
                'ì™„ë²½í•˜ì§€ ì•Šì•„ë„ ë¼ìš”. ì‹œë„í•œ ê²ƒ ìì²´ê°€ ëŒ€ë‹¨í•´ìš”.',
                'ì‘ì€ ëª©í‘œë¶€í„° ë‹¬ì„±í•´ê°€ë©´ ìì‹ ê°ì´ ìƒê¸¸ ê±°ì˜ˆìš”.'
            ]
        ],
        'warning' => [
            'guidance' => [
                'ëª©í‘œ ë‹¬ì„±ì— ì–´ë ¤ì›€ì´ ìˆë„¤ìš”. í•¨ê»˜ ì „ëµì„ ë‹¤ì‹œ ì„¸ì›Œë³¼ê¹Œìš”?',
                'ë¬´ì—‡ì´ ëª©í‘œ ë‹¬ì„±ì„ ë°©í•´í•˜ê³  ìˆëŠ”ì§€ ë¶„ì„í•´ë´ìš”.',
                'ëª©í‘œ ìì²´ë³´ë‹¤ ê³¼ì •ì— ì§‘ì¤‘í•´ë³¼ê¹Œìš”?'
            ],
            'check_in' => [
                'ëª©í‘œê°€ ë¶€ë‹´ë˜ì‹œë‚˜ìš”? ì¡°ì •í•´ë“œë¦´ê¹Œìš”?',
                'ì–´ë–¤ ë¶€ë¶„ì´ ê°€ì¥ ì–´ë ¤ìš°ì„¸ìš”?',
                'í•¨ê»˜ í˜„ì‹¤ì ì¸ ëª©í‘œë¥¼ ë‹¤ì‹œ ì„¸ì›Œë´ìš”.'
            ]
        ],
        'critical' => [
            'alert' => [
                'ëª©í‘œ ë‹¬ì„±ë¥ ì´ ë§¤ìš° ë‚®ì•„ìš”. í•™ìŠµ ë°©í–¥ ì¬ì„¤ì •ì´ í•„ìš”í•´ ë³´ì—¬ìš”.',
                'í˜„ì¬ ëª©í‘œ ì‹œìŠ¤í…œì´ ë§ì§€ ì•ŠëŠ” ê²ƒ ê°™ì•„ìš”. ì™„ì „íˆ ìƒˆë¡œ ì‹œì‘í•´ë³¼ê¹Œìš”?',
                'ë‹´ì„ì„ ìƒë‹˜ê³¼ í•¨ê»˜ í•™ìŠµ ê³„íšì„ ë‹¤ì‹œ ì„¸ì›Œë³´ë©´ ì¢‹ê² ì–´ìš”.'
            ]
        ],
        'celebration' => [
            '{name}ë‹˜! ì´ë²ˆ ì£¼ ëª©í‘œ ì „ë¶€ ë‹¬ì„±! ğŸ‰ ì •ë§ ëŒ€ë‹¨í•´ìš”!',
            'ëª©í‘œ ë‹¬ì„±ë¥  {progress}%! ìµœê³ ì˜ˆìš”! ğŸ‘',
            'ê¾¸ì¤€íˆ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê³  ê³„ì‹œë„¤ìš”! ì´ ì¡°ìë¥¼ ìœ ì§€í•´ë´ìš”! â­'
        ]
    ],

    // ===================================================
    // í¬ëª¨ë„ë¡œ (Pomodoro) ê´€ë ¨ ë©”ì‹œì§€
    // ===================================================
    'pomodoro' => [
        'notice' => [
            'reminder' => [
                'í¬ëª¨ë„ë¡œ ì„¸ì…˜ì´ ì¤„ì—ˆì–´ìš”. ë‹¤ì‹œ ì§‘ì¤‘ ëª¨ë“œ ì‹œì‘í•´ë³¼ê¹Œìš”?',
                'ì˜¤ëŠ˜ ì•„ì§ í¬ëª¨ë„ë¡œ ì•ˆ í•˜ì…¨ë„¤ìš”. í•œ ì„¸ì…˜ í•´ë³¼ê¹Œìš”?',
                'ì§‘ì¤‘ í•™ìŠµì˜ í˜ì„ ê¸°ì–µí•˜ì„¸ìš”! í¬ëª¨ë„ë¡œ ì‹œì‘!'
            ],
            'guidance' => [
                'í¬ëª¨ë„ë¡œê°€ ì–´ë ¤ìš°ì‹œë©´ 15ë¶„ ì§§ì€ ì„¸ì…˜ë¶€í„° ì‹œì‘í•´ë´ìš”.',
                'ì§‘ì¤‘ì´ ì•ˆ ë  ë•ŒëŠ” í™˜ê²½ì„ ë°”ê¿”ë³´ëŠ” ê²ƒë„ ë°©ë²•ì´ì—ìš”.',
                'í¬ëª¨ë„ë¡œ ê¸°ë²• ë‹¤ì‹œ ì„¤ëª…í•´ë“œë¦´ê¹Œìš”?'
            ]
        ],
        'warning' => [
            'encouragement' => [
                'í¬ëª¨ë„ë¡œ ì‚¬ìš©ì´ ë§ì´ ì¤„ì—ˆì–´ìš”. ì§‘ì¤‘í•˜ê¸° ì–´ë ¤ìš´ ìƒí™©ì¸ê°€ìš”?',
                'ì§‘ì¤‘ í•™ìŠµì´ í˜ë“¤ ë•Œë„ ìˆì–´ìš”. ì²œì²œíˆ ë‹¤ì‹œ ì‹œì‘í•´ë´ìš”.',
                '5ë¶„ ë¯¸ë‹ˆ ì„¸ì…˜ë¶€í„° ë‹¤ì‹œ ì‹œì‘í•´ë³¼ê¹Œìš”?'
            ]
        ],
        'celebration' => [
            'í¬ëª¨ë„ë¡œ {streak}ì¼ ì—°ì† ì‚¬ìš©! ì§‘ì¤‘ë ¥ ë§ˆìŠ¤í„°! ğŸ…',
            'ì˜¤ëŠ˜ {score}ì„¸ì…˜ ì™„ë£Œ! ëŒ€ë‹¨í•œ ì§‘ì¤‘ë ¥ì´ì—ìš”! ğŸ’ª',
            'í¬ëª¨ë„ë¡œ ì™„ë£Œìœ¨ {progress}%! íš¨ìœ¨ì ì¸ í•™ìŠµ ì¤‘! âš¡'
        ]
    ],

    // ===================================================
    // ì˜¤ë‹µë…¸íŠ¸ (Wrong Note) ê´€ë ¨ ë©”ì‹œì§€
    // ===================================================
    'wrong_note' => [
        'notice' => [
            'reminder' => [
                'ë³µìŠµí•  ì˜¤ë‹µì´ {count}ê°œ ìŒ“ì˜€ì–´ìš”. ì˜¤ëŠ˜ ëª‡ ê°œ ì •ë¦¬í•´ë³¼ê¹Œìš”?',
                'ì˜¤ë‹µë…¸íŠ¸ ë³µìŠµ ì£¼ê¸°ê°€ ëì–´ìš”. ìŠê¸° ì „ì— ë‹¤ì‹œ ë´ìš”!',
                'ì¼ì£¼ì¼ ì „ ì˜¤ë‹µ, ê¸°ì–µë‚˜ì„¸ìš”? ë‹¤ì‹œ í’€ì–´ë´ìš”.'
            ],
            'guidance' => [
                'ì˜¤ë‹µì„ íš¨ê³¼ì ìœ¼ë¡œ ë³µìŠµí•˜ëŠ” ë°©ë²• ì•Œë ¤ë“œë¦´ê¹Œìš”?',
                'ì˜¤ë‹µë…¸íŠ¸ ì •ë¦¬ê°€ ë°€ë ¸ë„¤ìš”. ë§¤ì¼ 3ê°œì”© í•´ë³´ë©´ ì–´ë–¨ê¹Œìš”?',
                'ì˜¤ë‹µ ë³µìŠµì´ ì‹¤ë ¥ í–¥ìƒì˜ í•µì‹¬ì´ì—ìš”!'
            ]
        ],
        'warning' => [
            'encouragement' => [
                'ì˜¤ë‹µì´ ë§ì´ ìŒ“ì˜€ì–´ìš”. ë¶€ë‹´ ê°–ì§€ ë§ê³  ì¡°ê¸ˆì”© í•´ê²°í•´ë´ìš”.',
                'ë°€ë¦° ë³µìŠµ, í•˜ë‚˜ì”© í•´ê²°í•  ìˆ˜ ìˆì–´ìš”.',
                'ì˜¤ë‹µì„ ë°©ì¹˜í•˜ë©´ ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë°˜ë³µí•´ìš”. ì§€ê¸ˆ ì‹œì‘í•´ë´ìš”.'
            ]
        ],
        'celebration' => [
            'ì˜¤ë‹µ {count}ê°œ ì™„ë²½ ë³µìŠµ! ì´í•´ë„ê°€ ë†’ì•„ì§€ê³  ìˆì–´ìš”! ğŸ“š',
            'ë³µìŠµë¥  {progress}%! ê¼¼ê¼¼í•¨ì´ ë¹›ë‚˜ìš”! âœ¨',
            'ì˜¤ë‹µ ë§ˆìŠ¤í„°ë¦¬ ë‹¬ì„±! ë‹¤ìŒì—” ë” ì‰¬ìš¸ ê±°ì˜ˆìš”! ğŸ¯'
        ]
    ],

    // ===================================================
    // ì‹œí—˜ (Test) ê´€ë ¨ ë©”ì‹œì§€
    // ===================================================
    'test' => [
        'notice' => [
            'guidance' => [
                'ì„±ì ì´ ì¡°ê¸ˆ ì •ì²´ë˜ì–´ ìˆì–´ìš”. í•™ìŠµ ë°©ë²• ì ê²€ì´ í•„ìš”í•´ ë³´ì—¬ìš”.',
                'ì•½ì  ê³¼ëª© ë¶„ì„í•´ë³¼ê¹Œìš”? ì§‘ì¤‘ ê³µëµí•˜ë©´ ì˜¬ë¦´ ìˆ˜ ìˆì–´ìš”.',
                'ì‹œí—˜ ëŒ€ë¹„ ì „ëµì„ ìƒˆë¡œ ì„¸ì›Œë³¼ê¹Œìš”?'
            ],
            'encouragement' => [
                'ì„±ì ì´ ì ì‹œ ì£¼ì¶¤í•´ë„ ê´œì°®ì•„ìš”. ë‹¤ì‹œ ì˜¬ë¦´ ìˆ˜ ìˆì–´ìš”.',
                'ì •ì²´ê¸°ëŠ” ë„ì•½ ì „ ë‹¨ê³„ì˜ˆìš”. í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”.',
                'ê¾¸ì¤€íˆ í•˜ë©´ ë°˜ë“œì‹œ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚˜ìš”.'
            ]
        ],
        'warning' => [
            'alert' => [
                'ì„±ì  í•˜ë½ì´ ê³„ì†ë˜ê³  ìˆì–´ìš”. ì›ì¸ ë¶„ì„ì´ í•„ìš”í•´ìš”.',
                'í•™ìŠµ ë°©ë²•ì´ë‚˜ í™˜ê²½ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆì–´ìš”. í•¨ê»˜ ì ê²€í•´ë´ìš”.',
                'ì–´ë–¤ ë¶€ë¶„ì´ ê°€ì¥ ì–´ë ¤ìš°ì„¸ìš”? ì§‘ì¤‘ ì§€ì›í• ê²Œìš”.'
            ],
            'check_in' => [
                'ì‹œí—˜ ê²°ê³¼ê°€ ê¸°ëŒ€ì— ëª» ë¯¸ì³¤ë‚˜ìš”? ê´œì°®ì•„ìš”, ë‹¤ìŒì´ ìˆì–´ìš”.',
                'ì–´ë–¤ ë¶€ë¶„ì—ì„œ ì‹¤ìˆ˜ê°€ ë§ì•˜ì–´ìš”? ë¶„ì„í•´ë³¼ê¹Œìš”?',
                'ì„±ì ë³´ë‹¤ ê³¼ì •ì´ ì¤‘ìš”í•´ìš”. í•¨ê»˜ ê°œì„ ì  ì°¾ì•„ë´ìš”.'
            ]
        ],
        'critical' => [
            'alert' => [
                'ì„±ì ì´ ë§ì´ ë–¨ì–´ì¡Œì–´ìš”. ê¸´ê¸‰ í•™ìŠµ ì „ëµ íšŒì˜ê°€ í•„ìš”í•´ìš”.',
                'ë‹´ì„ì„ ìƒë‹˜ê³¼ í•¨ê»˜ í•™ìŠµ ê³„íšì„ ì¬ìˆ˜ë¦½í•´ì•¼ í•  ê²ƒ ê°™ì•„ìš”.',
                'ì§€ê¸ˆ ìƒí™©, í•¨ê»˜ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”. ë¨¼ì € ì›ì¸ì„ íŒŒì•…í•´ë´ìš”.'
            ]
        ],
        'celebration' => [
            'ì„±ì  {improvement}ì  ìƒìŠ¹! ë…¸ë ¥ì˜ ê²°ì‹¤ì´ì—ìš”! ğŸ“ˆ',
            'ìƒìœ„ {score}% ë‹¬ì„±! ì •ë§ ëŒ€ë‹¨í•´ìš”! ğŸ†',
            'ìê¸° ìµœê³  ê¸°ë¡ ê²½ì‹ ! ê³„ì† ì´ í˜ì´ìŠ¤ë¡œ! ğŸŒŸ'
        ]
    ],

    // ===================================================
    // ì¢…í•© (Composite) ê´€ë ¨ ë©”ì‹œì§€
    // ===================================================
    'composite' => [
        'notice' => [
            'check_in' => [
                '{name}ë‹˜, ìµœê·¼ ì „ë°˜ì ì¸ í•™ìŠµ í™œë™ì´ ì¤„ì—ˆì–´ìš”. ì–´ë– ì„¸ìš”?',
                'ì—¬ëŸ¬ ì§€í‘œê°€ í•¨ê»˜ ë–¨ì–´ì§€ê³  ìˆì–´ìš”. ë¬´ìŠ¨ ì¼ ìˆìœ¼ì„¸ìš”?',
                'í•™ìŠµ ì „ë°˜ì— ì–´ë ¤ì›€ì´ ìˆì–´ ë³´ì—¬ìš”. ì–˜ê¸°í•´ì£¼ì‹¤ ìˆ˜ ìˆì–´ìš”?'
            ]
        ],
        'warning' => [
            'alert' => [
                'ì—¬ëŸ¬ í•™ìŠµ ì§€í‘œê°€ ë™ì‹œì— í•˜ë½í•˜ê³  ìˆì–´ìš”. ê´€ì‹¬ì´ í•„ìš”í•´ìš”.',
                'ì¢…í•©ì ì¸ í•™ìŠµ ì ê²€ì´ í•„ìš”í•´ ë³´ì—¬ìš”. í•¨ê»˜ ë¶„ì„í•´ë³¼ê¹Œìš”?',
                'í•™ìŠµ ì „ë°˜ì— ì–´ë ¤ì›€ì´ ìˆëŠ” ê²ƒ ê°™ì•„ìš”. ì§€ì›í•´ë“œë¦´ê²Œìš”.'
            ]
        ],
        'critical' => [
            'alert' => [
                'ğŸš¨ {name}ë‹˜, ëª¨ë“  í•™ìŠµ ì§€í‘œê°€ ìœ„í—˜ ìˆ˜ì¤€ì´ì—ìš”. ê¸´ê¸‰ ì§€ì›ì´ í•„ìš”í•´ìš”.',
                'ë‹´ì„ì„ ìƒë‹˜ê³¼ ìƒë‹´ì„ ê¶Œê³ ë“œë ¤ìš”. í•¨ê»˜ ë°©ë²•ì„ ì°¾ì•„ë´ìš”.',
                'ì§€ê¸ˆ ìƒí™©ì´ ì–´ë µë‹¤ëŠ” ê±¸ ì•Œì•„ìš”. í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”, ë„ìš¸ê²Œìš”.'
            ]
        ],
        'celebration' => [
            'ëª¨ë“  ì§€í‘œê°€ ìƒìŠ¹ ì¤‘! ê· í˜• ì¡íŒ ì„±ì¥ì´ì—ìš”! ğŸŒˆ',
            'ì¢…í•© í•™ìŠµ ì ìˆ˜ ì—­ëŒ€ ìµœê³ ! ì •ë§ ì˜í•˜ê³  ìˆì–´ìš”! ğŸŠ',
            'ì „ë°©ìœ„ì ìœ¼ë¡œ ì„±ì¥ ì¤‘! ì´ëŒ€ë¡œë§Œ ê°€ë´ìš”! ğŸ’«'
        ]
    ]
];

/**
 * ì´íƒˆ ìœ„í—˜ ê´€ë ¨ íŠ¹ë³„ ë©”ì‹œì§€
 */
$dropoutMessages = [
    'notice' => [
        'ìµœê·¼ í™œë™ì´ ì¤„ì—ˆì–´ìš”. í•™ìŠµ ì§€ì†ì— ì–´ë ¤ì›€ì´ ìˆìœ¼ì‹ ê°€ìš”?',
        'ë©°ì¹ ê°„ í™œë™ì´ ì—†ë„¤ìš”. ê´œì°®ìœ¼ì„¸ìš”?',
        'ì¡°ê¸ˆì”©ì´ë¼ë„ ê³„ì†í•˜ëŠ” ê²Œ ì¤‘ìš”í•´ìš”. ë‹¤ì‹œ ì‹œì‘í•´ë´ìš”.'
    ],
    'warning' => [
        'í•™ìŠµ ì´íƒˆ ìœ„í—˜ ì‹ í˜¸ê°€ ê°ì§€ëì–´ìš”. ë¬´ìŠ¨ ì¼ì´ì‹ ì§€ ì–˜ê¸°í•´ì£¼ì„¸ìš”.',
        'í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”. ì–´ë–¤ ì–´ë ¤ì›€ì´ë“  í•¨ê»˜ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”.',
        'ì§€ê¸ˆ ìƒí™©ì´ í˜ë“¤ë‹¤ëŠ” ê±¸ ì•Œì•„ìš”. ì ì‹œ ì‰¬ì–´ê°€ë„ ë¼ìš”.'
    ],
    'critical' => [
        'ğŸš¨ {name}ë‹˜, ì´íƒˆ ìœ„í—˜ ìƒíƒœì…ë‹ˆë‹¤. ë‹´ì„ì„ ìƒë‹˜ê»˜ ì•Œë ¤ë“œë¦´ê²Œìš”.',
        'ì§€ê¸ˆ í•™ìŠµ ì§€ì†ì´ ë§¤ìš° ì–´ë ¤ìš´ ìƒí™©ì´ì—ìš”. ê¼­ ì—°ë½ì£¼ì„¸ìš”.',
        'ì–´ë–¤ ì§€ì›ì´ í•„ìš”í•˜ì„¸ìš”? ëª¨ë“  ë°©ë²•ì„ ë™ì›í•´ì„œ ë„ìš¸ê²Œìš”.'
    ]
];

/**
 * ë©”ì‹œì§€ ì„ íƒ í•¨ìˆ˜
 */
function getInterventionMessage(
    string $indicatorType,
    string $level,
    string $interventionType,
    array $variables = []
): string {
    global $indicatorMessages;

    // ê¸°ë³¸ê°’ ì„¤ì •
    if (!isset($indicatorMessages[$indicatorType][$level][$interventionType])) {
        // celebrationì€ ë ˆë²¨ ì—†ì´ ìµœìƒìœ„ì— ìˆìŒ
        if ($interventionType === 'celebration' && isset($indicatorMessages[$indicatorType]['celebration'])) {
            $messages = $indicatorMessages[$indicatorType]['celebration'];
        } else {
            return '';
        }
    } else {
        $messages = $indicatorMessages[$indicatorType][$level][$interventionType];
    }

    // ëœë¤ ì„ íƒ
    $message = $messages[array_rand($messages)];

    // ë³€ìˆ˜ ì¹˜í™˜
    foreach ($variables as $key => $value) {
        $message = str_replace('{' . $key . '}', $value, $message);
    }

    return $message;
}

/**
 * ì´íƒˆ ìœ„í—˜ ë©”ì‹œì§€ ì„ íƒ
 */
function getDropoutMessage(string $level, array $variables = []): string {
    global $dropoutMessages;

    if (!isset($dropoutMessages[$level])) {
        return '';
    }

    $messages = $dropoutMessages[$level];
    $message = $messages[array_rand($messages)];

    foreach ($variables as $key => $value) {
        $message = str_replace('{' . $key . '}', $value, $message);
    }

    return $message;
}

/**
 * ê°œì… ë ˆë²¨ ì •ë³´ ì¡°íšŒ
 */
function getInterventionLevelInfo(string $level): array {
    global $interventionLevels;
    return $interventionLevels[$level] ?? $interventionLevels['notice'];
}

/**
 * ê°œì… ìœ í˜• ì •ë³´ ì¡°íšŒ
 */
function getInterventionTypeInfo(string $type): array {
    global $interventionTypes;
    return $interventionTypes[$type] ?? [];
}

/**
 * ì „ì²´ ê°œì… ë©”ì‹œì§€ ì„¸íŠ¸ ìƒì„±
 */
function generateInterventionSet(
    string $personaCode,
    string $indicatorType,
    string $level,
    array $variables = []
): array {
    $levelInfo = getInterventionLevelInfo($level);

    // ë ˆë²¨ì— ì í•©í•œ ê°œì… ìœ í˜• ì„ íƒ
    $suitableTypes = ['encouragement', 'check_in', 'reminder', 'guidance', 'alert'];
    if ($level === 'critical') {
        $suitableTypes = ['alert', 'check_in'];
    }

    $messages = [];
    foreach ($suitableTypes as $type) {
        $msg = getInterventionMessage($indicatorType, $level, $type, $variables);
        if ($msg) {
            $messages[$type] = $msg;
        }
    }

    return [
        'persona_code' => $personaCode,
        'indicator_type' => $indicatorType,
        'level' => $level,
        'level_info' => $levelInfo,
        'messages' => $messages,
        'follow_up_days' => $levelInfo['auto_follow_up_days'],
        'notify_teacher' => $levelInfo['notify_teacher'] ?? false,
        'timestamp' => date('Y-m-d H:i:s')
    ];
}

/*
 * ì‚¬ìš© ì˜ˆì‹œ:
 *
 * require_once 'message_templates.php';
 *
 * // ë‹¨ì¼ ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°
 * $message = getInterventionMessage('attendance', 'warning', 'encouragement', ['name' => 'ê¹€ì² ìˆ˜']);
 * echo $message;
 *
 * // ì´íƒˆ ìœ„í—˜ ë©”ì‹œì§€
 * $dropoutMsg = getDropoutMessage('critical', ['name' => 'ê¹€ì² ìˆ˜']);
 * echo $dropoutMsg;
 *
 * // ì „ì²´ ê°œì… ì„¸íŠ¸ ìƒì„±
 * $intervention = generateInterventionSet('D-ALERT', 'attendance', 'warning', ['name' => 'ê¹€ì² ìˆ˜']);
 * print_r($intervention);
 *
 * // ë ˆë²¨ ì •ë³´ ì¡°íšŒ
 * $levelInfo = getInterventionLevelInfo('critical');
 * echo $levelInfo['code'];  // "ê¸´ê¸‰"
 * echo $levelInfo['icon'];  // "ğŸš¨"
 */

/*
 * ê´€ë ¨ DB í…Œì´ë¸”:
 * - mdl_at_intervention_log: ê°œì… ê¸°ë¡ ì €ì¥
 *   - intervention_type: encouragement, reminder, guidance, alert, celebration, check_in
 *   - intervention_level: ì£¼ì˜, ê²½ê³ , ê¸´ê¸‰
 *   - indicator_type: attendance, goal, pomodoro, wrong_note, test, composite
 *
 * ê´€ë ¨ íŒŒì¼:
 * - PersonaDataRepository.php: logIntervention() ë©”ì„œë“œ
 * - api.php: log_intervention ì—”ë“œí¬ì¸íŠ¸
 */
