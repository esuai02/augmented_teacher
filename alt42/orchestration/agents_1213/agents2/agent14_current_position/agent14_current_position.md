# Agent 14 Current Position 지식파일

## 목적
- 수학일기 기반 현재 학습 위치/진도를 파악해 계획 대비 차이를 평가
- 완료 시점(tend) 데이터를 활용한 정확한 진행 상태 분석
- 감정 상태(만족도)와 진행 상태를 종합하여 다른 에이전트에게 전달

## 지표
- **계획 대비 완료율**: 완료된 항목 / 전체 항목 × 100
- **진행 상태**: 지연(>30분), 적절(±30분), 원활(<-30분)
- **감정 상태**: 매우만족/만족/불만족 분포
- **지연 시간**: (실제 완료 시간 - 예상 완료 시간) / 60분

## 데이터 소스
- **mdl_abessi_todayplans**: 수학일기 테이블
  - plan1~plan16: 학습 내용
  - due1~due16: 계획 시간(분)
  - status01~status16: 만족도
  - tend01~tend16: 완료 시점(unixtime) ← **신규 추가**
  - tbegin: 작성 시작 시점

## 계산 로직
1. **예상 시간 계산**: tbegin(5분 반올림) + 순차적 duration 합산
2. **지연 계산**: (tend - expected_end) / 60
3. **상태 판정**:
   - delay > 30분 → 지연
   - -30분 ≤ delay ≤ 30분 → 적절
   - delay < -30분 → 원활

## 휴리스틱

### 지연 상황 (delayed > on_time + early)
- **인사이트**: "현재 N개 항목이 지연되고 있습니다."
- **조치**: 병목 해소용 마이크로 목표 추가, 2회 분할 처리

### 원활 상황 (early > delayed + on_time)
- **인사이트**: "예상보다 빠르게 진행 중입니다."
- **조치**: 심화 학습, 추가 도전 과제 제시

### 감정 부정 (불만족 > 만족 + 매우만족)
- **인사이트**: "불만족 응답이 많습니다."
- **조치**: 학습 방식 변경, 쉬운 문제부터 해결

## 코칭 템플릿
- **지연 시**: "지연 구간을 2회 분할해 이번 주에 나눠서 해결합니다."
- **과목 편차**: "약한 과목에 하루 20분 바닥 시간을 고정해요."
- **감정 부정**: "어려운 부분은 건너뛰고 쉬운 승리부터 확보하세요."
- **원활 진행**: "여유 시간을 심화 학습에 투자하세요."

## 다른 에이전트 연계
**Agent Summary 형식**:
```
[Agent14 분석] 완료율 XX% | 진행상태: [지연|적절|원활]
(N개 지연, N개 적절, N개 원활) | 감정상태: [긍정|부정|중립]
(N매우만족 N만족 N불만족) | 권장: [조치사항]
```

**전달 대상**:
- Agent 3: 목표 조정 필요성 판단
- Agent 5: 감정 상태 연계 분석
- Agent 7: 개입 타이밍 결정

## API 엔드포인트
```
GET /alt42/orchestration/agents/agent14_current_position/agent.php?userid={id}
```

## 주의사항
- 12시간 윈도우: 최근 12시간 이내 일기만 분석
- tend 미기록 시 미완료로 처리
- 5분 단위 시간 반올림으로 정확도 향상

Last-Updated: 2025-10-21
Version: 2.0

