# 파동함수-에이전트 매핑 (Wavefunction-Agent Mapping)

> **13종 파동함수 ↔ 22개 에이전트 연결 규칙**

**버전**: 1.1  
**작성일**: 2025-12-08  
**최종 수정**: 2025-12-09

### 📚 관련 문서

| 문서 | 역할 | 바로가기 |
|------|------|---------|
| [00-INDEX.md](./00-INDEX.md) | 문서 허브 | 전체 탐색 |
| [SYSTEM_STATUS.yaml](./SYSTEM_STATUS.yaml) | SSOT | 시스템 현황 |
| [quantum-learning-model.md](./quantum-learning-model.md) | 이론 기반 | 13종 ψ 정의 (Part II) |
| [quantum-orchestration-design.md](./quantum-orchestration-design.md) | 시스템 설계 | StateVector, EntanglementMap |
| [quantum-ide-critical-issues.md](./quantum-ide-critical-issues.md) | 구현 문제점 | 데이터 매핑 불일치 문제 |
| [PRD](../../../tasks/0005-prd-quantum-modeling-completion.md) | 구현 로드맵 | FR-PSI (파동함수 구현) |

---

## 1. 개요

### 1.1 목적

이 문서는 **양자 학습 모델의 13종 파동함수**가 **22개 교육 AI 에이전트**의 출력 데이터로부터 어떻게 계산되는지 정의합니다. 이 매핑은 **실시간 튜터 시스템 (Brain Layer)**의 핵심 연결점입니다.

### 1.2 핵심 구조

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    22개 에이전트 출력 데이터                              │
│  Agent 01~22의 실시간 관찰값, 분석 결과, 상태 정보                        │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
                            Feature Extraction
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│                      13종 파동함수 계산                                  │
│  ψ_core, ψ_align, ψ_fluct, ψ_tunnel, ψ_WM, ψ_affect, ψ_routine,         │
│  ψ_engage, ψ_concept, ψ_cascade, ψ_meta, ψ_context, ψ_predict           │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↓
                              α-Estimator
                                    ↓
┌─────────────────────────────────────────────────────────────────────────┐
│                      개입 판단 (Brain Layer)                            │
│  CP(t) = α(t) · dα/dt · Align · (1 - γ(t))                             │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 에이전트 → 파동함수 매핑 테이블

### 2.1 매핑 범례

| 기호 | 의미 |
|:----:|------|
| 🔴 | **Primary**: 해당 파동함수의 주요 데이터 소스 |
| 🟡 | **Secondary**: 보조 데이터 소스 |
| ⚪ | 관련 없음 |

### 2.2 전체 매핑 매트릭스

| 에이전트 | ψ_core | ψ_align | ψ_fluct | ψ_tunnel | ψ_WM | ψ_affect | ψ_routine | ψ_engage | ψ_concept | ψ_cascade | ψ_meta | ψ_context | ψ_predict |
|---------|:------:|:-------:|:-------:|:--------:|:----:|:--------:|:---------:|:--------:|:---------:|:---------:|:------:|:---------:|:---------:|
| **01 온보딩** | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | ⚪ | 🟡 | 🔴 | ⚪ |
| **02 시험일정** | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 | 🟡 | ⚪ | ⚪ | ⚪ | ⚪ | 🔴 | ⚪ |
| **03 목표분석** | ⚪ | 🔴 | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | ⚪ | 🔴 | 🟡 | ⚪ |
| **04 약점검사** | 🔴 | 🟡 | 🟡 | 🟡 | ⚪ | ⚪ | ⚪ | ⚪ | 🔴 | 🟡 | ⚪ | ⚪ | 🟡 |
| **05 학습감정** | 🟡 | ⚪ | 🟡 | ⚪ | ⚪ | 🔴 | ⚪ | 🟡 | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ |
| **06 교사피드백** | 🟡 | 🟡 | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | 🟡 | ⚪ |
| **07 상호작용타겟** | ⚪ | 🔴 | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | 🟡 | ⚪ | ⚪ | ⚪ | 🔴 | 🔴 |
| **08 침착도** | 🟡 | ⚪ | 🔴 | ⚪ | 🟡 | 🔴 | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 |
| **09 학습관리** | ⚪ | 🟡 | ⚪ | ⚪ | 🔴 | ⚪ | 🔴 | 🟡 | ⚪ | ⚪ | 🟡 | 🟡 | ⚪ |
| **10 개념노트** | 🔴 | 🔴 | 🟡 | 🟡 | 🟡 | ⚪ | ⚪ | ⚪ | 🔴 | 🔴 | ⚪ | ⚪ | 🟡 |
| **11 문제노트** | 🔴 | 🔴 | 🔴 | 🔴 | 🟡 | ⚪ | ⚪ | ⚪ | 🔴 | 🔴 | ⚪ | ⚪ | 🔴 |
| **12 휴식루틴** | ⚪ | ⚪ | 🟡 | ⚪ | 🔴 | 🟡 | 🔴 | 🟡 | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ |
| **13 학습이탈** | ⚪ | ⚪ | 🔴 | ⚪ | 🟡 | 🔴 | ⚪ | 🔴 | ⚪ | ⚪ | ⚪ | ⚪ | 🔴 |
| **14 현재위치** | 🟡 | 🔴 | 🟡 | 🔴 | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 | 🔴 | 🟡 | 🔴 | 🔴 |
| **15 문제재정의** | 🔴 | 🟡 | ⚪ | 🔴 | ⚪ | ⚪ | ⚪ | ⚪ | 🔴 | 🟡 | ⚪ | ⚪ | 🟡 |
| **16 상호작용준비** | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🔴 | ⚪ |
| **17 남은활동** | ⚪ | 🟡 | ⚪ | ⚪ | 🟡 | ⚪ | 🔴 | ⚪ | ⚪ | 🟡 | ⚪ | 🟡 | ⚪ |
| **18 시그니처루틴** | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🔴 | 🟡 | ⚪ | ⚪ | 🔴 | ⚪ | ⚪ |
| **19 상호작용콘텐츠** | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | 🟡 | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | 🔴 | ⚪ |
| **20 개입준비** | ⚪ | 🟡 | ⚪ | 🔴 | ⚪ | 🔴 | ⚪ | 🟡 | ⚪ | ⚪ | ⚪ | 🟡 | 🔴 |
| **21 개입실행** | 🟡 | ⚪ | ⚪ | 🟡 | ⚪ | 🔴 | ⚪ | 🔴 | ⚪ | 🔴 | 🟡 | ⚪ | 🔴 |
| **22 모듈개선** | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | ⚪ | 🟡 | ⚪ | ⚪ | ⚪ | 🔴 | ⚪ | 🟡 |

---

## 3. 파동함수별 상세 매핑

### 3.1 ψ_core: 핵심 3상태 파동함수

**정의**: `|ψ_core⟩ = α|Correct⟩ + β|Misconception⟩ + γ|Confusion⟩`

| 계수 | Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|------|-----------------|-------------------|------------|
| **α (정답)** | 04 약점검사, 10 개념노트, 11 문제노트 | 14 현재위치, 15 문제재정의 | 정답률, 개념 이해도, 풀이 패턴 |
| **β (오개념)** | 04 약점검사, 10 개념노트, 11 문제노트 | 06 교사피드백, 15 문제재정의 | 오답 패턴, 오개념 탐지 결과 |
| **γ (혼란)** | 08 침착도, 05 학습감정 | 11 문제노트, 21 개입실행 | 망설임 시간, 수정 횟수, 감정 상태 |

**계산 공식**:
```python
α = normalize(concept_mastery * 0.4 + problem_accuracy * 0.4 + teacher_confirm * 0.2)
β = normalize(misconception_score * 0.5 + error_pattern_match * 0.3 + feedback_negative * 0.2)
γ = normalize(hesitation_index * 0.4 + revision_count * 0.3 + anxiety_level * 0.3)
```

---

### 3.2 ψ_align: 정렬 파동함수

**정의**: `|A⟩ = Σᵢ wᵢ |directionᵢ⟩` (정답 방향으로의 정렬도)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 03 목표분석, 07 상호작용타겟, 10 개념노트, 11 문제노트, 14 현재위치 | 04 약점검사, 06 교사피드백, 09 학습관리, 15 문제재정의, 17 남은활동, 20 개입준비 | 목표 달성률, 개념 연결 패턴, 풀이 방향성 |

**계산 공식**:
```python
A(t) = Σᵢ cos(θᵢ) / n
# θᵢ = 각 에이전트의 '정답 방향 벡터'와의 각도
```

---

### 3.3 ψ_fluct: 요동 파동함수

**정의**: `|F⟩ = Σ (Δbehaviorᵢ)²` (탐색 에너지)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 08 침착도, 11 문제노트, 13 학습이탈 | 04 약점검사, 05 학습감정, 10 개념노트, 12 휴식루틴, 14 현재위치 | 시도 횟수, 수정 횟수, 시선 이동 폭, 마우스 움직임 |

**계산 공식**:
```python
F(t) = Σ (behavior[t] - behavior[t-1])² / Δt
# 터널링 직전: 요동 패턴이 특정 방향으로 좁혀짐
```

---

### 3.4 ψ_tunnel: 터널링 파동함수

**정의**: `P_tunnel = exp(-Barrier / CognitiveEnergy)` (장벽 돌파 확률)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 11 문제노트, 14 현재위치, 15 문제재정의, 20 개입준비 | 04 약점검사, 10 개념노트, 19 상호작용콘텐츠, 21 개입실행 | 문제 난이도, 인지 에너지, 힌트 제공 여부 |

**계산 공식**:
```python
E_cog = fluctuation_energy * (1 - fatigue_level)
B_concept = problem_difficulty * (1 - prior_knowledge)
P_tunnel = exp(-B_concept / E_cog)
```

---

### 3.5 ψ_WM: 작업기억 안정도 파동함수

**정의**: `W(t) = exp(-t / τ)` (20초 윈도우 기반)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 09 학습관리, 12 휴식루틴 | 08 침착도, 10 개념노트, 11 문제노트, 13 학습이탈, 17 남은활동 | 세션 길이, 휴식 패턴, 정보 유지 시간 |

**계산 공식**:
```python
τ = base_retention * (1 - fatigue_level) * routine_bonus
W(t) = exp(-elapsed_time / τ)
# τ ≈ 20초 (평균 작업기억 유지 시간)
```

---

### 3.6 ψ_affect: 정서 기반 파동함수

**정의**: `|E⟩ = μ|Calm⟩ + ν|Tension⟩ + ξ|Overload⟩`

| 계수 | Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|------|-----------------|-------------------|------------|
| **μ (침착)** | 08 침착도, 05 학습감정 | 12 휴식루틴 | 침착도 점수, 긍정 감정 비율 |
| **ν (긴장)** | 05 학습감정, 08 침착도, 13 학습이탈 | 02 시험일정, 06 교사피드백 | 불안 지수, 시간 압박, 피드백 톤 |
| **ξ (과부하)** | 05 학습감정, 20 개입준비, 21 개입실행 | 16 상호작용준비, 19 상호작용콘텐츠 | 인지 부하, 연속 실패, 과제 누적 |

**계산 공식**:
```python
μ = calmness_score * (1 - anxiety_level)
ν = anxiety_level * time_pressure_factor
ξ = cognitive_load * consecutive_failure_penalty
```

---

### 3.7 ψ_routine: 루틴 강화 파동함수

**정의**: `R(t) = Σᵢ routineᵢ(t) · weightᵢ` (습관 강화 정도)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 09 학습관리, 12 휴식루틴, 17 남은활동, 18 시그니처루틴 | 01 온보딩, 02 시험일정, 03 목표분석, 22 모듈개선 | 일일/주간/장기 루틴 준수율, 학습 패턴 일관성 |

**계산 공식**:
```python
R_daily = daily_routine_adherence * 0.3
R_weekly = weekly_pattern_consistency * 0.3
R_long = long_term_habit_strength * 0.4
R(t) = R_daily + R_weekly + R_long
```

---

### 3.8 ψ_engage: 이탈/복귀 파동함수

**정의**: `|D⟩ = p|Focus⟩ + q|Drift⟩ + r|Drop⟩`

| 계수 | Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|------|-----------------|-------------------|------------|
| **p (집중)** | 13 학습이탈, 21 개입실행 | 07 상호작용타겟, 09 학습관리, 12 휴식루틴, 18 시그니처루틴, 20 개입준비 | 집중 시간, 개입 후 복귀율 |
| **q (이탈)** | 13 학습이탈 | 05 학습감정, 07 상호작용타겟 | 시선 이탈, 비활성 시간 |
| **r (포기)** | 13 학습이탈, 21 개입실행 | ⚪ | 세션 종료, 장기 미접속 |

---

### 3.9 ψ_concept: 개념 구조 파동함수

**정의**: `|C⟩ = Σ entangle(i,j)` (개념 간 얽힘)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 04 약점검사, 10 개념노트, 11 문제노트, 15 문제재정의 | 06 교사피드백, 14 현재위치, 19 상호작용콘텐츠 | 개념 맵, 선행-후행 개념 연결, 전이 패턴 |

---

### 3.10 ψ_cascade: 연쇄 붕괴 파동함수

**정의**: `CC(t) = α₁ · α₂ · α₃ · … · exp(-Δt / k)` (연속 붕괴 확률)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 10 개념노트, 11 문제노트, 14 현재위치, 21 개입실행 | 04 약점검사, 15 문제재정의, 17 남은활동 | 연속 정답률, 개념 연결 붕괴, 단원 진행도 |

---

### 3.11 ψ_meta: 메타인지 파동함수

**정의**: `|M⟩ = s|CanDo⟩ + t|Uncertain⟩` (자기효능감)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 03 목표분석, 18 시그니처루틴, 22 모듈개선 | 01 온보딩, 05 학습감정, 09 학습관리, 14 현재위치, 21 개입실행 | 자기 평가, 목표 설정 패턴, 학습 전략 선택 |

---

### 3.12 ψ_context: 상황문맥 파동함수

**정의**: `|CTX⟩ = Σ contextᵢ · wᵢ` (문제 해석 맥락)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 01 온보딩, 02 시험일정, 07 상호작용타겟, 14 현재위치, 16 상호작용준비, 19 상호작용콘텐츠 | 03 목표분석, 06 교사피드백, 09 학습관리, 17 남은활동, 20 개입준비 | 학습 환경, 시간대, 시험 근접도, 사회적 맥락 |

---

### 3.13 ψ_predict: 예측 파동함수

**정의**: `CP(t) = α(t) · dα/dt · Align(t)` (붕괴 확률 예측)

| Primary 에이전트 | Secondary 에이전트 | 데이터 소스 |
|-----------------|-------------------|------------|
| 07 상호작용타겟, 11 문제노트, 13 학습이탈, 14 현재위치, 20 개입준비, 21 개입실행 | 04 약점검사, 08 침착도, 10 개념노트, 15 문제재정의, 22 모듈개선 | α값 시계열, 정렬도 변화, 패턴 인식 결과 |

---

## 4. α-Estimator 핵심 에이전트

### 4.1 6종 핵심 에이전트

| 에이전트 | 역할 | 전달값 | 영향 파동함수 |
|---------|------|--------|-------------|
| **08 침착도** | 노이즈 제거 + 부하곡선 안정도 | calm_stability_score, gaze_pattern | ψ_core(γ), ψ_fluct, ψ_affect |
| **09 학습관리** | 시간적 일관성 / 계획 준수 | plan_adherence, routine_consistency | ψ_WM, ψ_routine |
| **10 개념노트** | 개념 처리 과정 분석 | concept_flow_alignment, note_delay | ψ_core, ψ_align, ψ_concept, ψ_cascade |
| **11 문제노트** | 오개념→정교화→정답 패턴 | misconception_precision, direction_vector | ψ_core, ψ_align, ψ_fluct, ψ_tunnel, ψ_cascade, ψ_predict |
| **13 학습이탈** | γ→α 복귀 가능성 | reengagement_speed, recovery_curve | ψ_fluct, ψ_affect, ψ_engage, ψ_predict |
| **14 현재위치** | 속도·완성도 기반 수렴성 | learning_curve_deviation, collapse_prob | ψ_align, ψ_tunnel, ψ_context, ψ_cascade, ψ_predict |

### 4.2 α값 계산 파이프라인

```python
# Module E: α Wavefunction Estimation
α(t) = σ(w₁·Align + w₂·pattern + w₃·R + w₄·F_key)
β(t) = 1 - α(t) - γ(t)
γ(t) = σ(noise_model(F))

# Collapse Probability
CP(t) = α(t) · dα/dt · Align · (1 - γ(t))
```

---

## 5. 실시간 튜터 레이어 연결

### 5.1 Brain Layer (양자 판단 엔진)

```
┌─────────────────────────────────────────────────────────────────────────┐
│  Brain Layer 입력 에이전트                                               │
│  [07, 08, 09, 10, 11, 13, 14] → 13종 파동함수 계산 → CP(t) 판단          │
│                                                                         │
│  판단 출력:                                                              │
│  - 개입 (intervention_required = true)                                  │
│  - 비개입 (intervention_required = false)                               │
│  - 미세개입 (micro_intervention = true)                                 │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5.2 Mind Layer (맥락 생성기)

```
┌─────────────────────────────────────────────────────────────────────────┐
│  Mind Layer 입력 에이전트                                                │
│  [16, 19] + Brain 판단 → 대사/지문 생성                                  │
│                                                                         │
│  생성 출력:                                                              │
│  - Script (대사)                                                        │
│  - Instruction (지문)                                                   │
│  - Metadata {tone, speed, emotion}                                      │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5.3 Mouth Layer (동적 TTS)

```
┌─────────────────────────────────────────────────────────────────────────┐
│  Mouth Layer 입력 에이전트                                               │
│  [21] + ψ_affect 값 → 동적 음성 생성                                     │
│                                                                         │
│  음성 파라미터:                                                          │
│  - Calm (ψ_affect.μ ↑) → 차분한 톤                                      │
│  - Excited (ψ_cascade 터짐) → 하이톤                                    │
│  - Alert (β 임계 초과) → 단호한 톤                                       │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 6. 구현 참조

### 6.1 현재 구현 상태

| 레이어 | 파일 | 구현 상태 |
|--------|------|----------|
| Python Quantum | `holons/_quantum_orchestrator.py` | 시나리오 기반 부분 구현 |
| PHP Quantum | `agent04/quantum_modeling/QuantumPersonaEngine.php` | 4페르소나 기반 구현 |
| PHP Core | `engine_core/communication/InterAgentBus.php` | 22개 에이전트 통신 구현 |

### 6.2 확장 계획

- 13종 파동함수 전체 구현 (현재: 이론)
- 64차원 StateVector 확장 (현재: 8차원)
- 실시간 Brain Layer 구현

---

## 7. 버전 히스토리

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-12-08 | 초기 문서 작성. 13종 파동함수 ↔ 22개 에이전트 매핑 정의 |

---

*문서 끝*

