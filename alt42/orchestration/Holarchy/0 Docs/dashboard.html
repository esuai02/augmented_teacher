<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holarchy Dashboard - ÌöåÏùò & Î¨∏ÏÑú Í¥ÄÎ¶¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-hover: #1a1a25;
            --border: #2a2a3a;
            --text-primary: #e8e8f0;
            --text-secondary: #8888a0;
            --text-muted: #555566;
            --accent-cyan: #00d4ff;
            --accent-purple: #a855f7;
            --accent-green: #22c55e;
            --accent-yellow: #eab308;
            --accent-red: #ef4444;
            --accent-orange: #f97316;
            --gradient-1: linear-gradient(135deg, #00d4ff 0%, #a855f7 100%);
            --gradient-2: linear-gradient(135deg, #22c55e 0%, #00d4ff 100%);
        }
        
        /* Light Mode */
        :root.light {
            --bg-dark: #f5f7fa;
            --bg-card: #ffffff;
            --bg-hover: #e8ecf0;
            --border: #d0d7de;
            --text-primary: #1a1a2e;
            --text-secondary: #57606a;
            --text-muted: #8b949e;
            --accent-cyan: #0891b2;
            --accent-purple: #7c3aed;
            --accent-green: #16a34a;
            --accent-yellow: #ca8a04;
            --accent-red: #dc2626;
            --accent-orange: #ea580c;
            --gradient-1: linear-gradient(135deg, #0891b2 0%, #7c3aed 100%);
            --gradient-2: linear-gradient(135deg, #16a34a 0%, #0891b2 100%);
        }
        
        /* Theme Toggle Button */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .theme-toggle:hover {
            background: var(--bg-hover);
            border-color: var(--accent-cyan);
            transform: scale(1.05);
        }
        
        .theme-toggle-icon {
            transition: transform 0.3s ease;
        }
        
        :root.light .theme-toggle-icon {
            transform: rotate(180deg);
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(180deg, rgba(0,212,255,0.1) 0%, transparent 100%);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
        }

        .header-inner {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-stats {
            display: flex;
            gap: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-cyan);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Main Layout - 3 Column */
        .main {
            max-width: 1800px;
            margin: 0 auto;
            padding: 1.5rem;
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            gap: 1.5rem;
        }

        @media (max-width: 1400px) {
            .main {
                grid-template-columns: 260px 1fr;
            }
            .sidebar-right {
                display: none;
            }
        }

        @media (max-width: 1000px) {
            .main {
                grid-template-columns: 1fr;
            }
            .sidebar-left {
                display: none;
            }
        }
        
        .sidebar-left {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .sidebar-right {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--gradient-1);
            color: #000;
            border-color: transparent;
            font-weight: 600;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Meeting Input */
        .meeting-input {
            display: none;
        }

        .meeting-input.active {
            display: block;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.95rem;
            transition: border-color 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        textarea.input-field {
            min-height: 300px;
            resize: vertical;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
        }

        .template-btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            transition: all 0.2s;
        }

        .template-btn:hover {
            background: var(--accent-cyan);
            color: #000;
            border-color: var(--accent-cyan);
        }

        .btn-primary {
            width: 100%;
            padding: 1rem;
            background: var(--gradient-1);
            border: none;
            border-radius: 10px;
            color: #000;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,212,255,0.3);
        }

        /* Document List */
        .doc-list {
            display: none;
        }

        .doc-list.active {
            display: block;
        }

        .doc-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .doc-item:hover {
            border-color: var(--accent-cyan);
            background: var(--bg-hover);
        }

        .doc-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .doc-icon.meeting { background: rgba(168,85,247,0.2); }
        .doc-icon.decision { background: rgba(34,197,94,0.2); }
        .doc-icon.task { background: rgba(249,115,22,0.2); }
        .doc-icon.strategy { background: rgba(0,212,255,0.2); }
        .doc-icon.feature { background: rgba(234,179,8,0.2); }

        .doc-content {
            flex: 1;
            min-width: 0;
        }

        .doc-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .doc-meta {
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: flex;
            gap: 1rem;
        }

        .doc-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-meeting { background: var(--accent-purple); color: #fff; }
        .badge-decision { background: var(--accent-green); color: #fff; }
        .badge-task { background: var(--accent-orange); color: #fff; }
        .badge-pending { background: var(--accent-yellow); color: #000; }
        .badge-done { background: var(--accent-green); color: #fff; }

        /* Graph View */
        .graph-view {
            display: none;
        }

        .graph-view.active {
            display: block;
        }

        .graph-container {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1.5rem;
            min-height: 500px;
            position: relative;
            overflow: hidden;
        }

        .graph-node {
            position: absolute;
            padding: 0.75rem 1rem;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            max-width: 150px;
            text-align: center;
        }

        .graph-node:hover {
            border-color: var(--accent-cyan);
            transform: scale(1.05);
            z-index: 10;
        }

        .graph-node.root {
            border-color: var(--accent-cyan);
            background: linear-gradient(135deg, rgba(0,212,255,0.2) 0%, rgba(168,85,247,0.2) 100%);
        }

        .graph-node.meeting { border-color: var(--accent-purple); }
        .graph-node.decision { border-color: var(--accent-green); }
        .graph-node.task { border-color: var(--accent-orange); }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .quick-stat {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
        }

        .quick-stat-value {
            font-size: 2rem;
            font-weight: 700;
        }

        .quick-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .quick-stat.meetings .quick-stat-value { color: var(--accent-purple); }
        .quick-stat.decisions .quick-stat-value { color: var(--accent-green); }
        .quick-stat.tasks .quick-stat-value { color: var(--accent-orange); }
        .quick-stat.health .quick-stat-value { color: var(--accent-cyan); }

        /* Recent Activity */
        .activity-item {
            display: flex;
            gap: 0.75rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-top: 6px;
            flex-shrink: 0;
        }

        .activity-dot.new { background: var(--accent-green); }
        .activity-dot.update { background: var(--accent-cyan); }
        .activity-dot.check { background: var(--accent-yellow); }

        .activity-text {
            font-size: 0.85rem;
        }

        .activity-time {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        /* CLI Panel */
        .cli-panel {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
        }

        .cli-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--bg-hover);
            border-bottom: 1px solid var(--border);
        }

        .cli-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .cli-dot.red { background: #ff5f56; }
        .cli-dot.yellow { background: #ffbd2e; }
        .cli-dot.green { background: #27c93f; }

        .cli-title {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-left: 0.5rem;
        }

        .cli-content {
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            line-height: 1.8;
            max-height: 200px;
            overflow-y: auto;
        }

        .cli-line {
            color: var(--text-muted);
        }

        .cli-line .cmd { color: var(--accent-cyan); }
        .cli-line .success { color: var(--accent-green); }
        .cli-line .info { color: var(--accent-yellow); }

        /* Result Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--bg-hover);
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .result-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-dark);
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }

        .result-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-icon.success { background: rgba(34,197,94,0.2); color: var(--accent-green); }
        .result-icon.meeting { background: rgba(168,85,247,0.2); color: var(--accent-purple); }
        .result-icon.decision { background: rgba(34,197,94,0.2); color: var(--accent-green); }
        .result-icon.task { background: rgba(249,115,22,0.2); color: var(--accent-orange); }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* ============================================ */
        /* üß† Memory Tuning Panel Styles */
        /* ============================================ */
        
        #memory-panel .card-header {
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .weight-sum {
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
            background: rgba(34, 197, 94, 0.2);
            border-radius: 4px;
            color: var(--accent-green);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .weight-sum.invalid {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }
        
        /* Mode Button Styles */
        .mode-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }
        
        .mode-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-cyan);
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, rgba(0,212,255,0.15) 0%, rgba(168,85,247,0.15) 100%);
            border-color: var(--accent-cyan);
        }
        
        .mode-btn .mode-icon {
            font-size: 1rem;
            width: 24px;
            text-align: center;
        }
        
        .mode-btn .mode-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-primary);
            min-width: 60px;
        }
        
        .mode-btn.active .mode-label {
            color: var(--accent-cyan);
        }
        
        .mode-btn .mode-desc {
            font-size: 0.65rem;
            color: var(--text-muted);
            margin-left: auto;
        }
        
        /* Compact Weight Sliders */
        .weight-compact {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .weight-row-compact {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .weight-row-compact .weight-icon {
            width: 18px;
            height: 18px;
            font-size: 0.6rem;
        }
        
        .weight-row-compact .weight-slider {
            flex: 1;
            height: 3px;
        }
        
        .weight-val {
            font-size: 0.65rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-secondary);
            min-width: 25px;
            text-align: right;
        }
        
        /* Mission Grid */
        .mission-card {
            padding: 0.4rem 0.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .mission-card:hover {
            border-color: var(--accent-cyan);
            background: var(--bg-hover);
        }
        
        .mission-card.active {
            border-color: var(--accent-cyan);
            background: rgba(0, 212, 255, 0.1);
        }
        
        .mission-card .m-code {
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--accent-cyan);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .mission-card .m-name {
            font-size: 0.6rem;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .mission-card .m-count {
            font-size: 0.55rem;
            color: var(--text-muted);
        }
        
        /* Type Button */
        .type-btn {
            padding: 0.4rem 0.75rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .type-btn:hover {
            border-color: var(--accent-purple);
        }
        
        .type-btn.active {
            background: linear-gradient(135deg, rgba(168,85,247,0.2), rgba(0,212,255,0.1));
            border-color: var(--accent-purple);
            color: var(--text-primary);
        }
        
        /* Detected Holon Item */
        .detected-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0.75rem;
            background: var(--bg-dark);
            border-radius: 6px;
            border-left: 3px solid var(--accent-cyan);
        }
        
        .detected-item .d-num {
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--accent-cyan);
            min-width: 20px;
        }
        
        .detected-item .d-title {
            flex: 1;
            font-size: 0.8rem;
            color: var(--text-primary);
        }
        
        .detected-item .d-type {
            font-size: 0.65rem;
            padding: 0.15rem 0.4rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 4px;
            color: var(--accent-purple);
        }
        
        /* Created Holon Item */
        .created-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 6px;
            border-left: 3px solid var(--accent-green);
        }
        
        .created-item .c-module {
            font-size: 0.65rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-cyan);
            min-width: 35px;
        }
        
        .created-item .c-title {
            flex: 1;
            font-size: 0.75rem;
            color: var(--text-primary);
        }
        
        .created-item .c-conf {
            font-size: 0.6rem;
            color: var(--accent-green);
        }
        
        .tuning-row {
            margin-bottom: 1rem;
        }
        
        .tuning-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .tuning-value {
            color: var(--accent-cyan);
            font-weight: 600;
        }
        
        .tuning-slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: var(--bg-dark);
            border-radius: 3px;
            outline: none;
        }
        
        .tuning-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: var(--accent-cyan);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .tuning-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        
        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-bottom: 1rem;
        }
        
        .preset-btn {
            flex: 1;
            min-width: 60px;
            padding: 0.4rem 0.3rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .preset-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--accent-cyan);
        }
        
        .preset-btn.active {
            background: linear-gradient(135deg, rgba(0,212,255,0.2) 0%, rgba(168,85,247,0.2) 100%);
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }
        
        .weight-sliders {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .weight-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .weight-label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            min-width: 70px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .weight-icon {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
        }
        
        .weight-icon.wr { background: rgba(0, 212, 255, 0.3); color: var(--accent-cyan); }
        .weight-icon.wp { background: rgba(168, 85, 247, 0.3); color: var(--accent-purple); }
        .weight-icon.wv { background: rgba(34, 197, 94, 0.3); color: var(--accent-green); }
        .weight-icon.wm { background: rgba(234, 179, 8, 0.3); color: var(--accent-yellow); }
        
        .weight-slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            background: var(--bg-dark);
            border-radius: 2px;
            outline: none;
        }
        
        .weight-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .weight-slider.wr::-webkit-slider-thumb { background: var(--accent-cyan); }
        .weight-slider.wp::-webkit-slider-thumb { background: var(--accent-purple); }
        .weight-slider.wv::-webkit-slider-thumb { background: var(--accent-green); }
        .weight-slider.wm::-webkit-slider-thumb { background: var(--accent-yellow); }
        
        .weight-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        
        .weight-value {
            min-width: 35px;
            text-align: right;
            font-size: 0.75rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-primary);
        }
        
        .normalize-btn {
            width: 100%;
            padding: 0.6rem;
            background: var(--bg-dark);
            border: 1px dashed var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 1rem;
        }
        
        .normalize-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }
        
        .flow-guide {
            background: var(--bg-dark);
            border-radius: 8px;
            padding: 0.75rem;
        }
        
        .flow-title {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .flow-steps {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
        }
        
        .flow-step {
            padding: 0.25rem 0.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
        
        .flow-step.active {
            background: rgba(0, 212, 255, 0.2);
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }
        
        .flow-arrow {
            color: var(--text-muted);
            font-size: 0.7rem;
        }
        
        .flow-formula {
            font-size: 0.65rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-muted);
            text-align: center;
            padding: 0.5rem;
            background: var(--bg-card);
            border-radius: 4px;
        }
        
        .flow-formula .wr { color: var(--accent-cyan); }
        .flow-formula .wp { color: var(--accent-purple); }
        .flow-formula .wv { color: var(--accent-green); }
        .flow-formula .wm { color: var(--accent-yellow); }

        /* ============================================ */
        /* üìö Reference Selection Panel Styles */
        /* ============================================ */
        
        .ref-count {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            background: rgba(0, 212, 255, 0.2);
            border-radius: 4px;
            color: var(--accent-cyan);
        }
        
        .selected-refs {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 1rem;
        }
        
        .ref-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .ref-item:hover {
            border-color: var(--accent-cyan);
            background: var(--bg-hover);
        }
        
        .ref-item.selected {
            border-color: var(--accent-green);
            background: rgba(34, 197, 94, 0.1);
        }
        
        .ref-item.replacing {
            border-color: var(--accent-yellow);
            background: rgba(234, 179, 8, 0.1);
        }
        
        .ref-rank {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--gradient-1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
            color: #000;
            flex-shrink: 0;
        }
        
        .ref-info {
            flex: 1;
            min-width: 0;
        }
        
        .ref-title {
            font-size: 0.85rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .ref-meta {
            font-size: 0.7rem;
            color: var(--text-secondary);
            display: flex;
            gap: 0.75rem;
            margin-top: 0.25rem;
        }
        
        .ref-score {
            width: 60px;
            text-align: right;
        }
        
        .ref-score-bar {
            height: 4px;
            background: var(--bg-card);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 0.25rem;
        }
        
        .ref-score-fill {
            height: 100%;
            background: var(--gradient-1);
            border-radius: 2px;
        }
        
        .ref-score-value {
            font-size: 0.7rem;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-cyan);
        }
        
        .ref-replace-btn, .ref-view-btn {
            padding: 0.4rem 0.6rem;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .ref-replace-btn:hover {
            background: var(--accent-yellow);
            color: #000;
            border-color: var(--accent-yellow);
        }
        
        .ref-view-btn:hover {
            background: var(--accent-cyan);
            color: #000;
            border-color: var(--accent-cyan);
        }
        
        .replacement-panel {
            background: var(--bg-card);
            border: 1px solid var(--accent-yellow);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .replacement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
            color: var(--accent-yellow);
        }
        
        .close-btn {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            background: var(--bg-dark);
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
        }
        
        .replacement-search {
            margin-bottom: 0.75rem;
        }
        
        .replacement-search input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.85rem;
        }
        
        .replacement-search input:focus {
            outline: none;
            border-color: var(--accent-yellow);
        }
        
        .replacement-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .replacement-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--bg-dark);
            border-radius: 6px;
            margin-bottom: 0.4rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.8rem;
        }
        
        .replacement-item:hover {
            background: var(--bg-hover);
            color: var(--accent-yellow);
        }
        
        .replacement-item .score {
            margin-left: auto;
            font-size: 0.7rem;
            color: var(--text-muted);
        }
        
        .ref-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .btn-secondary {
            flex: 1;
            padding: 0.75rem 1rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            min-width: fit-content;
        }
        
        .btn-secondary:hover {
            background: var(--bg-hover);
            border-color: var(--text-secondary);
        }
        
        .ref-actions .btn-primary {
            flex: 2;
        }

        /* ============================================ */
        /* üìÑ Inline Flow Sections */
        /* ============================================ */
        
        .flow-section {
            display: none;
            animation: slideDown 0.3s ease-out;
        }
        
        .flow-section.active {
            display: block;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Step Indicator */
        .step-indicator {
            display: flex;
            align-items: center;
            gap: 0;
            margin-bottom: 1.5rem;
            padding: 0 1rem;
        }
        
        .step-dot {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            transition: all 0.3s;
            z-index: 1;
        }
        
        .step-dot.active {
            background: var(--gradient-1);
            border-color: var(--accent-cyan);
            color: #000;
        }
        
        .step-dot.completed {
            background: var(--accent-green);
            border-color: var(--accent-green);
            color: #fff;
        }
        
        .step-line {
            flex: 1;
            height: 2px;
            background: var(--border);
            transition: background 0.3s;
        }
        
        .step-line.completed {
            background: var(--accent-green);
        }
        
        .step-label {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.65rem;
            color: var(--text-muted);
            white-space: nowrap;
            margin-top: 0.25rem;
        }
        
        .step-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Result Section */
        .result-section {
            background: var(--bg-dark);
            border: 1px solid var(--accent-green);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .result-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .result-header .icon {
            font-size: 1.5rem;
        }
        
        .result-header h4 {
            font-size: 1.1rem;
            color: var(--accent-green);
        }
        
        .result-info {
            display: grid;
            gap: 0.75rem;
        }
        
        .result-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-card);
            border-radius: 8px;
        }
        
        .result-row .label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            min-width: 80px;
        }
        
        .result-row .value {
            font-size: 0.85rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        /* Document Viewer Inline */
        .doc-viewer-inline {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 1rem;
        }
        
        /* Attachments Section */
        .doc-attachments {
            border-bottom: 1px solid var(--border);
            padding: 1rem 1.25rem;
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.05) 0%, rgba(0, 212, 255, 0.05) 100%);
        }
        
        .attachments-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--accent-purple);
        }
        
        .attachment-count {
            font-size: 0.75rem;
            background: var(--accent-purple);
            color: #000;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .attachments-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .attachment-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            background: var(--bg-dark);
            border-radius: 8px;
            border: 1px solid var(--border);
            transition: all 0.2s;
        }
        
        .attachment-item:hover {
            background: var(--bg-hover);
            border-color: var(--accent-purple);
        }
        
        .attachment-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        
        .attachment-info {
            flex: 1;
            min-width: 0;
        }
        
        .attachment-name {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .attachment-meta {
            font-size: 0.7rem;
            color: var(--text-secondary);
            display: flex;
            gap: 0.75rem;
            margin-top: 0.2rem;
        }
        
        .attachment-type {
            padding: 0.15rem 0.4rem;
            background: var(--bg-hover);
            border-radius: 4px;
            font-size: 0.65rem;
            color: var(--accent-cyan);
            text-transform: uppercase;
        }
        
        .attachment-action {
            padding: 0.4rem 0.6rem;
            background: var(--accent-purple);
            color: #000;
            border: none;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .attachment-action:hover {
            background: var(--accent-cyan);
            transform: scale(1.05);
        }
        
        .no-attachments {
            text-align: center;
            padding: 1rem;
            color: var(--text-muted);
            font-size: 0.8rem;
        }
        
        .doc-viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--bg-hover);
            border-bottom: 1px solid var(--border);
        }
        
        .doc-viewer-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .doc-viewer-title h3 {
            font-size: 1rem;
            font-weight: 600;
        }
        
        .doc-viewer-title .filepath {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .doc-viewer-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .doc-viewer-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .doc-viewer-btn:hover {
            background: var(--accent-cyan);
            color: #000;
            border-color: var(--accent-cyan);
        }
        
        .doc-viewer-content {
            padding: 1.5rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .doc-content-wrapper {
            background: var(--bg-dark);
            border-radius: 8px;
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.8;
            white-space: pre-wrap;
            word-break: break-word;
            color: var(--text-primary);
        }
        
        .doc-content-wrapper .json-block {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid var(--accent-cyan);
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        /* Weights Applied Badge */
        .weights-badge {
            display: inline-flex;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: var(--bg-dark);
            border-radius: 6px;
            font-size: 0.7rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .weights-badge span:nth-child(1) { color: var(--accent-cyan); }
        .weights-badge span:nth-child(2) { color: var(--accent-purple); }
        .weights-badge span:nth-child(3) { color: var(--accent-green); }
        .weights-badge span:nth-child(4) { color: var(--accent-yellow); }
        
        /* Collapse/Expand */
        .collapse-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .collapse-btn:hover {
            background: var(--bg-dark);
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-in {
            animation: fadeIn 0.3s ease-out;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-inner">
            <div class="logo">
                <div class="logo-icon">üî•</div>
                <span class="logo-text">Holarchy Dashboard</span>
            </div>
            <div class="header-actions">
                <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-docs">15</div>
                    <div class="stat-label">Ï¥ù Î¨∏ÏÑú</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="health-score">90%</div>
                    <div class="stat-label">Í±¥Í∞ïÎèÑ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="today-updates">3</div>
                    <div class="stat-label">Ïò§Îäò ÏóÖÎç∞Ïù¥Ìä∏</div>
                </div>
                </div>
                <!-- Help Button -->
                <a href="manual.html" class="theme-toggle" title="ÎèÑÏõÄÎßê" style="text-decoration: none;">
                    <span>‚ùì</span>
                    <span>Help</span>
                </a>
                <!-- Theme Toggle -->
                <button class="theme-toggle" onclick="toggleTheme()" title="Îã§ÌÅ¨/ÎùºÏù¥Ìä∏ Î™®Îìú Ï†ÑÌôò">
                    <span class="theme-toggle-icon" id="theme-icon">üåô</span>
                    <span id="theme-label">Dark</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Left Sidebar: Memory Tuning + Stats -->
        <aside class="sidebar-left">
            <!-- üß† Memory Tuning Panel -->
            <div class="card" id="memory-panel">
                <div class="card-header" style="border-bottom: 1px solid var(--border); padding-bottom: 0.75rem; margin-bottom: 1rem;">
                    <h3 class="card-title" style="font-size: 0.95rem;">üß† Memory</h3>
                </div>
                
                <!-- ÌòÑÏû¨ Î™®Îìú ÌëúÏãú -->
                <div id="current-mode" style="text-align: center; margin-bottom: 1rem; padding: 0.5rem; background: rgba(0,212,255,0.1); border-radius: 6px;">
                    <span style="font-size: 0.7rem; color: var(--text-muted);">ÌòÑÏû¨ Î™®Îìú</span>
                    <div style="font-size: 0.9rem; font-weight: 600; color: var(--accent-cyan);" id="mode-name">‚öñÔ∏è Balanced</div>
                </div>
                
                <!-- ÌîÑÎ¶¨ÏÖã Î≤ÑÌäº (ÏÑ∏Î°ú Î∞∞Ïπò, Î™ÖÏπ≠ Ìè¨Ìï®) -->
                <div style="display: flex; flex-direction: column; gap: 0.4rem; margin-bottom: 1rem;">
                    <button class="mode-btn" data-mode="fast_fresh" onclick="applyPreset('fast_fresh')">
                        <span class="mode-icon">‚ö°</span>
                        <span class="mode-label">Fast</span>
                        <span class="mode-desc">ÏµúÏã† Ïö∞ÏÑ†</span>
                    </button>
                    <button class="mode-btn" data-mode="wisdom" onclick="applyPreset('wisdom')">
                        <span class="mode-icon">üìö</span>
                        <span class="mode-label">Wisdom</span>
                        <span class="mode-desc">Ï§ëÏöîÎèÑ Ïö∞ÏÑ†</span>
                    </button>
                    <button class="mode-btn active" data-mode="balanced" onclick="applyPreset('balanced')">
                        <span class="mode-icon">‚öñÔ∏è</span>
                        <span class="mode-label">Balanced</span>
                        <span class="mode-desc">Í∑†Ìòï Î™®Îìú</span>
                    </button>
                    <button class="mode-btn" data-mode="pattern" onclick="applyPreset('pattern')">
                        <span class="mode-icon">üîç</span>
                        <span class="mode-label">Pattern</span>
                        <span class="mode-desc">Ìå®ÌÑ¥ ÌÉêÏÉâ</span>
                    </button>
                    <button class="mode-btn" data-mode="trend" onclick="applyPreset('trend')">
                        <span class="mode-icon">üìà</span>
                        <span class="mode-label">Trend</span>
                        <span class="mode-desc">Ìä∏Î†åÎìú Î∂ÑÏÑù</span>
                    </button>
                </div>
                
                <!-- Íµ¨Î∂ÑÏÑ† -->
                <div style="border-top: 1px solid var(--border); margin: 1rem 0; padding-top: 1rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Ï∞∏Ï°∞ Î¨∏ÏÑú</span>
                        <span style="font-size: 0.9rem; font-weight: 600; color: var(--accent-cyan);" id="topk-value">7</span>
                    </div>
                    <input type="range" class="tuning-slider" id="topk-slider" 
                           min="3" max="20" value="7" oninput="updateTopK(this.value)" style="width: 100%;">
                </div>
                
                <!-- Í∞ÄÏ§ëÏπò Ïä¨ÎùºÏù¥Îçî (Ïª¥Ìå©Ìä∏) -->
                <div style="border-top: 1px solid var(--border); margin-top: 0.5rem; padding-top: 1rem;">
                    <div style="font-size: 0.7rem; color: var(--text-muted); margin-bottom: 0.75rem;">Í∞ÄÏ§ëÏπò ÎØ∏ÏÑ∏ Ï°∞Ï†ï</div>
                    <div class="weight-compact">
                        <div class="weight-row-compact">
                            <span class="weight-icon wr">R</span>
                            <input type="range" class="weight-slider wr" id="weight-recency" 
                                   min="0" max="100" value="25" oninput="updateWeight('recency', this.value)">
                            <span class="weight-val" id="val-recency">.25</span>
                        </div>
                        <div class="weight-row-compact">
                            <span class="weight-icon wp">P</span>
                            <input type="range" class="weight-slider wp" id="weight-popularity" 
                                   min="0" max="100" value="25" oninput="updateWeight('popularity', this.value)">
                            <span class="weight-val" id="val-popularity">.25</span>
                        </div>
                        <div class="weight-row-compact">
                            <span class="weight-icon wv">V</span>
                            <input type="range" class="weight-slider wv" id="weight-relevance" 
                                   min="0" max="100" value="25" oninput="updateWeight('relevance', this.value)">
                            <span class="weight-val" id="val-relevance">.25</span>
                        </div>
                        <div class="weight-row-compact">
                            <span class="weight-icon wm">M</span>
                            <input type="range" class="weight-slider wm" id="weight-importance" 
                                   min="0" max="100" value="25" oninput="updateWeight('importance', this.value)">
                            <span class="weight-val" id="val-importance">.25</span>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.75rem;">
                        <button onclick="normalizeWeights()" style="font-size: 0.6rem; color: var(--text-muted); background: none; border: none; cursor: pointer; padding: 0.2rem 0.4rem; border-radius: 4px; transition: all 0.2s;" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='none'">üîÑ Ï†ïÍ∑úÌôî</button>
                        <span class="weight-sum" id="weight-sum">1.00 ‚úì</span>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üìä ÌòÑÌô©</h3>
                </div>
                <div class="quick-stats" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="quick-stat meetings">
                        <div class="quick-stat-value" id="stat-meetings">2</div>
                        <div class="quick-stat-label">Meetings</div>
                    </div>
                    <div class="quick-stat decisions">
                        <div class="quick-stat-value" id="stat-decisions">3</div>
                        <div class="quick-stat-label">Decisions</div>
                    </div>
                    <div class="quick-stat tasks">
                        <div class="quick-stat-value" id="stat-tasks">2</div>
                        <div class="quick-stat-label">Tasks</div>
                    </div>
                    <div class="quick-stat health">
                        <div class="quick-stat-value" id="stat-health">90</div>
                        <div class="quick-stat-label">Health</div>
                    </div>
                </div>
            </div>

            <!-- ÌîåÎ°úÏö∞ Í∞ÄÏù¥Îìú -->
            <div class="card">
                <div class="flow-guide" style="background: transparent; padding: 0;">
                    <div class="flow-title">üìã Ï†êÏàò Í≥µÏãù</div>
                    <div class="flow-formula" style="font-size: 0.6rem;">
                        <span class="wr">R</span>√óÏµúÍ∑º + <span class="wp">P</span>√óÏ°∞Ìöå + <span class="wv">V</span>√óÏÉÅÍ¥Ä + <span class="wm">M</span>√óÏ§ëÏöî
                    </div>
                </div>
            </div>
        </aside>

        <!-- Center: Main Content -->
        <div class="content">
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" data-tab="input">üìù ÌöåÏùòÎ°ù</button>
                <button class="tab" data-tab="mission">üéØ ÎØ∏ÏÖò Î∞∞Ïπò</button>
                <button class="tab" data-tab="issues">üîç Ïù¥Ïäà Î¶¨Î∑∞</button>
                <button class="tab" data-tab="meetings">üìã Meetings</button>
                <button class="tab" data-tab="decisions">‚úÖ Decisions</button>
                <button class="tab" data-tab="tasks">‚¨ú Tasks</button>
                <button class="tab" data-tab="graph">üï∏Ô∏è Í∑∏ÎûòÌîÑ</button>
            </div>

            <!-- Meeting Input -->
            <div class="meeting-input active" id="tab-input">
                
                <!-- Step Indicator -->
                <div class="step-indicator" id="step-indicator">
                    <div class="step-wrapper">
                        <div class="step-dot active" id="step-1">1</div>
                        <span class="step-label">ÏûÖÎ†•</span>
                    </div>
                    <div class="step-line" id="line-1"></div>
                    <div class="step-wrapper">
                        <div class="step-dot" id="step-2">2</div>
                        <span class="step-label">Ï∞∏Ï°∞ ÏÑ†ÌÉù</span>
                    </div>
                    <div class="step-line" id="line-2"></div>
                    <div class="step-wrapper">
                        <div class="step-dot" id="step-3">3</div>
                        <span class="step-label">ÏÉùÏÑ±</span>
                    </div>
                    <div class="step-line" id="line-3"></div>
                    <div class="step-wrapper">
                        <div class="step-dot" id="step-4">4</div>
                        <span class="step-label">ÏôÑÎ£å</span>
                    </div>
                </div>

                <!-- Step 1: ÏûÖÎ†• -->
                <div class="flow-section active" id="section-input">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìù Step 1: ÌöåÏùòÎ°ù ÏûÖÎ†•</h3>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù</label>
                            <button class="template-btn" onclick="useTemplate('basic')">Í∏∞Î≥∏ ÌöåÏùòÎ°ù</button>
                            <button class="template-btn" onclick="useTemplate('standup')">Ïä§ÌÉ†ÎìúÏóÖ</button>
                            <button class="template-btn" onclick="useTemplate('planning')">Í∏∞Ìöç ÌöåÏùò</button>
                            <button class="template-btn" onclick="useTemplate('review')">Î¶¨Î∑∞ ÌöåÏùò</button>
                        </div>
                        
                        <div class="input-group">
                            <label class="input-label">ÌöåÏùòÎ°ù ÎÇ¥Ïö©</label>
                            <textarea class="input-field" id="meeting-content" placeholder="# ÌöåÏùò Ï†úÎ™©

ÏùºÏãú: 2025-11-30
Ï∞∏ÏÑùÏûê: ÍπÄÏ≤†Ïàò, Ïù¥ÏòÅÌù¨

## ÏïàÍ±¥
1. MVP Î≤îÏúÑ ÌôïÏ†ï
2. ÏùºÏ†ï ÎÖºÏùò

## ÎÖºÏùò ÎÇ¥Ïö©
ÌïôÏÉù ÏßÑÎã® Í∏∞Îä•ÏùÑ Î®ºÏ†Ä Í∞úÎ∞úÌïòÍ∏∞Î°ú Ìï®.

## Í≤∞Ï†ï ÏÇ¨Ìï≠
- Í≤∞Ï†ï: MVPÎäî ÏßÑÎã® Î¶¨Ìè¨Ìä∏ Í∏∞Îä•ÏúºÎ°ú ÌïúÏ†ï
- Í≤∞Ï†ï: 2Ïõî Îßê Î≤†ÌÉÄ Ï∂úÏãú Î™©Ìëú

## Ìï†Ïùº
- TODO: ÍπÄÏ≤†Ïàò - UI ÎîîÏûêÏù∏ (12/15ÍπåÏßÄ)
- TODO: Ïù¥ÏòÅÌù¨ - API ÏÑ§Í≥Ñ"></textarea>
                        </div>
                        
                        <button class="btn-primary" onclick="goToStep2()">
                            Îã§Ïùå: Ï∞∏Ï°∞ Î¨∏ÏÑú Î∂ÑÏÑù ‚Üí
                        </button>
                    </div>
                </div>

                <!-- Step 2: Ï∞∏Ï°∞ Î¨∏ÏÑú ÏÑ†ÌÉù -->
                <div class="flow-section" id="section-refs">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìö Step 2: Ï∞∏Ï°∞ Î¨∏ÏÑú ÏÑ†ÌÉù</h3>
                            <span class="ref-count" id="ref-count">0Í∞ú ÏÑ†ÌÉù</span>
                        </div>
                        
                        <div class="weights-badge" id="applied-weights">
                            <span>R:0.25</span>
                            <span>P:0.25</span>
                            <span>V:0.25</span>
                            <span>M:0.25</span>
                        </div>
                        
                        <!-- ÏÑ†ÌÉùÎêú Ï∞∏Ï°∞ Î¨∏ÏÑú Î™©Î°ù -->
                        <div id="selected-refs" class="selected-refs" style="margin-top: 1rem;">
                            <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                        </div>
                        
                        <!-- ÎåÄÏ≤¥ Î¨∏ÏÑú ÏÑ†ÌÉù ÏòÅÏó≠ (ÌÅ¥Î¶≠ Ïãú ÌëúÏãú) -->
                        <div id="replacement-panel" class="replacement-panel" style="display: none;">
                            <div class="replacement-header">
                                <span>üîÑ ÎåÄÏ≤¥Ìï† Î¨∏ÏÑú ÏÑ†ÌÉù</span>
                                <button class="close-btn" onclick="closeReplacementPanel()">√ó</button>
                            </div>
                            <div class="replacement-search">
                                <input type="text" id="replacement-search" placeholder="Î¨∏ÏÑú Í≤ÄÏÉâ..." 
                                       oninput="filterReplacements(this.value)">
                            </div>
                            <div id="replacement-list" class="replacement-list">
                                <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                            </div>
                        </div>
                        
                        <div class="ref-actions" style="margin-top: 1rem;">
                            <button class="btn-secondary" onclick="goToStep1()">
                                ‚Üê Ïù¥Ï†Ñ
                            </button>
                            <button class="btn-primary" onclick="goToStep3()">
                                Îã§Ïùå: ÏÉùÏÑ±ÌïòÍ∏∞ ‚Üí
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: ÏÉùÏÑ± Ï§ë -->
                <div class="flow-section" id="section-generating">
                    <div class="card" style="text-align: center; padding: 3rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">‚è≥</div>
                        <h3 style="color: var(--accent-cyan); margin-bottom: 0.5rem;">ÏÉùÏÑ± Ï§ë...</h3>
                        <p style="color: var(--text-secondary);">ÏÑ†ÌÉùÎêú Ï∞∏Ï°∞ Î¨∏ÏÑúÎ•º Í∏∞Î∞òÏúºÎ°ú HolonÏùÑ ÏÉùÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§.</p>
                    </div>
                </div>

                <!-- Step 4: ÏôÑÎ£å & Î¨∏ÏÑú Î≥¥Í∏∞ -->
                <div class="flow-section" id="section-result">
                    <div class="result-section">
                        <div class="result-header">
                            <span class="icon">‚úÖ</span>
                            <h4>ÏÉùÏÑ± ÏôÑÎ£å!</h4>
                        </div>
                        
                        <div class="result-info" id="result-info">
                            <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                        </div>
                        
                        <div style="margin-top: 1.5rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
                            <button class="btn-secondary" style="flex: none;" onclick="toggleDocViewer()">üìÑ Î¨∏ÏÑú Î≥¥Í∏∞</button>
                            <button class="btn-primary" style="flex: 1;" onclick="resetFlow()">+ ÏÉà Î¨∏ÏÑú ÏÉùÏÑ±</button>
                        </div>
                    </div>
                    
                    <!-- Î¨∏ÏÑú Î∑∞Ïñ¥ (Ïù∏ÎùºÏù∏) -->
                    <div class="doc-viewer-inline" id="doc-viewer-inline" style="display: none;">
                        <div class="doc-viewer-header">
                            <div class="doc-viewer-title">
                                <span>üìÑ</span>
                                <div>
                                    <h3 id="inline-doc-name">Î¨∏ÏÑú Ïù¥Î¶Ñ</h3>
                                    <div class="filepath" id="inline-doc-path">/path/to/file.md</div>
                                </div>
                            </div>
                            <div class="doc-viewer-actions">
                                <button class="doc-viewer-btn" onclick="copyDocContent()">üìã Î≥µÏÇ¨</button>
                                <button class="collapse-btn" onclick="toggleDocViewer()">Ï†ëÍ∏∞ ‚ñ≤</button>
                            </div>
                        </div>
                        
                        <!-- Ï≤®Î∂ÄÌååÏùº ÏÑπÏÖò -->
                        <div class="doc-attachments" id="doc-attachments" style="display: none;">
                            <div class="attachments-header">
                                <span>üìé Ï≤®Î∂ÄÌååÏùº</span>
                                <span class="attachment-count" id="attachment-count">0Í∞ú</span>
                            </div>
                            <div class="attachments-list" id="attachments-list">
                                <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                            </div>
                        </div>
                        
                        <div class="doc-viewer-content">
                            <div class="doc-content-wrapper" id="inline-doc-content">
                                <!-- Î¨∏ÏÑú ÎÇ¥Ïö© -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ï∞∏Í≥† Ìå®ÎÑê (Ìï≠ÏÉÅ ÌëúÏãú) -->
                <div class="card" style="margin-top: 1rem;">
                    <div class="card-header">
                        <h3 class="card-title">üí° ÏûêÎèô Ïù∏Ïãù Ìå®ÌÑ¥</h3>
                    </div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                        <div><code style="color: var(--accent-cyan);">Í≤∞Ï†ï:</code> ÎòêÎäî <code style="color: var(--accent-cyan);">Ìï©Ïùò:</code> ‚Üí Decision ÏûêÎèô ÏÉùÏÑ±</div>
                        <div><code style="color: var(--accent-orange);">TODO:</code> ÎòêÎäî <code style="color: var(--accent-orange);">Ìï†Ïùº:</code> ‚Üí Task ÏûêÎèô ÏÉùÏÑ±</div>
                        <div><code style="color: var(--accent-purple);">Ï∞∏ÏÑùÏûê:</code> ‚Üí Ï∞∏ÏÑùÏûê ÏûêÎèô Ï∂îÏ∂ú</div>
                        <div><code style="color: var(--accent-green);">ÏïàÍ±¥:</code> ‚Üí ÏïàÍ±¥ Î™©Î°ù ÏûêÎèô Ï∂îÏ∂ú</div>
                    </div>
                </div>
            </div>

            <!-- Mission Placement -->
            <div class="doc-list" id="tab-mission">
                <div class="card">
                    <div class="card-header" style="border-bottom: 1px solid var(--border); padding-bottom: 1rem; margin-bottom: 1rem;">
                        <h3 class="card-title">üéØ 22Í∞ú ÎØ∏ÏÖò ÏóêÏù¥Ï†ÑÌä∏ Î∞∞Ïπò</h3>
                        <span style="color: var(--text-secondary); font-size: 0.75rem;">Îã§Ï§ë ÌôÄÎ°† ÎèôÏãú ÏÉùÏÑ±</span>
                    </div>
                    
                    <!-- ÏûÖÎ†• ÏòÅÏó≠ -->
                    <div style="margin-bottom: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <label style="font-size: 0.85rem; color: var(--text-secondary);">ÎÇ¥Ïö© ÏûÖÎ†• (Íµ¨Î∂ÑÏûê: --- ÎòêÎäî ## Ìó§Îçî)</label>
                            <button class="btn-secondary" style="padding: 0.3rem 0.6rem; font-size: 0.7rem;" onclick="analyzeInput()">üîç Î∂ÑÏÑù</button>
                        </div>
                        <textarea id="mission-input" placeholder="Ïó¨Îü¨ ÌôÄÎ°†ÏùÑ ÎèôÏãúÏóê ÏûÖÎ†•ÌïòÏÑ∏Ïöî.

ÏòàÏãú 1 (Íµ¨Î∂ÑÏûê):
AI ÌäúÌÑ∞ Í∞êÏ†ï ÏóîÏßÑ Í∞úÎ∞ú
---
ÌïôÏÉù ÏÑ±Ï∑®ÎèÑ ÎåÄÏãúÎ≥¥Îìú ÏÑ§Í≥Ñ
---
Ïã§ÏãúÍ∞Ñ ÌîºÎìúÎ∞± ÏãúÏä§ÌÖú Íµ¨ÌòÑ

ÏòàÏãú 2 (Ìó§Îçî):
## ÌîÑÎ°úÏ†ùÌä∏: AI ÌäúÌÑ∞ ÏïÑÌÇ§ÌÖçÏ≤ò
Îî•Îü¨Îãù Í∏∞Î∞ò Í∞êÏ†ï Î∂ÑÏÑù

## ÌÉúÏä§ÌÅ¨: API Ïó∞Îèô
OpenAI GPT Ïó∞Í≤∞" style="width: 100%; height: 180px; background: var(--bg-dark); border: 1px solid var(--border); border-radius: 8px; padding: 1rem; color: var(--text-primary); font-size: 0.85rem; resize: vertical;"></textarea>
                    </div>
                    
                    <!-- Î∂ÑÏÑù Í≤∞Í≥º -->
                    <div id="analysis-result" style="display: none; margin-bottom: 1.5rem;">
                        <div style="font-size: 0.8rem; color: var(--accent-cyan); margin-bottom: 0.75rem;">üìä Î∂ÑÏÑù Í≤∞Í≥º</div>
                        <div id="detected-holons" style="display: flex; flex-direction: column; gap: 0.5rem;"></div>
                    </div>
                    
                    <!-- ÎØ∏ÏÖò ÏóêÏù¥Ï†ÑÌä∏ Í∑∏Î¶¨Îìú -->
                    <div style="margin-bottom: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                            <span style="font-size: 0.8rem; color: var(--text-secondary);">üéØ ÎØ∏ÏÖò ÏóêÏù¥Ï†ÑÌä∏ ÏÑ†ÌÉù</span>
                            <span id="selected-path" style="font-size: 0.65rem; color: var(--accent-cyan); font-family: 'JetBrains Mono', monospace;">ÏûêÎèô Î∂ÑÎ•ò</span>
                        </div>
                        <div id="mission-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.4rem; max-height: 280px; overflow-y: auto; padding: 0.5rem; background: var(--bg-dark); border-radius: 8px;">
                            <!-- ÎØ∏ÏÖò Ïπ¥ÎìúÎì§Ïù¥ ÎèôÏ†ÅÏúºÎ°ú Ï±ÑÏõåÏßê -->
                        </div>
                        <div style="margin-top: 0.5rem; text-align: right;">
                            <button onclick="clearMissionSelection()" style="font-size: 0.65rem; padding: 0.25rem 0.5rem; background: none; border: 1px solid var(--border); border-radius: 4px; color: var(--text-muted); cursor: pointer;">‚úï ÏÑ†ÌÉù Ìï¥Ï†ú (ÏûêÎèô Î∂ÑÎ•ò)</button>
                        </div>
                    </div>
                    
                    <!-- ÌôÄÎ°† ÌÉÄÏûÖ ÏÑ†ÌÉù -->
                    <div style="margin-bottom: 1.5rem;">
                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.5rem;">üì¶ ÌôÄÎ°† ÌÉÄÏûÖ</div>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button class="type-btn active" data-type="auto" onclick="selectHolonType('auto')">ü§ñ Auto</button>
                            <button class="type-btn" data-type="project" onclick="selectHolonType('project')">üìÅ Project</button>
                            <button class="type-btn" data-type="task" onclick="selectHolonType('task')">‚úÖ Task</button>
                            <button class="type-btn" data-type="drilling" onclick="selectHolonType('drilling')">üî¨ Drilling</button>
                            <button class="type-btn" data-type="app" onclick="selectHolonType('app')">ü§ñ App</button>
                        </div>
                    </div>
                    
                    <!-- ÏÉùÏÑ± Î≤ÑÌäº -->
                    <div style="display: flex; gap: 0.75rem;">
                        <button class="btn-primary" style="flex: 1;" onclick="createMultiHolons()">
                            ‚ö° Îã§Ï§ë ÌôÄÎ°† ÏÉùÏÑ±
                        </button>
                    </div>
                    
                    <!-- ÏÉùÏÑ± Í≤∞Í≥º -->
                    <div id="multi-result" style="display: none; margin-top: 1.5rem; padding: 1rem; background: var(--bg-dark); border-radius: 8px;">
                        <div style="font-size: 0.85rem; color: var(--accent-green); margin-bottom: 0.75rem;">‚úÖ ÏÉùÏÑ± ÏôÑÎ£å</div>
                        <div id="created-holons" style="display: flex; flex-direction: column; gap: 0.5rem;"></div>
                    </div>
                </div>
            </div>

            <!-- üîç Ïù¥Ïäà Î¶¨Î∑∞ ÌÉ≠ -->
            <div class="doc-list" id="tab-issues">
                <div class="card">
                    <div class="card-header" style="border-bottom: 1px solid var(--border); padding-bottom: 1rem; margin-bottom: 1rem;">
                        <h3 class="card-title">üîç ÎØ∏ÏôÑÏÑ± ÏßÄÏ†ê Î¶¨Î∑∞</h3>
                        <span style="color: var(--text-secondary); font-size: 0.75rem;">ÏΩîÎìú/Î¨∏ÏÑú Ïù¥Ïäà ÌÉêÏßÄ Î∞è Ï≤òÎ¶¨</span>
                    </div>
                    
                    <!-- ÏöîÏïΩ Ïπ¥Îìú -->
                    <div id="issue-summary" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; margin-bottom: 1.5rem;">
                        <div style="background: var(--bg-dark); padding: 0.75rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-red);" id="issue-open-count">0</div>
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">Ïó¥Î¶∞ Ïù¥Ïäà</div>
                        </div>
                        <div style="background: var(--bg-dark); padding: 0.75rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-yellow);" id="issue-high-count">0</div>
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">HIGH Ïã¨Í∞ÅÎèÑ</div>
                        </div>
                        <div style="background: var(--bg-dark); padding: 0.75rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-green);" id="issue-resolved-count">0</div>
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">Ìï¥Í≤∞Îê®</div>
                        </div>
                        <div style="background: var(--bg-dark); padding: 0.75rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--text-secondary);" id="issue-total-count">0</div>
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">Ï†ÑÏ≤¥</div>
                        </div>
                    </div>
                    
                    <!-- ÌïÑÌÑ∞ Î∞è Ïï°ÏÖò -->
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                        <select id="issue-category-filter" style="padding: 0.4rem 0.6rem; background: var(--bg-dark); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 0.75rem;">
                            <option value="">Î™®Îì† Ïπ¥ÌÖåÍ≥†Î¶¨</option>
                            <option value="placeholder">üìù Placeholder</option>
                            <option value="hardcoded">‚öôÔ∏è ÌïòÎìúÏΩîÎî©</option>
                            <option value="api_gap">üîó API Ïó∞Îèô</option>
                            <option value="error_handling">‚ö†Ô∏è ÏóêÎü¨ Ï≤òÎ¶¨</option>
                            <option value="integration">üîÑ Í∏∞Îä• Ïó∞Îèô</option>
                        </select>
                        <select id="issue-severity-filter" style="padding: 0.4rem 0.6rem; background: var(--bg-dark); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 0.75rem;">
                            <option value="">Î™®Îì† Ïã¨Í∞ÅÎèÑ</option>
                            <option value="high">üî¥ HIGH</option>
                            <option value="medium">üü° MEDIUM</option>
                            <option value="low">üü¢ LOW</option>
                        </select>
                        <button onclick="scanIssues()" style="padding: 0.4rem 0.8rem; background: var(--accent-blue); border: none; border-radius: 6px; color: white; font-size: 0.75rem; cursor: pointer;">
                            üîç Ïä§Ï∫î
                        </button>
                        <button onclick="loadIssues()" style="padding: 0.4rem 0.8rem; background: var(--bg-light); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 0.75rem; cursor: pointer;">
                            üîÑ ÏÉàÎ°úÍ≥†Ïπ®
                        </button>
                    </div>
                    
                    <!-- Ïù¥Ïäà Î™©Î°ù -->
                    <div id="issue-list" style="max-height: 400px; overflow-y: auto;">
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            üîç Ïä§Ï∫î Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ Ïù¥ÏäàÎ•º ÌÉêÏßÄÌïòÏÑ∏Ïöî
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meetings List -->
            <div class="doc-list" id="tab-meetings">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìã ÌöåÏùò Î™©Î°ù</h3>
                        <span style="color: var(--text-secondary); font-size: 0.85rem;" id="meeting-count">2Í±¥</span>
                    </div>
                    <div id="meetings-container">
                        <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                    </div>
                </div>
            </div>

            <!-- Decisions List -->
            <div class="doc-list" id="tab-decisions">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">‚úÖ Í≤∞Ï†ï ÏÇ¨Ìï≠</h3>
                        <span style="color: var(--text-secondary); font-size: 0.85rem;" id="decision-count">3Í±¥</span>
                    </div>
                    <div id="decisions-container">
                        <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                    </div>
                </div>
            </div>

            <!-- Tasks List -->
            <div class="doc-list" id="tab-tasks">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">‚¨ú Ìï†Ïùº Î™©Î°ù</h3>
                        <span style="color: var(--text-secondary); font-size: 0.85rem;" id="task-count">2Í±¥</span>
                    </div>
                    <div id="tasks-container">
                        <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                    </div>
                </div>
            </div>

            <!-- Graph View -->
            <div class="graph-view" id="tab-graph">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üï∏Ô∏è Î¨∏ÏÑú Í¥ÄÍ≥Ñ Í∑∏ÎûòÌîÑ</h3>
                    </div>
                    <div class="graph-container" id="graph-container">
                        <!-- Í∑∏ÎûòÌîÑ ÎÖ∏ÎìúÎì§ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar: Activity, CLI, Quick Actions -->
        <aside class="sidebar-right">
            <!-- Recent Activity -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">‚ö° ÏµúÍ∑º ÌôúÎèô</h3>
                </div>
                <div id="activity-container">
                    <div class="activity-item">
                        <div class="activity-dot new"></div>
                        <div>
                            <div class="activity-text">Meeting ÏÉùÏÑ±: AI ÌäúÌÑ∞ ÌÇ•Ïò§ÌîÑ</div>
                            <div class="activity-time">Î∞©Í∏à Ï†Ñ</div>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-dot new"></div>
                        <div>
                            <div class="activity-text">Task ÏÉùÏÑ±: UI ÎîîÏûêÏù∏</div>
                            <div class="activity-time">Î∞©Í∏à Ï†Ñ</div>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-dot check"></div>
                        <div>
                            <div class="activity-text">Self-Healing Í≤ÄÏ¶ù ÏôÑÎ£å</div>
                            <div class="activity-time">5Î∂Ñ Ï†Ñ</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CLI Panel -->
            <div class="card" style="padding: 0;">
                <div class="cli-panel">
                    <div class="cli-header">
                        <div class="cli-dot red"></div>
                        <div class="cli-dot yellow"></div>
                        <div class="cli-dot green"></div>
                        <span class="cli-title">Terminal</span>
                    </div>
                    <div class="cli-content" id="cli-output">
                        <div class="cli-line"><span class="cmd">$</span> python _cli.py check</div>
                        <div class="cli-line"><span class="success">üî• Self-Healing ÏôÑÎ£å</span></div>
                        <div class="cli-line"><span class="info">ÌèâÍ∑† Ï†êÏàò: 90%</span></div>
                        <div class="cli-line"></div>
                        <div class="cli-line"><span class="cmd">$</span> _</div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üöÄ Îπ†Î•∏ Ïã§Ìñâ</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <button class="template-btn" style="width: 100%; text-align: center;" onclick="runCommand('check')">
                        üîç Í≤ÄÏ¶ù (check)
                    </button>
                    <button class="template-btn" style="width: 100%; text-align: center;" onclick="runCommand('link')">
                        üîó ÎßÅÌÅ¨ ÎèôÍ∏∞Ìôî
                    </button>
                    <button class="template-btn" style="width: 100%; text-align: center;" onclick="runCommand('report')">
                        üìã Î¶¨Ìè¨Ìä∏ Î≥¥Í∏∞
                    </button>
                </div>
            </div>
        </aside>
    </main>

    <!-- Î™®Îã¨ Ï†úÍ±∞Îê® - Ïù∏ÎùºÏù∏ ÌîåÎ°úÏö∞Î°ú ÎåÄÏ≤¥ -->

    <script>
        // ============================================================
        // üß† Memory Weights ÏÉÅÌÉú Í¥ÄÎ¶¨
        // ============================================================
        let brainWeights = {
            recency: 0.25,
            popularity: 0.25,
            relevance: 0.25,
            importance: 0.25,
            top_k: 7
        };

        const presets = {
            fast_fresh: { recency: 0.5, popularity: 0.1, relevance: 0.3, importance: 0.1 },
            wisdom: { recency: 0.1, popularity: 0.1, relevance: 0.3, importance: 0.5 },
            balanced: { recency: 0.25, popularity: 0.25, relevance: 0.25, importance: 0.25 },
            pattern: { recency: 0.0, popularity: 0.1, relevance: 0.4, importance: 0.5 },
            trend: { recency: 0.4, popularity: 0.4, relevance: 0.2, importance: 0.0 }
        };

        // Top-K ÏóÖÎç∞Ïù¥Ìä∏
        function updateTopK(value) {
            brainWeights.top_k = parseInt(value);
            document.getElementById('topk-value').textContent = value;
            syncWeightsToServer();
        }

        // Í∞úÎ≥Ñ Í∞ÄÏ§ëÏπò ÏóÖÎç∞Ïù¥Ìä∏
        function updateWeight(name, value) {
            brainWeights[name] = value / 100;
            // ÏßßÏùÄ ÌòïÏãùÏúºÎ°ú ÌëúÏãú (.25 ÌòïÏãù)
            document.getElementById('val-' + name).textContent = '.' + Math.round(value).toString().padStart(2, '0');
            updateWeightSum();
            
            // ÌîÑÎ¶¨ÏÖãÍ≥º ÏùºÏπòÌïòÏßÄ ÏïäÏúºÎ©¥ Custom ÌëúÏãú
            document.getElementById('mode-name').textContent = 'üéõÔ∏è Custom';
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
        }

        // Ìï©Í≥Ñ ÏóÖÎç∞Ïù¥Ìä∏ Î∞è ÌëúÏãú
        function updateWeightSum() {
            const sum = brainWeights.recency + brainWeights.popularity + 
                       brainWeights.relevance + brainWeights.importance;
            const sumEl = document.getElementById('weight-sum');
            
            if (Math.abs(sum - 1.0) < 0.01) {
                sumEl.textContent = `${sum.toFixed(2)} ‚úì`;
                sumEl.classList.remove('invalid');
            } else {
                sumEl.textContent = `${sum.toFixed(2)} ‚ö†`;
                sumEl.classList.add('invalid');
            }
        }

        // Ï†ïÍ∑úÌôî (Ìï©Í≥Ñ = 1.0)
        function normalizeWeights() {
            const sum = brainWeights.recency + brainWeights.popularity + 
                       brainWeights.relevance + brainWeights.importance;
            
            if (sum > 0) {
                brainWeights.recency /= sum;
                brainWeights.popularity /= sum;
                brainWeights.relevance /= sum;
                brainWeights.importance /= sum;
            } else {
                // Î™®Îëê 0Ïù¥Î©¥ Í∑†Îì± Î∞∞Î∂Ñ
                brainWeights.recency = 0.25;
                brainWeights.popularity = 0.25;
                brainWeights.relevance = 0.25;
                brainWeights.importance = 0.25;
            }
            
            updateSliders();
            updateWeightSum();
            syncWeightsToServer();
        }

        // ÌîÑÎ¶¨ÏÖã Ï†ÅÏö©
        // Î™®Îìú Ïù¥Î¶Ñ Îß§Ìïë
        const modeNames = {
            fast_fresh: '‚ö° Fast',
            wisdom: 'üìö Wisdom',
            balanced: '‚öñÔ∏è Balanced',
            pattern: 'üîç Pattern',
            trend: 'üìà Trend'
        };

        function applyPreset(name) {
            if (presets[name]) {
                Object.assign(brainWeights, presets[name]);
                updateSliders();
                updateWeightSum();
                
                // Î™®Îìú Î≤ÑÌäº ÌôúÏÑ±Ìôî ÌëúÏãú
                document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`.mode-btn[data-mode="${name}"]`)?.classList.add('active');
                
                // ÌòÑÏû¨ Î™®Îìú Ïù¥Î¶Ñ ÏóÖÎç∞Ïù¥Ìä∏
                const modeNameEl = document.getElementById('mode-name');
                if (modeNameEl) {
                    modeNameEl.textContent = modeNames[name] || name;
                }
                
                syncWeightsToServer();
                addActivity(`üß† Î™®Îìú Î≥ÄÍ≤Ω: ${modeNames[name]}`);
            }
        }

        // Ïä¨ÎùºÏù¥Îçî UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateSliders() {
            document.getElementById('weight-recency').value = brainWeights.recency * 100;
            document.getElementById('weight-popularity').value = brainWeights.popularity * 100;
            document.getElementById('weight-relevance').value = brainWeights.relevance * 100;
            document.getElementById('weight-importance').value = brainWeights.importance * 100;
            
            // ÏßßÏùÄ ÌòïÏãùÏúºÎ°ú ÌëúÏãú (.25 ÌòïÏãù)
            document.getElementById('val-recency').textContent = '.' + Math.round(brainWeights.recency * 100).toString().padStart(2, '0');
            document.getElementById('val-popularity').textContent = '.' + Math.round(brainWeights.popularity * 100).toString().padStart(2, '0');
            document.getElementById('val-relevance').textContent = '.' + Math.round(brainWeights.relevance * 100).toString().padStart(2, '0');
            document.getElementById('val-importance').textContent = '.' + Math.round(brainWeights.importance * 100).toString().padStart(2, '0');
        }

        // ÏÑúÎ≤ÑÏóê Í∞ÄÏ§ëÏπò ÎèôÍ∏∞Ìôî
        async function syncWeightsToServer() {
            if (!useServer) return;
            
            try {
                await fetch(API_BASE + '/api/brain/weights', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        recency: brainWeights.recency,
                        popularity: brainWeights.popularity,
                        relevance: brainWeights.relevance,
                        importance: brainWeights.importance,
                        top_k: brainWeights.top_k,
                        normalize: false
                    })
                });
            } catch (e) {
                console.error('Í∞ÄÏ§ëÏπò ÎèôÍ∏∞Ìôî Ïã§Ìå®:', e);
            }
        }

        // ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ§ëÏπò Î°úÎìú
        async function loadWeightsFromServer() {
            if (!useServer) return;
            
            try {
                const res = await fetch(API_BASE + '/api/brain/weights');
                const data = await res.json();
                if (data.success && data.weights) {
                    brainWeights = { ...brainWeights, ...data.weights };
                    updateSliders();
                    updateWeightSum();
                    document.getElementById('topk-value').textContent = brainWeights.top_k;
                    document.getElementById('topk-slider').value = brainWeights.top_k;
                }
            } catch (e) {
                console.error('Í∞ÄÏ§ëÏπò Î°úÎìú Ïã§Ìå®:', e);
            }
        }

        // ============================================================
        // üìö Ïù∏ÎùºÏù∏ ÌîåÎ°úÏö∞ ÏãúÏä§ÌÖú (4Îã®Í≥Ñ)
        // ============================================================
        
        let selectedRefs = [];        // ÏÑ†ÌÉùÎêú Ï∞∏Ï°∞ Î¨∏ÏÑú Î™©Î°ù
        let allAvailableDocs = [];    // Ï†ÑÏ≤¥ ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Î¨∏ÏÑú Î™©Î°ù
        let replacingIndex = -1;      // ÌòÑÏû¨ ÍµêÏ≤¥ Ï§ëÏù∏ Î¨∏ÏÑú Ïù∏Îç±Ïä§
        let pendingContent = '';      // ÎåÄÍ∏∞ Ï§ëÏù∏ ÌöåÏùòÎ°ù ÎÇ¥Ïö©
        let createdFilePath = '';     // ÏÉùÏÑ±Îêú ÌååÏùº Í≤ΩÎ°ú
        let currentStep = 1;          // ÌòÑÏû¨ Îã®Í≥Ñ

        // Îã®Í≥Ñ Ïù¥Îèô Ìï®Ïàò
        function setStep(step) {
            currentStep = step;
            
            // Î™®Îì† ÏÑπÏÖò Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.flow-section').forEach(s => s.classList.remove('active'));
            
            // Ïä§ÌÖù Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
            for (let i = 1; i <= 4; i++) {
                const dot = document.getElementById('step-' + i);
                const line = document.getElementById('line-' + i);
                
                dot.classList.remove('active', 'completed');
                if (line) line.classList.remove('completed');
                
                if (i < step) {
                    dot.classList.add('completed');
                    dot.textContent = '‚úì';
                    if (line) line.classList.add('completed');
                } else if (i === step) {
                    dot.classList.add('active');
                    dot.textContent = i;
                } else {
                    dot.textContent = i;
                }
            }
            
            // Ìï¥Îãπ ÏÑπÏÖò ÌëúÏãú
            if (step === 1) document.getElementById('section-input').classList.add('active');
            else if (step === 2) document.getElementById('section-refs').classList.add('active');
            else if (step === 3) document.getElementById('section-generating').classList.add('active');
            else if (step === 4) document.getElementById('section-result').classList.add('active');
        }

        // Step 1 ‚Üí Step 2
        async function goToStep2() {
            const content = document.getElementById('meeting-content').value;
            if (!content.trim()) {
                alert('ÌöåÏùòÎ°ù ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            pendingContent = content;
            
            if (!useServer) {
                alert('ÏÑúÎ≤ÑÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§. python server.py Ïã§Ìñâ ÌõÑ ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏÑ∏Ïöî.');
                return;
            }
            
            try {
                // Î≤ÑÌäº ÏÉÅÌÉú Î≥ÄÍ≤Ω
                const btn = document.querySelector('#section-input .btn-primary');
                btn.textContent = '‚è≥ Î∂ÑÏÑù Ï§ë...';
                btn.disabled = true;
                
                // Ï∞∏Ï°∞ Î¨∏ÏÑú Í≤ÄÏÉâ
                const keywords = content.split(/\s+/).slice(0, 50).join(' ');
                const res = await fetch(API_BASE + '/api/brain/search', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        query: keywords,
                        top_k: brainWeights.top_k
                    })
                });
                const data = await res.json();
                
                btn.textContent = 'Îã§Ïùå: Ï∞∏Ï°∞ Î¨∏ÏÑú Î∂ÑÏÑù ‚Üí';
                btn.disabled = false;
                
                if (data.success) {
                    selectedRefs = data.results;
                    allAvailableDocs = data.results;
                    
                    // Í∞ÄÏ§ëÏπò ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
                    document.getElementById('applied-weights').innerHTML = `
                        <span>R:${brainWeights.recency.toFixed(2)}</span>
                        <span>P:${brainWeights.popularity.toFixed(2)}</span>
                        <span>V:${brainWeights.relevance.toFixed(2)}</span>
                        <span>M:${brainWeights.importance.toFixed(2)}</span>
                    `;
                    
                    renderRefPreview();
                    setStep(2);
                    addActivity(`üîç Ï∞∏Ï°∞ Î¨∏ÏÑú ${data.results.length}Í∞ú Î∂ÑÏÑù ÏôÑÎ£å`);
                } else {
                    alert('Ïò§Î•ò: ' + data.error);
                }
            } catch (e) {
                const btn = document.querySelector('#section-input .btn-primary');
                btn.textContent = 'Îã§Ïùå: Ï∞∏Ï°∞ Î¨∏ÏÑú Î∂ÑÏÑù ‚Üí';
                btn.disabled = false;
                alert('ÏÑúÎ≤Ñ Ïò§Î•ò: ' + e.message);
            }
        }

        // Step 2 ‚Üê Step 1
        function goToStep1() {
            setStep(1);
        }

        // Step 2 ‚Üí Step 3 ‚Üí Step 4
        async function goToStep3() {
            setStep(3);
            
            try {
                const refIds = selectedRefs.map(r => r.holon_id);
                
                const res = await fetch(API_BASE + '/api/brain/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        text: pendingContent, 
                        type: 'meeting',
                        top_k: selectedRefs.length,
                        selected_refs: refIds
                    })
                });
                const data = await res.json();
                
                if (data.success) {
                    createdFilePath = data.created.file;
                    
                    // Ï∞∏Ï°∞ Î¨∏ÏÑú Î™©Î°ù HTML ÏÉùÏÑ±
                    const refDocsHtml = data.referenced_docs && data.referenced_docs.length > 0
                        ? data.referenced_docs.slice(0, 5).map(doc => 
                            `<div style="font-size: 0.7rem; padding: 0.3rem 0.5rem; background: var(--bg-hover); border-radius: 4px; margin-top: 0.3rem;">
                                üìö ${doc.filename || doc.holon_id} <span style="color: var(--accent-green);">${Math.round((doc.final_score || doc.score || 0) * 100)}%</span>
                            </div>`
                        ).join('')
                        : '<span style="color: var(--text-muted);">ÏóÜÏùå</span>';
                    
                    // Í≤∞Í≥º Ï†ïÎ≥¥ ÌëúÏãú
                    document.getElementById('result-info').innerHTML = `
                        <div class="result-row">
                            <span class="label">Î¨∏ÏÑú ID</span>
                            <span class="value">${data.created.holon_id}</span>
                        </div>
                        <div class="result-row">
                            <span class="label">ÌÉÄÏûÖ</span>
                            <span class="value">${data.created.type}</span>
                        </div>
                        <div class="result-row">
                            <span class="label">ÌååÏùº Í≤ΩÎ°ú</span>
                            <span class="value" style="font-size: 0.75rem;">${data.created.file.replace(/\\/g, '/')}</span>
                        </div>
                        <div class="result-row">
                            <span class="label">Ï†ÅÏö© Í∞ÄÏ§ëÏπò</span>
                            <div class="weights-badge">
                                <span>R:${data.weights_used.recency.toFixed(2)}</span>
                                <span>P:${data.weights_used.popularity.toFixed(2)}</span>
                                <span>V:${data.weights_used.relevance.toFixed(2)}</span>
                                <span>M:${data.weights_used.importance.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="result-row" style="flex-direction: column; align-items: flex-start;">
                            <span class="label">üìö Ï∞∏Ï°∞Îêú HTE Î¨∏ÏÑú (${data.referenced_docs?.length || selectedRefs.length}Í∞ú)</span>
                            <div style="width: 100%; margin-top: 0.5rem;">${refDocsHtml}</div>
                        </div>
                    `;
                    
                    setStep(4);
                    loadDocuments();
                    addActivity(`üìÅ ÏÉùÏÑ± ÏôÑÎ£å: ${data.created.holon_id}`);
                    
                    // ÏûêÎèôÏúºÎ°ú Î¨∏ÏÑú Î∑∞Ïñ¥ Î°úÎìú
                    await loadDocumentContent(createdFilePath);
                } else {
                    alert('Ïò§Î•ò: ' + data.error);
                    setStep(2);
                }
            } catch (e) {
                alert('ÏÑúÎ≤Ñ Ïò§Î•ò: ' + e.message);
                setStep(2);
            }
        }

        // ÌîåÎ°úÏö∞ Î¶¨ÏÖã
        function resetFlow() {
            document.getElementById('meeting-content').value = '';
            selectedRefs = [];
            pendingContent = '';
            createdFilePath = '';
            document.getElementById('doc-viewer-inline').style.display = 'none';
            setStep(1);
        }

        // ============================================================
        // üéØ ÎØ∏ÏÖò ÏóêÏù¥Ï†ÑÌä∏ Î∞∞Ïπò ÏãúÏä§ÌÖú
        // ============================================================
        
        let selectedMission = null;
        let selectedHolonType = 'auto';
        let missionData = [];
        
        // ÎØ∏ÏÖò Í∑∏Î¶¨Îìú Î°úÎìú
        async function loadMissions() {
            try {
                const res = await fetch(`${API_URL}/api/missions`);
                const data = await res.json();
                
                if (data.success) {
                    missionData = data.missions;
                    renderMissionGrid(data.missions);
                }
            } catch (e) {
                console.error('ÎØ∏ÏÖò Î°úÎìú Ïã§Ìå®:', e);
            }
        }
        
        // ÎØ∏ÏÖò Í∑∏Î¶¨Îìú Î†åÎçîÎßÅ
        function renderMissionGrid(missions) {
            const grid = document.getElementById('mission-grid');
            if (!grid) return;
            
            grid.innerHTML = missions.map(m => `
                <div class="mission-card ${selectedMission === m.id ? 'active' : ''}" 
                     onclick="selectMission('${m.id}')" 
                     title="${m.full}&#10;${m.desc}&#10;‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&#10;ÌÇ§ÏõåÎìú: ${m.keywords.slice(0,5).join(', ')}">
                    <div class="m-code">${m.id}</div>
                    <div class="m-name" title="${m.name}">${m.name.length > 10 ? m.name.slice(0,10) + '..' : m.name}</div>
                    <div class="m-count">${m.file_count > 0 ? m.file_count + 'üìÑ' : '‚îÄ'}</div>
                </div>
            `).join('');
        }
        
        // ÎØ∏ÏÖò ÏÑ†ÌÉù
        function selectMission(missionId) {
            if (selectedMission === missionId) {
                selectedMission = null;  // ÌÜ†Í∏Ä
            } else {
                selectedMission = missionId;
            }
            renderMissionGrid(missionData);
            updateSelectedPath();
        }
        
        // ÏÑ†ÌÉù Ìï¥Ï†ú
        function clearMissionSelection() {
            selectedMission = null;
            renderMissionGrid(missionData);
            updateSelectedPath();
        }
        
        // ÏÑ†ÌÉùÎêú Í≤ΩÎ°ú ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateSelectedPath() {
            const pathEl = document.getElementById('selected-path');
            if (pathEl) {
                if (selectedMission) {
                    const mission = missionData.find(m => m.id === selectedMission);
                    if (mission) {
                        pathEl.textContent = `üìÅ 2 Company/4 HTE/${mission.full}/`;
                        pathEl.style.color = 'var(--accent-green)';
                    }
                } else {
                    pathEl.textContent = 'ÏûêÎèô Î∂ÑÎ•ò';
                    pathEl.style.color = 'var(--accent-cyan)';
                }
            }
        }
        
        // ÌôÄÎ°† ÌÉÄÏûÖ ÏÑ†ÌÉù
        function selectHolonType(type) {
            selectedHolonType = type;
            document.querySelectorAll('.type-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });
        }
        
        // ÏûÖÎ†• Î∂ÑÏÑù
        async function analyzeInput() {
            const text = document.getElementById('mission-input').value.trim();
            if (!text) {
                alert('ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            try {
                const res = await fetch(`${API_URL}/api/analyze`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ text })
                });
                
                const data = await res.json();
                
                if (data.success) {
                    // Î∂ÑÏÑù Í≤∞Í≥º ÌëúÏãú
                    const resultDiv = document.getElementById('analysis-result');
                    const holonsDiv = document.getElementById('detected-holons');
                    
                    resultDiv.style.display = 'block';
                    
                    holonsDiv.innerHTML = data.detected_holons.map(h => `
                        <div class="detected-item">
                            <span class="d-num">#${h.index}</span>
                            <span class="d-title">${h.title}</span>
                            <span class="d-type">${h.type}</span>
                        </div>
                    `).join('');
                    
                    // Ï∂îÏ≤ú ÎØ∏ÏÖò ÌïòÏù¥ÎùºÏù¥Ìä∏
                    if (data.mission_recommendations) {
                        const topMission = Object.keys(data.mission_recommendations)[0];
                        if (topMission) {
                            selectMission(topMission);
                        }
                    }
                    
                    addActivity(`üîç Î∂ÑÏÑù ÏôÑÎ£å: ${data.holon_count}Í∞ú ÌôÄÎ°† Í∞êÏßÄ`);
                }
            } catch (e) {
                console.error('Î∂ÑÏÑù Ïã§Ìå®:', e);
                alert('Î∂ÑÏÑù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        // Îã§Ï§ë ÌôÄÎ°† ÏÉùÏÑ±
        async function createMultiHolons() {
            const text = document.getElementById('mission-input').value.trim();
            if (!text) {
                alert('ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            try {
                const targetModule = selectedMission || null;
                const targetPath = targetModule 
                    ? missionData.find(m => m.id === targetModule)?.full 
                    : 'ÏûêÎèô Î∂ÑÎ•ò';
                
                addActivity(`‚ö° ${targetPath}Ïóê ÌôÄÎ°† ÏÉùÏÑ± Ï§ë...`);
                
                const res = await fetch(`${API_URL}/api/place/multi`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        text,
                        module: targetModule,  // ÏÑ†ÌÉùÎêú ÎØ∏ÏÖò ÏóêÏù¥Ï†ÑÌä∏
                        parent_id: targetModule ? `hte-${targetModule.toLowerCase()}` : null
                    })
                });
                
                const data = await res.json();
                
                if (data.success) {
                    // Í≤∞Í≥º ÌëúÏãú
                    const resultDiv = document.getElementById('multi-result');
                    const holonsDiv = document.getElementById('created-holons');
                    
                    resultDiv.style.display = 'block';
                    
                    // ÏÉùÏÑ± Í≤ΩÎ°ú ÌëúÏãú Ï∂îÍ∞Ä
                    const pathInfo = data.target_module 
                        ? `<div style="font-size: 0.7rem; color: var(--text-muted); margin-bottom: 0.5rem;">üìÅ ${data.target_path}</div>`
                        : '';
                    
                    holonsDiv.innerHTML = pathInfo + data.holons.map(h => `
                        <div class="created-item">
                            <span class="c-module">${h.module.split('_')[0]}</span>
                            <span class="c-title">${h.title}</span>
                            <span class="c-conf">${Math.round(h.confidence * 100)}%</span>
                        </div>
                    `).join('');
                    
                    addActivity(`‚úÖ ${data.count}Í∞ú ÌôÄÎ°† ‚Üí ${data.target_path || 'ÏûêÎèô Î∂ÑÎ•ò'}`);
                    
                    // Î∂ÑÏÑù Í≤∞Í≥º Ïà®Í∏∞Í∏∞
                    document.getElementById('analysis-result').style.display = 'none';
                    
                    // ÎØ∏ÏÖò Í∑∏Î¶¨Îìú ÏÉàÎ°úÍ≥†Ïπ®
                    loadMissions();
                    
                    // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
                    updateStats();
                } else {
                    alert('ÏÉùÏÑ± Ïã§Ìå®: ' + (data.error || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'));
                }
            } catch (e) {
                console.error('ÏÉùÏÑ± Ïã§Ìå®:', e);
                alert('ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + e.message);
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÎØ∏ÏÖò Î°úÎìú Î∞è ÌÖåÎßà Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', () => {
            loadMissions();
            initTheme();
        });
        
        // ============================================================
        // üåì ÌÖåÎßà ÌÜ†Í∏Ä (Îã§ÌÅ¨/ÎùºÏù¥Ìä∏ Î™®Îìú)
        // ============================================================
        
        function initTheme() {
            const savedTheme = localStorage.getItem('holarchy-theme') || 'dark';
            if (savedTheme === 'light') {
                document.documentElement.classList.add('light');
                updateThemeUI('light');
            }
        }
        
        function toggleTheme() {
            const isLight = document.documentElement.classList.toggle('light');
            const theme = isLight ? 'light' : 'dark';
            localStorage.setItem('holarchy-theme', theme);
            updateThemeUI(theme);
            addActivity(`üåì ÌÖåÎßà Î≥ÄÍ≤Ω: ${theme === 'light' ? 'ÎùºÏù¥Ìä∏ Î™®Îìú' : 'Îã§ÌÅ¨ Î™®Îìú'}`);
        }
        
        function updateThemeUI(theme) {
            const icon = document.getElementById('theme-icon');
            const label = document.getElementById('theme-label');
            if (theme === 'light') {
                icon.textContent = '‚òÄÔ∏è';
                label.textContent = 'Light';
            } else {
                icon.textContent = 'üåô';
                label.textContent = 'Dark';
            }
        }

        // Î¨∏ÏÑú Î∑∞Ïñ¥ ÌÜ†Í∏Ä
        function toggleDocViewer() {
            const viewer = document.getElementById('doc-viewer-inline');
            if (viewer.style.display === 'none') {
                viewer.style.display = 'block';
            } else {
                viewer.style.display = 'none';
            }
        }

        // Î¨∏ÏÑú ÎÇ¥Ïö© Î°úÎìú
        async function loadDocumentContent(filepath) {
            try {
                const res = await fetch(API_BASE + '/api/document/read', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ filepath: filepath })
                });
                const data = await res.json();
                
                if (data.success) {
                    currentDocContent = data.content;
                    document.getElementById('inline-doc-name').textContent = data.filename;
                    document.getElementById('inline-doc-path').textContent = filepath.replace(/\\/g, '/');
                    
                    let formattedContent = escapeHtml(data.content);
                    formattedContent = formattedContent.replace(
                        /(```json[\s\S]*?```)/g, 
                        '<div class="json-block">$1</div>'
                    );
                    
                    document.getElementById('inline-doc-content').innerHTML = formattedContent;
                    document.getElementById('doc-viewer-inline').style.display = 'block';
                    
                    // Ï≤®Î∂ÄÌååÏùº ÌååÏã± Î∞è ÌëúÏãú
                    parseAndDisplayAttachments(data.content, filepath);
                }
            } catch (e) {
                console.error('Î¨∏ÏÑú Î°úÎìú Ïã§Ìå®:', e);
            }
        }
        
        // Ï≤®Î∂ÄÌååÏùº ÌååÏã± Î∞è ÌëúÏãú
        function parseAndDisplayAttachments(content, filepath) {
            const attachmentsDiv = document.getElementById('doc-attachments');
            const listDiv = document.getElementById('attachments-list');
            const countSpan = document.getElementById('attachment-count');
            
            // JSON Î∏îÎ°ùÏóêÏÑú attachments Ï∂îÏ∂ú
            const jsonMatch = content.match(/```json\s*\n([\s\S]*?)\n```/);
            let attachments = [];
            
            if (jsonMatch) {
                try {
                    const holon = JSON.parse(jsonMatch[1]);
                    attachments = holon.attachments || [];
                } catch (e) {
                    console.log('JSON ÌååÏã± Ïã§Ìå®:', e);
                }
            }
            
            if (attachments.length > 0) {
                attachmentsDiv.style.display = 'block';
                countSpan.textContent = `${attachments.length}Í∞ú`;
                
                // ÌååÏùº Í∏∞Ï§Ä Í≤ΩÎ°ú Í≥ÑÏÇ∞
                const basePath = filepath.replace(/[^/\\]+$/, '');
                
                let html = attachments.map(att => {
                    const icon = getAttachmentIcon(att.type);
                    const fullPath = att.path.startsWith('_attachments') 
                        ? basePath + att.path 
                        : att.path;
                    
                    return `
                        <div class="attachment-item">
                            <span class="attachment-icon">${icon}</span>
                            <div class="attachment-info">
                                <div class="attachment-name">${escapeHtml(att.name)}</div>
                                <div class="attachment-meta">
                                    <span class="attachment-type">${att.type}</span>
                                    ${att.description ? `<span>${escapeHtml(att.description)}</span>` : ''}
                                    ${att.added_at ? `<span>üìÖ ${att.added_at}</span>` : ''}
                                </div>
                            </div>
                            <button class="attachment-action" onclick="openAttachment('${escapeHtml(fullPath)}')">Ïó¥Í∏∞</button>
                        </div>
                    `;
                }).join('');
                
                listDiv.innerHTML = html;
            } else {
                attachmentsDiv.style.display = 'none';
            }
        }
        
        // Ï≤®Î∂ÄÌååÏùº ÌÉÄÏûÖÎ≥Ñ ÏïÑÏù¥ÏΩò
        function getAttachmentIcon(type) {
            const icons = {
                'image': 'üñºÔ∏è',
                'document': 'üìÑ',
                'data': 'üìä',
                'code': 'üíª',
                'other': 'üìÅ'
            };
            return icons[type] || icons['other'];
        }
        
        // Ï≤®Î∂ÄÌååÏùº Ïó¥Í∏∞
        function openAttachment(path) {
            // Î°úÏª¨ ÌååÏùº Í≤ΩÎ°ú Ï≤òÎ¶¨
            const normalizedPath = path.replace(/\//g, '\\');
            addActivity(`üìé Ï≤®Î∂ÄÌååÏùº Ïó¥Í∏∞: ${path.split(/[/\\]/).pop()}`);
            
            // ÏÉà ÌÉ≠ÏóêÏÑú ÌååÏùº Ïó¥Í∏∞ ÏãúÎèÑ (Î°úÏª¨ ÌååÏùºÏùÄ Ï†úÌïúÏù¥ ÏûàÏùÑ Ïàò ÏûàÏùå)
            window.open('file:///' + normalizedPath, '_blank');
        }

        // Ï∞∏Ï°∞ Î¨∏ÏÑú ÎØ∏Î¶¨Î≥¥Í∏∞ Î†åÎçîÎßÅ
        function renderRefPreview() {
            const container = document.getElementById('selected-refs');
            let html = '';
            
            selectedRefs.forEach((ref, i) => {
                const scorePercent = Math.round(ref.scores.final * 100);
                html += `
                    <div class="ref-item ${replacingIndex === i ? 'replacing' : 'selected'}" 
                         data-index="${i}">
                        <div class="ref-rank">${i + 1}</div>
                        <div class="ref-info" style="cursor: pointer;" onclick="openRefDocumentInNewTab('${escapeHtml(ref.holon_id)}', '${escapeHtml(ref.filename || '')}')">
                            <div class="ref-title">${ref.holon_id}</div>
                            <div class="ref-meta">
                                <span>üìÅ ${ref.type || 'holon'}</span>
                                <span>üìÖ ${ref.age_days}Ïùº Ï†Ñ</span>
                                <span>üëÅ ${ref.access_count || 0}Ìöå</span>
                            </div>
                        </div>
                        <div class="ref-score">
                            <div class="ref-score-bar">
                                <div class="ref-score-fill" style="width: ${scorePercent}%"></div>
                            </div>
                            <div class="ref-score-value">${scorePercent}%</div>
                        </div>
                        <div class="ref-actions" style="display: flex; gap: 0.3rem;">
                            <button class="ref-view-btn" onclick="event.stopPropagation(); openRefDocumentInNewTab('${escapeHtml(ref.holon_id)}', '${escapeHtml(ref.filename || '')}')">
                                üëÅ Î≥¥Í∏∞
                            </button>
                            <button class="ref-replace-btn" onclick="event.stopPropagation(); showReplacementOptions(${i})">
                                üîÑ ÍµêÏ≤¥
                            </button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            document.getElementById('ref-count').textContent = `${selectedRefs.length}Í∞ú ÏÑ†ÌÉù`;
        }
        
        // Ï∞∏Ï°∞ Î¨∏ÏÑúÎ•º ÏÉà ÌÉ≠ÏóêÏÑú Ïó¥Í∏∞
        async function openRefDocumentInNewTab(holonId, filename) {
            addActivity(`üìñ Î¨∏ÏÑú Ïó¥Í∏∞: ${holonId}`);
            
            try {
                // APIÎ•º ÌÜµÌï¥ Î¨∏ÏÑú ÎÇ¥Ïö© Í∞ÄÏ†∏Ïò§Í∏∞
                const res = await fetch(API_BASE + '/api/brain/search', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query: holonId, top_k: 1 })
                });
                const data = await res.json();
                
                if (data.success && data.results && data.results.length > 0) {
                    const doc = data.results.find(d => d.holon_id === holonId) || data.results[0];
                    const filepath = doc.filepath || doc.filename;
                    
                    // Î¨∏ÏÑú ÎÇ¥Ïö© ÏùΩÍ∏∞
                    const contentRes = await fetch(API_BASE + '/api/document/read', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ filepath: filepath })
                    });
                    const contentData = await contentRes.json();
                    
                    if (contentData.success) {
                        // ÏÉà ÌÉ≠ÏóêÏÑú Î¨∏ÏÑú ÌëúÏãú
                        openDocumentViewer(holonId, contentData.content, filepath);
                    } else {
                        alert('Î¨∏ÏÑú ÎÇ¥Ïö©ÏùÑ Î°úÎìúÌï† Ïàò ÏóÜÏäµÎãàÎã§.');
                    }
                } else {
                    alert('Î¨∏ÏÑúÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§: ' + holonId);
                }
            } catch (e) {
                console.error('Î¨∏ÏÑú Ïó¥Í∏∞ Ïã§Ìå®:', e);
                alert('Î¨∏ÏÑú Ïó¥Í∏∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        // ÏÉà Ï∞ΩÏóêÏÑú Î¨∏ÏÑú Î∑∞Ïñ¥ Ïó¥Í∏∞
        function openDocumentViewer(title, content, filepath) {
            const isDark = !document.documentElement.classList.contains('light');
            
            const html = `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>üìÑ ${escapeHtml(title)} - Holarchy</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: ${isDark ? '#0a0a0f' : '#f5f7fa'};
            --bg-card: ${isDark ? '#12121a' : '#ffffff'};
            --border: ${isDark ? '#2a2a3a' : '#d0d7de'};
            --text-primary: ${isDark ? '#e8e8f0' : '#1a1a2e'};
            --text-secondary: ${isDark ? '#8888a0' : '#57606a'};
            --accent-cyan: ${isDark ? '#00d4ff' : '#0891b2'};
            --accent-purple: ${isDark ? '#a855f7' : '#7c3aed'};
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Pretendard', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.7;
        }
        .header {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header h1 {
            font-size: 1.25rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .header .path {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
        }
        .content {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
        }
        pre {
            background: var(--bg-dark);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .json-block {
            background: linear-gradient(135deg, rgba(0,212,255,0.1), rgba(168,85,247,0.1));
            border: 1px solid var(--accent-cyan);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .copy-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            color: #000;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,212,255,0.3);
        }
        .copy-btn:hover { transform: scale(1.05); }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìÑ ${escapeHtml(title)}</h1>
        <div class="path">${escapeHtml(filepath)}</div>
    </div>
    <div class="content">
        <pre>${escapeHtml(content).replace(/(\\x60\\x60\\x60json[\\s\\S]*?\\x60\\x60\\x60)/g, '<div class="json-block">$1</div>')}</pre>
    </div>
    <button class="copy-btn" onclick="copyContent()">üìã Î≥µÏÇ¨</button>
    <scr` + `ipt>
        const docContent = ${JSON.stringify(content)};
        function copyContent() {
            navigator.clipboard.writeText(docContent).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.textContent = '‚úÖ Î≥µÏÇ¨Îê®!';
                setTimeout(() => btn.textContent = 'üìã Î≥µÏÇ¨', 2000);
            });
        }
    </scr` + `ipt>
</bo` + `dy>
</ht` + `ml>`;
            
            const newTab = window.open('', '_blank');
            newTab.document.write(html);
            newTab.document.close();
        }

        // ÎåÄÏ≤¥ Î¨∏ÏÑú ÏòµÏÖò ÌëúÏãú
        async function showReplacementOptions(index) {
            replacingIndex = index;
            renderRefPreview(); // Í∞ïÏ°∞ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
            
            // Ï†ÑÏ≤¥ Î¨∏ÏÑú Î™©Î°ù Í∞ÄÏ†∏Ïò§Í∏∞ (Ïù¥ÎØ∏ ÏóÜÏúºÎ©¥)
            if (allAvailableDocs.length <= selectedRefs.length) {
                try {
                    const res = await fetch(API_BASE + '/api/brain/search', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query: '', top_k: 50 })
                    });
                    const data = await res.json();
                    if (data.success) {
                        allAvailableDocs = data.results;
                    }
                } catch (e) {
                    console.error('Î¨∏ÏÑú Î™©Î°ù Î°úÎìú Ïã§Ìå®:', e);
                }
            }
            
            renderReplacementList('');
            document.getElementById('replacement-panel').style.display = 'block';
            document.getElementById('replacement-search').value = '';
            document.getElementById('replacement-search').focus();
        }

        // ÎåÄÏ≤¥ Î¨∏ÏÑú Î™©Î°ù Î†åÎçîÎßÅ
        function renderReplacementList(filter) {
            const container = document.getElementById('replacement-list');
            const filterLower = filter.toLowerCase();
            
            // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Í≤É Ï†úÏô∏ÌïòÍ≥† ÌïÑÌÑ∞ÎßÅ
            const selectedIds = selectedRefs.map(r => r.holon_id);
            const filtered = allAvailableDocs.filter(doc => 
                !selectedIds.includes(doc.holon_id) &&
                (doc.holon_id.toLowerCase().includes(filterLower) ||
                 doc.filename.toLowerCase().includes(filterLower))
            );
            
            let html = '';
            filtered.slice(0, 20).forEach(doc => {
                const scorePercent = Math.round(doc.scores.final * 100);
                html += `
                    <div class="replacement-item" onclick="replaceDocument('${doc.holon_id}')">
                        <span>üìÑ ${doc.holon_id}</span>
                        <span class="score">${scorePercent}%</span>
                    </div>
                `;
            });
            
            if (filtered.length === 0) {
                html = '<div style="padding: 1rem; text-align: center; color: var(--text-muted);">Í≤ÄÏÉâ Í≤∞Í≥º ÏóÜÏùå</div>';
            }
            
            container.innerHTML = html;
        }

        // ÌïÑÌÑ∞ÎßÅ
        function filterReplacements(value) {
            renderReplacementList(value);
        }

        // Î¨∏ÏÑú ÍµêÏ≤¥
        function replaceDocument(newDocId) {
            const newDoc = allAvailableDocs.find(d => d.holon_id === newDocId);
            if (newDoc && replacingIndex >= 0) {
                selectedRefs[replacingIndex] = newDoc;
                closeReplacementPanel();
                renderRefPreview();
                addActivity(`üîÑ Ï∞∏Ï°∞ Î¨∏ÏÑú ÍµêÏ≤¥: ${newDocId}`);
            }
        }

        // ÎåÄÏ≤¥ Ìå®ÎÑê Îã´Í∏∞
        function closeReplacementPanel() {
            document.getElementById('replacement-panel').style.display = 'none';
            replacingIndex = -1;
            renderRefPreview();
        }

        // ============================================================
        // üìÑ Î¨∏ÏÑú Î∑∞Ïñ¥ Ïú†Ìã∏Î¶¨Ìã∞
        // ============================================================
        
        let currentDocContent = '';  // ÌòÑÏû¨ ÌëúÏãú Ï§ëÏù∏ Î¨∏ÏÑú ÎÇ¥Ïö©
        
        // Î¨∏ÏÑú ÎÇ¥Ïö© Î≥µÏÇ¨
        function copyDocContent() {
            if (currentDocContent) {
                navigator.clipboard.writeText(currentDocContent).then(() => {
                    const btn = document.querySelector('#doc-viewer-inline .doc-viewer-btn');
                    const originalText = btn.textContent;
                    btn.textContent = '‚úÖ Î≥µÏÇ¨Îê®!';
                    setTimeout(() => {
                        btn.textContent = 'üìã Î≥µÏÇ¨';
                    }, 2000);
                }).catch(err => {
                    alert('Î≥µÏÇ¨ Ïã§Ìå®: ' + err);
                });
            }
        }
        
        // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ============================================================
        // Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞
        // ============================================================
        
        // Îç∞Ïù¥ÌÑ∞ (Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏Ïò¥)
        let meetings = [
            { id: 'meeting-2025-001', title: 'MVP Í∏∞Îä• Î≤îÏúÑ ÌöåÏùò', date: '2025-11-29', participants: ['ÍπÄÏ≤†Ïàò', 'Ïù¥ÏòÅÌù¨'], status: 'active' },
            { id: 'meeting-2025-002', title: 'AI ÌäúÌÑ∞ ÌÇ•Ïò§ÌîÑ ÌöåÏùò', date: '2025-11-30', participants: ['ÍπÄÏ≤†Ïàò', 'Ïù¥ÏòÅÌù¨'], status: 'active' }
        ];

        let decisions = [
            { id: 'decision-2025-001', title: 'MVPÎäî ÌïôÏÉù ÏßÑÎã® Í∏∞Îä•Îßå Ìè¨Ìï®', meeting: 'meeting-2025-002', status: 'active' },
            { id: 'decision-2025-003', title: '2Ïõî Îßê Î≤†ÌÉÄ Ï∂úÏãú', meeting: 'meeting-2025-002', status: 'active' },
            { id: 'decision-2025-005', title: 'ÏùºÏ†ï ÎÖºÏùò', meeting: 'meeting-2025-002', status: 'pending' }
        ];

        let tasks = [
            { id: 'task-2025-001', title: 'ÍπÄÏ≤†Ïàò - UI ÎîîÏûêÏù∏', meeting: 'meeting-2025-002', status: 'pending', assignee: 'ÍπÄÏ≤†Ïàò' },
            { id: 'task-2025-003', title: 'Ïù¥ÏòÅÌù¨ - API ÏÑ§Í≥Ñ', meeting: 'meeting-2025-002', status: 'pending', assignee: 'Ïù¥ÏòÅÌù¨' }
        ];

        // ÌÉ≠ Ï†ÑÌôò
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                const tabId = tab.dataset.tab;
                document.querySelectorAll('.meeting-input, .doc-list, .graph-view').forEach(el => {
                    el.classList.remove('active');
                });
                document.getElementById('tab-' + tabId).classList.add('active');
                
                if (tabId === 'graph') renderGraph();
            });
        });

        // ÌÖúÌîåÎ¶ø ÏÇ¨Ïö©
        const templates = {
            basic: `# ÌöåÏùò Ï†úÎ™©

ÏùºÏãú: ${new Date().toISOString().split('T')[0]}
Ï∞∏ÏÑùÏûê: 

## ÏïàÍ±¥
1. 
2. 

## ÎÖºÏùò ÎÇ¥Ïö©


## Í≤∞Ï†ï ÏÇ¨Ìï≠
- Í≤∞Ï†ï: 

## Ìï†Ïùº
- TODO: `,
            standup: `# Ïä§ÌÉ†ÎìúÏóÖ ÎØ∏ÌåÖ

ÏùºÏãú: ${new Date().toISOString().split('T')[0]}
Ï∞∏ÏÑùÏûê: 

## Ïñ¥Ï†ú Ìïú Ïùº


## Ïò§Îäò Ìï† Ïùº
- TODO: 

## Î∏îÎ°úÏª§
`,
            planning: `# Í∏∞Ìöç ÌöåÏùò

ÏùºÏãú: ${new Date().toISOString().split('T')[0]}
Ï∞∏ÏÑùÏûê: 

## Î™©Ìëú


## Î≤îÏúÑ Ï†ïÏùò
- Í≤∞Ï†ï: 

## ÏùºÏ†ï
- Í≤∞Ï†ï: 

## Îã¥ÎãπÏûê Î∞∞Ï†ï
- TODO: `,
            review: `# Î¶¨Î∑∞ ÌöåÏùò

ÏùºÏãú: ${new Date().toISOString().split('T')[0]}
Ï∞∏ÏÑùÏûê: 

## Î¶¨Î∑∞ ÎåÄÏÉÅ


## ÌîºÎìúÎ∞±


## Í≤∞Ï†ï ÏÇ¨Ìï≠
- Í≤∞Ï†ï: 

## ÌõÑÏÜç Ï°∞Ïπò
- TODO: `
        };

        function useTemplate(name) {
            document.getElementById('meeting-content').value = templates[name];
        }

        // API Í∏∞Î≥∏ URL (ÏÑúÎ≤Ñ Ïã§Ìñâ Ïãú)
        const API_BASE = 'http://localhost:5000';
        let useServer = false;

        // ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÌôïÏù∏
        async function checkServer() {
            try {
                const res = await fetch(API_BASE + '/api/stats', { method: 'GET' });
                if (res.ok) {
                    useServer = true;
                    console.log('üî• ÏÑúÎ≤Ñ Ïó∞Í≤∞Îê® - Ïã§Ï†ú ÌååÏùº ÏÉùÏÑ± Î™®Îìú');
                    document.querySelector('.btn-primary').textContent = 'üöÄ ÌååÏã± & Ïã§Ï†ú ÌååÏùº ÏÉùÏÑ± (Í∞ÄÏ§ëÏπò Ï†ÅÏö©)';
                    loadDocuments();
                    loadWeightsFromServer();
                }
            } catch (e) {
                console.log('‚ÑπÔ∏è ÏÑúÎ≤Ñ ÏóÜÏùå - ÏãúÎÆ¨Î†àÏù¥ÏÖò Î™®Îìú');
            }
        }
        checkServer();

        // Î¨∏ÏÑú Î°úÎìú (ÏÑúÎ≤ÑÏóêÏÑú)
        async function loadDocuments() {
            if (!useServer) return;
            try {
                const res = await fetch(API_BASE + '/api/documents');
                const data = await res.json();
                if (data.success) {
                    meetings = data.documents.meetings.map(m => ({
                        id: m.id, title: m.title, date: m.date, status: m.status
                    }));
                    decisions = data.documents.decisions.map(d => ({
                        id: d.id, title: d.title, status: d.status, meeting: d.parent
                    }));
                    tasks = data.documents.tasks.map(t => ({
                        id: t.id, title: t.title, status: t.status, meeting: t.parent
                    }));
                    updateStats();
                    renderLists();
                }
            } catch (e) {
                console.error('Î¨∏ÏÑú Î°úÎìú Ïã§Ìå®:', e);
            }
        }

        // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
        function updateStats() {
            document.getElementById('stat-meetings').textContent = meetings.length;
            document.getElementById('stat-decisions').textContent = decisions.length;
            document.getElementById('stat-tasks').textContent = tasks.length;
            document.getElementById('meeting-count').textContent = meetings.length + 'Í±¥';
            document.getElementById('decision-count').textContent = decisions.length + 'Í±¥';
            document.getElementById('task-count').textContent = tasks.length + 'Í±¥';
            document.getElementById('total-docs').textContent = 10 + meetings.length + decisions.length + tasks.length;
        }

        // Î¶¨Ïä§Ìä∏ Î†åÎçîÎßÅ
        function renderLists() {
            // Meetings
            document.getElementById('meetings-container').innerHTML = meetings.map(m => `
                <div class="doc-item">
                    <div class="doc-icon meeting">üìã</div>
                    <div class="doc-content">
                        <div class="doc-title">${m.title}</div>
                        <div class="doc-meta">
                            <span>${m.date}</span>
                            <span>${m.id}</span>
                        </div>
                    </div>
                    <span class="doc-badge badge-meeting">${m.status}</span>
                </div>
            `).join('');

            // Decisions
            document.getElementById('decisions-container').innerHTML = decisions.map(d => `
                <div class="doc-item">
                    <div class="doc-icon decision">‚úÖ</div>
                    <div class="doc-content">
                        <div class="doc-title">${d.title}</div>
                        <div class="doc-meta">
                            <span>from: ${d.meeting}</span>
                        </div>
                    </div>
                    <span class="doc-badge badge-decision">${d.status}</span>
                </div>
            `).join('');

            // Tasks
            document.getElementById('tasks-container').innerHTML = tasks.map(t => `
                <div class="doc-item">
                    <div class="doc-icon task">‚¨ú</div>
                    <div class="doc-content">
                        <div class="doc-title">${t.title}</div>
                        <div class="doc-meta">
                            <span>from: ${t.meeting}</span>
                        </div>
                    </div>
                    <span class="doc-badge ${t.status === 'done' ? 'badge-done' : 'badge-pending'}">${t.status}</span>
                </div>
            `).join('');
        }

        // Í∑∏ÎûòÌîÑ Î†åÎçîÎßÅ
        function renderGraph() {
            const container = document.getElementById('graph-container');
            const width = container.offsetWidth;
            const height = 500;

            let html = '';
            
            // Root
            html += `<div class="graph-node root" style="left: ${width/2 - 75}px; top: 20px;">üìå hte-doc-000<br><small>Holarchy Root</small></div>`;
            
            // Strategy
            html += `<div class="graph-node" style="left: ${width/2 - 75}px; top: 100px;">üìã strategy-2025-001<br><small>AI PM ÏãúÏä§ÌÖú</small></div>`;
            
            // Meetings
            meetings.forEach((m, i) => {
                const x = 50 + (i * 180);
                html += `<div class="graph-node meeting" style="left: ${x}px; top: 200px;">üìã ${m.id}<br><small>${m.title.substring(0, 15)}...</small></div>`;
            });

            // Decisions
            decisions.forEach((d, i) => {
                const x = 30 + (i * 150);
                html += `<div class="graph-node decision" style="left: ${x}px; top: 320px;">‚úÖ ${d.id}<br><small>${d.title.substring(0, 12)}...</small></div>`;
            });

            // Tasks
            tasks.forEach((t, i) => {
                const x = 80 + (i * 200);
                html += `<div class="graph-node task" style="left: ${x}px; top: 420px;">‚¨ú ${t.id}<br><small>${t.title.substring(0, 12)}...</small></div>`;
            });

            container.innerHTML = html;
        }

        // ÌôúÎèô Ï∂îÍ∞Ä
        function addActivity(text) {
            const container = document.getElementById('activity-container');
            const item = document.createElement('div');
            item.className = 'activity-item animate-in';
            item.innerHTML = `
                <div class="activity-dot new"></div>
                <div>
                    <div class="activity-text">${text}</div>
                    <div class="activity-time">Î∞©Í∏à Ï†Ñ</div>
                </div>
            `;
            container.insertBefore(item, container.firstChild);
        }

        // CLI Î™ÖÎ†π Ïã§Ìñâ (ÏãúÎÆ¨Î†àÏù¥ÏÖò)
        function runCommand(cmd) {
            const output = document.getElementById('cli-output');
            let result = '';
            
            if (cmd === 'check') {
                result = `<div class="cli-line"><span class="cmd">$</span> python _cli.py check</div>
                    <div class="cli-line"><span class="success">üî• Self-Healing ÏôÑÎ£å</span></div>
                    <div class="cli-line"><span class="info">ÌèâÍ∑† Ï†êÏàò: 90%</span></div>`;
            } else if (cmd === 'link') {
                result = `<div class="cli-line"><span class="cmd">$</span> python _cli.py link</div>
                    <div class="cli-line"><span class="success">‚úÖ ÏñëÎ∞©Ìñ• ÎßÅÌÅ¨ ÎèôÍ∏∞Ìôî ÏôÑÎ£å</span></div>`;
            } else if (cmd === 'report') {
                result = `<div class="cli-line"><span class="cmd">$</span> python _cli.py report</div>
                    <div class="cli-line"><span class="info">üìä Ï¥ù Ïù¥Ïäà: 12Í∞ú</span></div>
                    <div class="cli-line"><span class="info">‚ÑπÔ∏è error: 0, warning: 0, info: 12</span></div>`;
            }
            
            output.innerHTML = result + `<div class="cli-line"></div><div class="cli-line"><span class="cmd">$</span> _</div>`;
        }

        // ============================================================
        // üîç Ïù¥Ïäà Î¶¨Î∑∞ ÏãúÏä§ÌÖú
        // ============================================================
        
        async function loadIssueSummary() {
            if (!useServer) return;
            try {
                const res = await fetch(API_BASE + '/api/issues/summary');
                const data = await res.json();
                if (data.success) {
                    document.getElementById('issue-total-count').textContent = data.total;
                    document.getElementById('issue-open-count').textContent = data.by_status.open || 0;
                    document.getElementById('issue-resolved-count').textContent = data.by_status.resolved || 0;
                    document.getElementById('issue-high-count').textContent = data.by_severity.high || 0;
                }
            } catch (e) {
                console.error('Ïù¥Ïäà ÏöîÏïΩ Î°úÎìú Ïã§Ìå®:', e);
            }
        }
        
        async function scanIssues() {
            if (!useServer) {
                alert('ÏÑúÎ≤Ñ Ïó∞Í≤∞ ÌïÑÏöî');
                return;
            }
            
            try {
                document.getElementById('issue-list').innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-secondary);">üîÑ Ïä§Ï∫î Ï§ë...</div>';
                
                const res = await fetch(API_BASE + '/api/issues/scan', { method: 'POST' });
                const data = await res.json();
                
                if (data.success) {
                    addActivity(`üîç Ïù¥Ïäà Ïä§Ï∫î: ${data.new_count}Í∞ú ÏÉà Ïù¥Ïäà Î∞úÍ≤¨`);
                    loadIssueSummary();
                    loadIssues();
                } else {
                    alert('Ïä§Ï∫î Ïã§Ìå®: ' + data.error);
                }
            } catch (e) {
                alert('ÏÑúÎ≤Ñ Ïò§Î•ò: ' + e.message);
            }
        }
        
        async function loadIssues() {
            if (!useServer) return;
            
            const category = document.getElementById('issue-category-filter').value;
            const severity = document.getElementById('issue-severity-filter').value;
            
            try {
                let url = API_BASE + '/api/issues?status=open';
                if (category) url += `&category=${category}`;
                if (severity) url += `&severity=${severity}`;
                
                const res = await fetch(url);
                const data = await res.json();
                
                if (data.success) {
                    renderIssues(data.issues);
                    loadIssueSummary();
                }
            } catch (e) {
                console.error('Ïù¥Ïäà Î°úÎìú Ïã§Ìå®:', e);
            }
        }
        
        function renderIssues(issues) {
            const container = document.getElementById('issue-list');
            
            if (!issues || issues.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-secondary);">‚úÖ Ïó¥Î¶∞ Ïù¥ÏäàÍ∞Ä ÏóÜÏäµÎãàÎã§</div>';
                return;
            }
            
            const severityEmoji = { critical: 'üî¥', high: 'üü†', medium: 'üü°', low: 'üü¢' };
            const categoryEmoji = { placeholder: 'üìù', hardcoded: '‚öôÔ∏è', api_gap: 'üîó', error_handling: '‚ö†Ô∏è', integration: 'üîÑ' };
            
            container.innerHTML = issues.map(issue => `
                <div class="issue-item" style="padding: 0.75rem; margin-bottom: 0.5rem; background: var(--bg-dark); border-radius: 8px; border-left: 3px solid ${issue.severity === 'high' ? 'var(--accent-orange)' : issue.severity === 'medium' ? 'var(--accent-yellow)' : 'var(--accent-green)'};">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem;">
                        <div>
                            <span style="font-size: 0.7rem; color: var(--accent-cyan); font-family: 'JetBrains Mono', monospace;">${issue.id}</span>
                            <span style="font-size: 0.65rem; margin-left: 0.5rem;">${severityEmoji[issue.severity] || '‚ö™'} ${issue.severity}</span>
                            <span style="font-size: 0.65rem; margin-left: 0.5rem;">${categoryEmoji[issue.category] || 'üìÅ'} ${issue.category}</span>
                        </div>
                        <div style="display: flex; gap: 0.25rem;">
                            <button onclick="updateIssue('${issue.id}', 'resolved')" style="padding: 0.2rem 0.4rem; background: var(--accent-green); border: none; border-radius: 4px; color: white; font-size: 0.6rem; cursor: pointer;" title="Ìï¥Í≤∞Îê®">‚úì</button>
                            <button onclick="updateIssue('${issue.id}', 'wontfix')" style="padding: 0.2rem 0.4rem; background: var(--text-secondary); border: none; border-radius: 4px; color: white; font-size: 0.6rem; cursor: pointer;" title="ÏàòÏ†ï ÏïàÌï®">‚úó</button>
                            <button onclick="updateIssue('${issue.id}', 'deferred')" style="padding: 0.2rem 0.4rem; background: var(--accent-blue); border: none; border-radius: 4px; color: white; font-size: 0.6rem; cursor: pointer;" title="Ïó∞Í∏∞">‚è≠</button>
                        </div>
                    </div>
                    <div style="font-size: 0.75rem; color: var(--text); margin-bottom: 0.25rem;">${issue.description}</div>
                    <div style="font-size: 0.65rem; color: var(--text-secondary);">
                        üìÅ ${issue.file}${issue.line ? ':' + issue.line : ''}
                    </div>
                    <div style="font-size: 0.65rem; color: var(--accent-cyan); margin-top: 0.25rem;">
                        üí° ${issue.suggestion}
                    </div>
                </div>
            `).join('');
        }
        
        async function updateIssue(issueId, status) {
            if (!useServer) return;
            
            const note = status === 'wontfix' ? prompt('Ïù¥Ïú†Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (ÏÑ†ÌÉù):') : '';
            
            try {
                const res = await fetch(API_BASE + '/api/issues/update', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ id: issueId, status, note })
                });
                
                const data = await res.json();
                if (data.success) {
                    addActivity(`üìù Ïù¥Ïäà ${issueId} ‚Üí ${status}`);
                    loadIssues();
                } else {
                    alert('ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®: ' + data.error);
                }
            } catch (e) {
                alert('ÏÑúÎ≤Ñ Ïò§Î•ò: ' + e.message);
            }
        }
        
        // ÌïÑÌÑ∞ Î≥ÄÍ≤Ω Ïãú ÏûêÎèô Î°úÎìú
        document.getElementById('issue-category-filter')?.addEventListener('change', loadIssues);
        document.getElementById('issue-severity-filter')?.addEventListener('change', loadIssues);

        // Ï¥àÍ∏∞Ìôî
        updateStats();
        renderLists();
        loadIssueSummary();

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
    </script>
</body>
</html>

