# Strategy Step 1: 오답 패턴 분석 전략

## 목적
오답노트 데이터를 체계적으로 분석하여 학생의 취약 영역과 오류 패턴을 정확히 파악하고, 이를 바탕으로 개선 전략을 수립한다.

---

## 1. 데이터 수집 및 전처리

### 1.1 기본 데이터 수집
```php
// 풀이노트 (status='attempt')
- nstroke: 총 필기량
- usedtime: 소요시간 (초)
- timecreated: 생성 시각
- tlaststroke: 마지막 필기 시각
- contentstitle: 단원/주제 정보
- wboardid: 화이트보드 ID (문제 식별용)

// 준비노트 (status='begin')
- 동일 필드 + 오답 원인 기록 (텍스트 분석 필요)

// 서술평가 (status IN ('exam', 'complete', 'review'))
- 동일 필드 + 정답 여부
```

### 1.2 데이터 검증
- 필수 필드 존재 여부 확인
- 데이터 타입 검증 (nstroke는 정수, usedtime은 초 단위)
- 시간 데이터 일관성 검증 (timecreated <= tlaststroke)
- 이상치 제거 (nstroke < 0, usedtime < 0 등)

### 1.3 데이터 정규화
- 시간 단위 통일 (초 → 분)
- 단원명 정규화 (동일 단원 다른 표기 통일)
- 오답 원인 텍스트 전처리 (키워드 추출 준비)

---

## 2. 오답 원인 분류

### 2.1 자동 분류 (키워드 기반)
```
분류 기준 (error_cause_classification.yaml 참조):

1. 계산 실수 (calculation_error)
   - 키워드: "계산 실수", "계산 잘못", "부호 잘못", "단위 변환"
   - 하위 유형: 부호 실수, 단위 변환 오류, 제곱근 계산 실수 등

2. 개념 오해 (concept_misunderstanding)
   - 키워드: "개념 모름", "이해 안 됨", "모르겠어요", "개념 오해"
   - 하위 유형: 함수 개념 오해, 방정식 개념 오해 등

3. 문제 이해 오류 (problem_understanding_error)
   - 키워드: "문제 이해 못함", "조건 놓침", "요구사항 파악 실패"

4. 공식 오용 (formula_misapplication)
   - 키워드: "공식 잘못", "공식 적용 오류", "공식 조건"

5. 적용 실수 (application_error)
   - 키워드: "풀이 단계", "순서 잘못", "검증 안 함"

6. 부주의한 실수 (careless_mistake)
   - 키워드: "필사 오류", "읽기 오류"
```

### 2.2 수동 분류 (학생/선생님 입력)
- 학생이 직접 선택: 오답 원인 체크리스트
- 선생님이 검토 후 수정: 분류 정확도 향상

### 2.3 분류 정확도 향상
- 단원별 오류 빈도 경험 데이터 활용
- 과거 분류 이력 학습
- 선생님 피드백 반영

---

## 3. 노트 품질 평가

### 3.1 성찰 깊이 (Reflection Depth) 평가
```
점수 산정 기준 (note_quality_standards.yaml 참조):

9-10점: 매우 우수
- 오답 원인을 매우 구체적으로 분석
- 왜 틀렸는지 심층 분석
- 다음에 반복하지 않기 위한 구체적 방법 제시
- 유사한 문제에서 적용할 수 있는 전략 기록

7-8점: 우수
- 오답 원인을 한 문장으로 기록
- 왜 틀렸는지 간단히 분석
- 개선 의지 표현

5-6점: 보통
- 오답 원인을 단어나 짧은 구로 기록
- 분석 없이 사실만 기록

3-4점: 미흡
- 오답 원인 기록이 매우 짧거나 형식적
- 구체적 내용 없음

1-2점: 매우 미흡
- 오답 원인 기록 없음
```

### 3.2 완성도 (Completeness) 평가
```
9-10점: 매우 우수
- 풀이 과정, 해설 이해, 오답 원인, 개선 방법이 모두 완전하게 기록

7-8점: 우수
- 주요 요소들이 기록되어 있으나 일부 부족

5-6점: 보통
- 기본 요소만 기록

3-4점: 미흡
- 기록이 매우 불완전

1-2점: 매우 미흡
- 기록이 거의 없음
```

### 3.3 효율성 (Efficiency) 평가
```
효율성 점수 = (reflection_score + completeness_score) / (usedtime / 60) * weight

- 시간은 적게 사용했으나 성찰 깊이와 완성도가 높음 → 높은 점수
- 시간은 많이 쓰나 효과는 낮음 → 낮은 점수
```

### 3.4 일관성 (Consistency) 평가
```
최근 5개 노트의 품질 점수 표준편차 계산
- 표준편차가 낮으면 일관성 높음 (높은 점수)
- 표준편차가 높으면 일관성 낮음 (낮은 점수)
```

---

## 4. 단원별 패턴 분석

### 4.1 단원별 오답 빈도 계산
```
단원별 오답률 = (해당 단원 오답 수 / 해당 단원 전체 문제 수) * 100

우선순위 산정:
1. 오답률이 높은 단원
2. 오답 수가 많은 단원
3. 최근 오답이 많은 단원
```

### 4.2 단원-오류 유형 매트릭스 분석
```
각 단원별로 어떤 오류 유형이 가장 많은지 분석

예시:
- 함수 단원: 개념 오해 50%, 계산 실수 25%, 적용 실수 15%, 문제 이해 오류 10%
- 통계 단원: 계산 실수 40%, 문제 이해 오류 30%, 개념 오해 20%, 적용 실수 10%
```

### 4.3 단원별 노트 품질 분석
```
각 단원별 평균 reflection_score와 completeness_score 계산
- 점수가 낮은 단원은 이해도가 낮거나 학습 의지가 낮은 신호
```

---

## 5. 반복 오류 패턴 감지

### 5.1 동일 문제 반복 오류
```
- 문제 ID(wboardid) 기반 추적
- 동일 문제를 여러 번 틀렸는지 확인
- 재풀이 시 정답 전환 여부 확인
```

### 5.2 동일 유형 반복 오류
```
- 문제 유형 분류 (기본형, 유형, 심화)
- 동일 유형 문제에서 반복 오류 발생 여부 확인
```

### 5.3 동일 원인 반복 오류
```
- 오답 원인 분류 기반 추적
- 동일 오류 원인이 반복되는지 확인
- 습관적 오류 가능성 평가
```

### 5.4 시계열 패턴 분석
```
- 시간에 따른 오류 패턴 변화 추적
- 개선 추세 vs 악화 추세 판단
- 주기적 패턴 발견 (예: 월요일 오답률 높음)
```

---

## 6. 집중력 및 몰입도 분석

### 6.1 필기 밀도 분석
```
필기 밀도 = nstroke / (usedtime / 60)  // 분당 필기량

- 밀도가 낮으면: 집중력 저하 의심
- 밀도가 높으면: 집중력 양호
- 밀도가 너무 높으면: 무리한 시도 의심
```

### 6.2 몰입 단절 시점 분석
```
몰입 지속 시간 = tlaststroke - timecreated

- 몰입 지속 시간이 짧으면: 초반 집중력 저하
- 몰입 지속 시간이 길지만 필기량이 적으면: 중반 이후 집중력 저하
```

### 6.3 침착도 데이터 연계 분석
```
- 침착도가 낮은 시점과 집중력 저하 시점 상관관계 분석
- 침착도 개선 전략과 연계
```

---

## 7. 시그니처 루틴 추정

### 7.1 패턴 일관성 분석
```
최근 5개 노트의 다음 지표 일관성 분석:
- usedtime 패턴
- reflection_score 패턴
- completeness_score 패턴
- 오답 원인 분포 패턴

일관성이 높으면: 시그니처 루틴 형성 가능성 높음
일관성이 낮으면: 루틴 형성 미흡
```

### 7.2 루틴 안정성 평가
```
루틴 안정성 점수 = (1 - 표준편차 / 평균) * 100

- 안정성 점수가 높으면: 루틴 안정화됨
- 안정성 점수가 낮으면: 루틴 불안정
```

### 7.3 루틴 단계 분류
```
1. 형성 단계: 패턴이 나타나기 시작
2. 안정화 단계: 패턴이 일관되게 유지
3. 전환 단계: 다음 단계로 넘어갈 준비
```

---

## 8. 분석 결과 종합 및 리포트 생성

### 8.1 취약 영역 식별
```
우선순위 기반 취약 영역:
1. 오답률이 높은 단원 (Top 3)
2. 반복 오류가 많은 단원
3. 노트 품질이 낮은 단원
```

### 8.2 개선 필요 영역 식별
```
1. 노트 품질 개선 필요 (reflection_score < 5 또는 completeness_score < 5)
2. 집중력 개선 필요 (필기 밀도 낮음)
3. 오류 원인별 개선 필요 (특정 오류 원인 반복)
```

### 8.3 리포트 생성
```
1. 학생용 리포트: 개인화된 피드백 및 개선 제안
2. 교사용 리포트: 요약 카드 형태로 핵심 정보 제공
3. 부모용 리포트: (필요시) 학습 현황 요약
```

---

## 9. 데이터 기반 의사결정

### 9.1 우선순위 결정 기준
```
1. 긴급도: 오답률이 매우 높고 최근 증가 추세
2. 중요도: 시험 범위에 포함되는 단원
3. 개선 가능성: 노트 품질이 낮아 개선 여지가 있음
```

### 9.2 개입 시점 결정
```
- 즉시 개입: 노트 품질이 매우 낮고 오답률이 높음
- 주간 개입: 주간 리포트 기준으로 개선 필요
- 월간 개입: 장기 추세 분석 결과 개선 필요
```

---

## 10. 지속적 개선

### 10.1 분석 정확도 향상
```
- 선생님 피드백 수집 및 반영
- 분류 오류 수정 및 학습
- 평가 기준 세밀화
```

### 10.2 데이터 품질 향상
```
- 데이터 수집 프로세스 개선
- 학생/선생님 입력 가이드 제공
- 자동화 수준 향상
```

---

## 참고 자료
- `error_cause_classification.yaml`: 오답 원인 분류 체계
- `note_quality_standards.yaml`: 노트 품질 평가 기준
- `math_unit_relations.yaml`: 수학 단원 연계성 데이터 (agent02 참조)

