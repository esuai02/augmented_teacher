<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent System Demo - ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ ë°ëª¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        .demo-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .demo-section h2 {
            color: #764ba2;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }
        
        .result-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
            white-space: pre-wrap;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-active { background: #28a745; }
        .status-inactive { background: #dc3545; }
        .status-pending { background: #ffc107; }
        
        .agent-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #eee;
        }
        
        .agent-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .agent-card .description {
            color: #666;
            font-size: 14px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            font-weight: 600;
        }
        
        .loading.show {
            display: block;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Agent System Demo</h1>
            <p>MD íŒŒì¼ ê¸°ë°˜ ì§€ëŠ¥í˜• ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ ë°ëª¨</p>
        </div>
        
        <div class="grid">
            <!-- ì‚¬ìš©ì ë°ì´í„° ì…ë ¥ -->
            <div class="demo-section">
                <h2>ğŸ‘¤ ì‚¬ìš©ì ë°ì´í„°</h2>
                <div class="input-group">
                    <label>ì‚¬ìš©ì ID</label>
                    <input type="text" id="userId" value="demo_user" placeholder="ì‚¬ìš©ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="input-group">
                    <label>í˜„ì¬ ì ìˆ˜</label>
                    <input type="number" id="currentScore" value="75" placeholder="0-100">
                </div>
                <div class="input-group">
                    <label>ì·¨ì•½ ì˜ì—­</label>
                    <input type="text" id="weakAreas" value="í™•ë¥ ,ìˆ˜ì—´" placeholder="ì‰¼í‘œë¡œ êµ¬ë¶„">
                </div>
                <div class="input-group">
                    <label>í•™ìŠµ íŒ¨í„´</label>
                    <select id="studyPattern">
                        <option value="visual">ì‹œê°í˜•</option>
                        <option value="auditory">ì²­ê°í˜•</option>
                        <option value="kinesthetic">ì‹¤ìŠµí˜•</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>ì‹œí—˜ì¼ (ì„ íƒ)</label>
                    <input type="date" id="examDate">
                </div>
                <div class="input-group">
                    <label>ë™ê¸° ìˆ˜ì¤€ (0-1)</label>
                    <input type="number" id="motivationLevel" value="0.7" step="0.1" min="0" max="1">
                </div>
                <div class="input-group">
                    <label>ììœ¨ì„± ìˆ˜ì¤€ (0-1)</label>
                    <input type="number" id="autonomyRate" value="0.6" step="0.1" min="0" max="1">
                </div>
            </div>
            
            <!-- ì‹œìŠ¤í…œ ìƒíƒœ -->
            <div class="demo-section">
                <h2>âš¡ ì‹œìŠ¤í…œ ìƒíƒœ</h2>
                <button class="btn" onclick="getSystemStatus()">ìƒíƒœ í™•ì¸</button>
                <button class="btn" onclick="getAvailableAgents()">ì‚¬ìš© ê°€ëŠ¥í•œ ì—ì´ì „íŠ¸</button>
                <button class="btn btn-secondary" onclick="cleanupSystem()">ì‹œìŠ¤í…œ ì •ë¦¬</button>
                <div id="systemStatus" class="result-box" style="display: none;"></div>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ¯ ì—ì´ì „íŠ¸ ì¶”ì²œ</h2>
            <button class="btn" onclick="getRecommendation()">ì¶”ì²œ ë°›ê¸°</button>
            <div class="loading" id="recommendLoading">ì¶”ì²œì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>
            <div id="recommendation" class="result-box" style="display: none;"></div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸš€ ì—ì´ì „íŠ¸ ì‹¤í–‰</h2>
            <div class="input-group">
                <label>ì—ì´ì „íŠ¸ ëª¨ë“œ</label>
                <select id="agentMode">
                    <option value="curriculumcentered">ğŸ“š ì²´ê³„ì  ì§„ë„í˜•</option>
                    <option value="examcentered">âœï¸ ì„±ê³¼ ì§‘ì¤‘í˜•</option>
                    <option value="adaptationcentered">ğŸ¯ ê°œì¸ ë§ì¶¤í˜•</option>
                    <option value="missioncentered">âš¡ ëª©í‘œ ë‹¬ì„±í˜•</option>
                    <option value="reflectioncentered">ğŸ§  ì‚¬ê³ ë ¥ ì¤‘ì‹¬í˜•</option>
                    <option value="selfdriven">ğŸš€ ììœ¨í•™ìŠµí˜•</option>
                    <option value="apprentice">ğŸ” ì¸ì§€ì  ë„ì œí˜•</option>
                    <option value="curiositycentered">ğŸ”­ í˜¸ê¸°ì‹¬ ì¤‘ì‹¬í˜•</option>
                    <option value="timecentered">ğŸ•’ ì‹œê°„ í”¼ë“œë°±í˜•</option>
                </select>
            </div>
            <button class="btn" onclick="startAgent()">ì—ì´ì „íŠ¸ ì‹œì‘</button>
            <button class="btn" onclick="executeAgent()">ì‹¤í–‰</button>
            <button class="btn btn-secondary" onclick="stopAgent()">ì¤‘ì§€</button>
            
            <div class="input-group" style="margin-top: 20px;">
                <label>ì‹¤í–‰ ì…ë ¥ (JSON)</label>
                <textarea id="executionInput" rows="3" placeholder='{"action": "analyze", "focus": "progress"}'></textarea>
            </div>
            
            <div class="loading" id="agentLoading">ì—ì´ì „íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>
            <div id="agentResult" class="result-box" style="display: none;"></div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ”„ ì—ì´ì „íŠ¸ ë¸”ë Œë”©</h2>
            <div class="input-group">
                <label>ë¸”ë Œë”©í•  ëª¨ë“œë“¤ (Ctrl+Clickìœ¼ë¡œ ë‹¤ì¤‘ ì„ íƒ)</label>
                <select id="blendModes" multiple size="5">
                    <option value="curriculumcentered">ğŸ“š ì²´ê³„ì  ì§„ë„í˜•</option>
                    <option value="examcentered">âœï¸ ì„±ê³¼ ì§‘ì¤‘í˜•</option>
                    <option value="adaptationcentered">ğŸ¯ ê°œì¸ ë§ì¶¤í˜•</option>
                    <option value="missioncentered">âš¡ ëª©í‘œ ë‹¬ì„±í˜•</option>
                    <option value="apprentice">ğŸ” ì¸ì§€ì  ë„ì œí˜•</option>
                </select>
            </div>
            <div class="input-group">
                <label>ìƒí™© ì„¤ëª…</label>
                <input type="text" id="situation" placeholder="ì˜ˆ: ì‹œí—˜ ì„ë°•, ê¸°ì´ˆ ë¶€ì¡±, ë™ê¸° ì €í•˜">
            </div>
            <button class="btn" onclick="blendAgents()">ë¸”ë Œë”© ì‹¤í–‰</button>
            <div id="blendResult" class="result-box" style="display: none;"></div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ”§ ì—ì´ì „íŠ¸ ê²€ì¦</h2>
            <div class="input-group">
                <label>ê²€ì¦í•  ëª¨ë“œ</label>
                <select id="validateMode">
                    <option value="curriculumcentered">ğŸ“š ì²´ê³„ì  ì§„ë„í˜•</option>
                    <option value="examcentered">âœï¸ ì„±ê³¼ ì§‘ì¤‘í˜•</option>
                    <option value="adaptationcentered">ğŸ¯ ê°œì¸ ë§ì¶¤í˜•</option>
                </select>
            </div>
            <button class="btn" onclick="validateAgent()">ê²€ì¦í•˜ê¸°</button>
            <div id="validateResult" class="result-box" style="display: none;"></div>
        </div>
    </div>

    <script>
        let currentAgentId = null;
        const API_BASE = 'api.php';

        // API í˜¸ì¶œ í—¬í¼
        async function apiCall(endpoint, data = null) {
            const options = {
                method: data ? 'POST' : 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            };
            
            if (data) {
                options.body = JSON.stringify(data);
            }
            
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, options);
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        // ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì§‘
        function getUserData() {
            return {
                user_id: document.getElementById('userId').value,
                current_score: parseInt(document.getElementById('currentScore').value),
                weak_areas: document.getElementById('weakAreas').value.split(',').map(s => s.trim()),
                study_pattern: document.getElementById('studyPattern').value,
                exam_date: document.getElementById('examDate').value,
                motivation_level: parseFloat(document.getElementById('motivationLevel').value),
                autonomy_rate: parseFloat(document.getElementById('autonomyRate').value)
            };
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result-box ${isError ? 'error' : 'success'}`;
            element.textContent = JSON.stringify(data, null, 2);
        }

        // ë¡œë”© í‘œì‹œ/ìˆ¨ê¹€
        function toggleLoading(elementId, show = true) {
            const element = document.getElementById(elementId);
            if (element) {
                element.classList.toggle('show', show);
            }
        }

        // ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
        async function getSystemStatus() {
            try {
                const result = await apiCall('/status');
                showResult('systemStatus', result);
            } catch (error) {
                showResult('systemStatus', {error: error.message}, true);
            }
        }

        // ì‚¬ìš© ê°€ëŠ¥í•œ ì—ì´ì „íŠ¸ ì¡°íšŒ
        async function getAvailableAgents() {
            try {
                const result = await apiCall('/agents');
                showResult('systemStatus', result);
            } catch (error) {
                showResult('systemStatus', {error: error.message}, true);
            }
        }

        // ì‹œìŠ¤í…œ ì •ë¦¬
        async function cleanupSystem() {
            try {
                const result = await apiCall('/cleanup', {});
                showResult('systemStatus', result);
            } catch (error) {
                showResult('systemStatus', {error: error.message}, true);
            }
        }

        // ì—ì´ì „íŠ¸ ì¶”ì²œ
        async function getRecommendation() {
            toggleLoading('recommendLoading', true);
            try {
                const userData = getUserData();
                const result = await apiCall('/agents/recommend', {user_data: userData});
                showResult('recommendation', result);
            } catch (error) {
                showResult('recommendation', {error: error.message}, true);
            } finally {
                toggleLoading('recommendLoading', false);
            }
        }

        // ì—ì´ì „íŠ¸ ì‹œì‘
        async function startAgent() {
            toggleLoading('agentLoading', true);
            try {
                const userData = getUserData();
                const mode = document.getElementById('agentMode').value;
                
                const result = await apiCall('/agents/start', {
                    mode: mode,
                    user_id: userData.user_id,
                    user_data: userData
                });
                
                if (result.success && result.data.agent_id) {
                    currentAgentId = result.data.agent_id;
                }
                
                showResult('agentResult', result);
            } catch (error) {
                showResult('agentResult', {error: error.message}, true);
            } finally {
                toggleLoading('agentLoading', false);
            }
        }

        // ì—ì´ì „íŠ¸ ì‹¤í–‰
        async function executeAgent() {
            if (!currentAgentId) {
                showResult('agentResult', {error: 'ë¨¼ì € ì—ì´ì „íŠ¸ë¥¼ ì‹œì‘í•´ì£¼ì„¸ìš”'}, true);
                return;
            }
            
            toggleLoading('agentLoading', true);
            try {
                let input = null;
                const inputText = document.getElementById('executionInput').value.trim();
                if (inputText) {
                    try {
                        input = JSON.parse(inputText);
                    } catch (e) {
                        throw new Error('ì…ë ¥ JSONì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤: ' + e.message);
                    }
                }
                
                const result = await apiCall('/agents/execute', {
                    agent_id: currentAgentId,
                    input: input
                });
                
                showResult('agentResult', result);
            } catch (error) {
                showResult('agentResult', {error: error.message}, true);
            } finally {
                toggleLoading('agentLoading', false);
            }
        }

        // ì—ì´ì „íŠ¸ ì¤‘ì§€
        async function stopAgent() {
            if (!currentAgentId) {
                showResult('agentResult', {error: 'ì‹¤í–‰ ì¤‘ì¸ ì—ì´ì „íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤'}, true);
                return;
            }
            
            try {
                const result = await apiCall('/agents/stop', {
                    agent_id: currentAgentId
                });
                
                currentAgentId = null;
                showResult('agentResult', result);
            } catch (error) {
                showResult('agentResult', {error: error.message}, true);
            }
        }

        // ì—ì´ì „íŠ¸ ë¸”ë Œë”©
        async function blendAgents() {
            try {
                const userData = getUserData();
                const modeSelect = document.getElementById('blendModes');
                const selectedModes = Array.from(modeSelect.selectedOptions).map(option => option.value);
                const situation = document.getElementById('situation').value;
                
                if (selectedModes.length < 2) {
                    showResult('blendResult', {error: 'ìµœì†Œ 2ê°œ ëª¨ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”'}, true);
                    return;
                }
                
                const result = await apiCall('/agents/blend', {
                    modes: selectedModes,
                    situation: situation,
                    user_id: userData.user_id,
                    user_data: userData
                });
                
                showResult('blendResult', result);
            } catch (error) {
                showResult('blendResult', {error: error.message}, true);
            }
        }

        // ì—ì´ì „íŠ¸ ê²€ì¦
        async function validateAgent() {
            try {
                const mode = document.getElementById('validateMode').value;
                
                const result = await apiCall('/agents/validate', {
                    mode: mode
                });
                
                showResult('validateResult', result);
            } catch (error) {
                showResult('validateResult', {error: error.message}, true);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì˜¤ëŠ˜ë¶€í„° 30ì¼ í›„ë¥¼ ê¸°ë³¸ ì‹œí—˜ì¼ë¡œ ì„¤ì •
            const examDate = new Date();
            examDate.setDate(examDate.getDate() + 30);
            document.getElementById('examDate').value = examDate.toISOString().split('T')[0];
            
            // ì´ˆê¸° ìƒíƒœ í™•ì¸
            getSystemStatus();
        });
    </script>
</body>
</html>