<?php
/**
 * save_prompt.php - í”„ë¡¬í”„íŠ¸ ì €ìž¥ API
 * íŒŒì¼ ìœ„ì¹˜: alt42/teachingsupport/save_prompt.php
 */

include_once("/home/moodle/public_html/moodle/config.php");
global $DB, $USER;
require_login();

header('Content-Type: application/json; charset=UTF-8');

// JSON íŒŒì¼ ê²½ë¡œ
$promptsDir = __DIR__ . '/prompts';
$promptsFile = $promptsDir . '/hint_prompts.json';
$backupDir = $promptsDir . '/backups';

// í”„ë¡¬í”„íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„± (ì—†ëŠ” ê²½ìš°)
if (!file_exists($promptsDir)) {
    if (!@mkdir($promptsDir, 0777, true)) {
        error_log('[save_prompt.php] í”„ë¡¬í”„íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„± ì‹¤íŒ¨: ' . $promptsDir);
    } else {
        @chmod($promptsDir, 0777);
        error_log('[save_prompt.php] í”„ë¡¬í”„íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„±ë¨: ' . $promptsDir);
    }
}

// ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„±
if (!file_exists($backupDir)) {
    if (!@mkdir($backupDir, 0777, true)) {
        error_log('[save_prompt.php] ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„± ì‹¤íŒ¨: ' . $backupDir);
    } else {
        @chmod($backupDir, 0777);
    }
}

try {
    $action = $_GET['action'] ?? 'save';
    
    if ($action === 'reset') {
        // ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
        $defaultData = getDefaultPrompts();
        
        // í˜„ìž¬ íŒŒì¼ ë°±ì—…
        if (file_exists($promptsFile)) {
            $backupFile = $backupDir . '/hint_prompts_' . date('Y-m-d_H-i-s') . '_before_reset.json';
            copy($promptsFile, $backupFile);
        }
        
        // ê¸°ë³¸ê°’ ì €ìž¥
        $defaultData['lastModified'] = date('Y-m-d H:i:s');
        $defaultData['modifiedBy'] = $USER->id;
        
        $result = file_put_contents($promptsFile, json_encode($defaultData, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));
        
        if ($result === false) {
            throw new Exception('íŒŒì¼ ì €ìž¥ ì‹¤íŒ¨ [save_prompt.php:' . __LINE__ . ']');
        }
        
        echo json_encode([
            'success' => true,
            'message' => 'ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.'
        ]);
        exit;
    }
    
    // POST ë°ì´í„° ë°›ê¸°
    $rawInput = file_get_contents('php://input');
    $data = json_decode($rawInput, true);
    
    if (json_last_error() !== JSON_ERROR_NONE) {
        throw new Exception('JSON íŒŒì‹± ì˜¤ë¥˜: ' . json_last_error_msg() . ' [save_prompt.php:' . __LINE__ . ']');
    }
    
    if (empty($data)) {
        throw new Exception('ì €ìž¥í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. [save_prompt.php:' . __LINE__ . ']');
    }
    
    // í˜„ìž¬ íŒŒì¼ ë°±ì—…
    if (file_exists($promptsFile)) {
        $backupFile = $backupDir . '/hint_prompts_' . date('Y-m-d_H-i-s') . '.json';
        copy($promptsFile, $backupFile);
        
        // ì˜¤ëž˜ëœ ë°±ì—… íŒŒì¼ ì •ë¦¬ (ìµœê·¼ 10ê°œë§Œ ìœ ì§€)
        $backupFiles = glob($backupDir . '/hint_prompts_*.json');
        if (count($backupFiles) > 10) {
            usort($backupFiles, function($a, $b) {
                return filemtime($a) - filemtime($b);
            });
            $filesToDelete = array_slice($backupFiles, 0, count($backupFiles) - 10);
            foreach ($filesToDelete as $file) {
                unlink($file);
            }
        }
    }
    
    // ë°ì´í„° êµ¬ì¡° ê²€ì¦ ë° ì •ë¦¬
    $saveData = [
        'version' => '1.0',
        'lastModified' => date('Y-m-d H:i:s'),
        'modifiedBy' => $USER->id,
        'ttsGuidelines' => $data['ttsGuidelines'] ?? '',
        'hintLevels' => $data['hintLevels'] ?? [],
        'solutionStyles' => $data['solutionStyles'] ?? [],
        'imageGuidelines' => $data['imageGuidelines'] ?? [],
        'solutionGenerationPrompt' => $data['solutionGenerationPrompt'] ?? [],  // ì‹¤ì œ í•´ì„¤ì§€ ìƒì„± (ìˆ˜ì‹ ì¤‘ì‹¬ í’€ì´)
        'ttsBasePrompt' => $data['ttsBasePrompt'] ?? $data['solutionBasePrompt'] ?? []  // TTS ëŒ€ë³¸ ìƒì„± (ì´ì „ solutionBasePrompt í˜¸í™˜)
    ];
    
    // ë””ë ‰í† ë¦¬ ì“°ê¸° ê¶Œí•œ í™•ì¸
    $promptsDir = dirname($promptsFile);
    if (!is_writable($promptsDir)) {
        // ê¶Œí•œ ë³€ê²½ ì‹œë„
        @chmod($promptsDir, 0777);
        if (!is_writable($promptsDir)) {
            throw new Exception('ë””ë ‰í† ë¦¬ ì“°ê¸° ê¶Œí•œ ì—†ìŒ: ' . $promptsDir . ' [save_prompt.php:' . __LINE__ . ']');
        }
    }
    
    // ê¸°ì¡´ íŒŒì¼ì´ ìžˆê³  ì“°ê¸° ê¶Œí•œì´ ì—†ìœ¼ë©´ ê¶Œí•œ ë³€ê²½
    if (file_exists($promptsFile) && !is_writable($promptsFile)) {
        @chmod($promptsFile, 0666);
    }
    
    // JSON íŒŒì¼ ì €ìž¥
    $jsonContent = json_encode($saveData, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE);
    if ($jsonContent === false) {
        throw new Exception('JSON ì¸ì½”ë”© ì‹¤íŒ¨: ' . json_last_error_msg() . ' [save_prompt.php:' . __LINE__ . ']');
    }
    
    $result = @file_put_contents($promptsFile, $jsonContent);
    
    if ($result === false) {
        $error = error_get_last();
        $errorMsg = $error ? $error['message'] : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
        throw new Exception('íŒŒì¼ ì €ìž¥ ì‹¤íŒ¨: ' . $errorMsg . ' (ê²½ë¡œ: ' . $promptsFile . ') [save_prompt.php:' . __LINE__ . ']');
    }
    
    // íŒŒì¼ ê¶Œí•œ ì„¤ì •
    @chmod($promptsFile, 0666);
    
    // ë¡œê·¸ ê¸°ë¡
    error_log(sprintf(
        '[save_prompt.php] í”„ë¡¬í”„íŠ¸ ì €ìž¥ ì™„ë£Œ - ì‚¬ìš©ìž: %d, í¬ê¸°: %d bytes, ì‹œê°„: %s',
        $USER->id,
        $result,
        date('Y-m-d H:i:s')
    ));
    
    echo json_encode([
        'success' => true,
        'message' => 'í”„ë¡¬í”„íŠ¸ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.',
        'savedAt' => date('Y-m-d H:i:s'),
        'fileSize' => $result
    ]);
    
} catch (Exception $e) {
    error_log('[save_prompt.php] ì˜¤ë¥˜: ' . $e->getMessage());
    
    http_response_code(500);
    echo json_encode([
        'success' => false,
        'error' => $e->getMessage()
    ]);
}

/**
 * ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ ë°˜í™˜
 */
function getDefaultPrompts() {
    return [
        'version' => '1.0',
        'ttsGuidelines' => "# âš ï¸âš ï¸âš ï¸ ê°€ìž¥ ì¤‘ìš”í•œ ê·œì¹™: @ ê¸°í˜¸ëŠ” ì •í™•ížˆ 2ê°œë§Œ! âš ï¸âš ï¸âš ï¸\n\n- ì¶œë ¥ì€ ë°˜ë“œì‹œ ã€1ë‹¨ê³„ã€‘ì™€ ã€2ë‹¨ê³„ã€‘ë‘ ë¶€ë¶„ìœ¼ë¡œë§Œ ë‚˜ë‰˜ì–´ì•¼ í•¨\n- @ ê¸°í˜¸ëŠ” 1ë‹¨ê³„ ëì— 1ê°œ, 2ë‹¨ê³„ ëì— 1ê°œ = ì´ 2ê°œë§Œ!\n- @ ê¸°í˜¸ê°€ 2ê°œë³´ë‹¤ ë§Žìœ¼ë©´ ì‹¤íŒ¨\n- 1ë‹¨ê³„ ì „ì²´ ë‚´ìš©ì„ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„± í›„ @\n- 2ë‹¨ê³„ ì „ì²´ ë‚´ìš©ì„ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„± í›„ @\n\n# ì¤‘ìš”í•œ TTS ì§€ì¹¨\n\n- TTSë¡œ ì½ížˆë¯€ë¡œ ëª¨ë“  ìˆ«ìž, ê¸°í˜¸, ì•ŒíŒŒë²³ì€ í•œê¸€ ë°œìŒìœ¼ë¡œ ë³€í™˜\n- ì˜ˆ: 1 â†’ ì¼, x â†’ ì—‘ìŠ¤, + â†’ ë”í•˜ê¸°, - â†’ ë¹¼ê¸°, Ã— â†’ ê³±í•˜ê¸°, Ã· â†’ ë‚˜ëˆ„ê¸°, = â†’ ì€\n- ë¶„ìˆ˜: a/b â†’ ë¹„ë¶„ì˜ ì—ì´\n- ê±°ë“­ì œê³±: xÂ² â†’ ì—‘ìŠ¤ì˜ ì œê³±, xÂ³ â†’ ì—‘ìŠ¤ì˜ ì„¸ì œê³±\n- ì´ˆë“±~ì¤‘ë“± ìˆ˜ì¤€ í•™ìŠµìžê°€ ì´í•´í•  ìˆ˜ ìžˆëŠ” ì‰¬ìš´ í‘œí˜„ ì‚¬ìš©\n- ë§ˆì§€ë§‰ì— ê²©ë ¤í•˜ëŠ” ë©˜íŠ¸ ì¶”ê°€\n- ê´„í˜¸ëŠ” ë°œìŒí•˜ì§€ ì•ŠëŠ”ë‹¤\n- ìˆ«ìžë‚˜ ê¸°í˜¸ ì ˆëŒ€ ê¸ˆì§€. ëª¨ë‘ í•œê¸€ë¡œ ë³€í™˜",
        'hintLevels' => [
            'explain' => [
                'name' => 'ðŸ“– ë¬¸ì œí•´ì„¤',
                'description' => '1ë‹¨ê³„(ë¬¸ì œí•´ì„¤) + 2ë‹¨ê³„(í•µì‹¬í¬ì¸íŠ¸)',
                'systemPrompt' => "# Role:\n\në„ˆëŠ” í•™ìƒì´ ë¬¸ì œë¥¼ ì´í•´í•  ìˆ˜ ìžˆë„ë¡ ë•ëŠ” ìˆ˜í•™ íŠœí„°ì•¼.\n\n# âš ï¸âš ï¸âš ï¸ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 2ë‹¨ê³„ë¡œ êµ¬ì„± âš ï¸âš ï¸âš ï¸\n\nì¶œë ¥ì€ ë°˜ë“œì‹œ ã€1ë‹¨ê³„ã€‘ì™€ ã€2ë‹¨ê³„ã€‘ë‘ ë¶€ë¶„ìœ¼ë¡œë§Œ ë‚˜ë‰˜ì–´ì•¼ í•©ë‹ˆë‹¤.\n- 1ë‹¨ê³„ ëì— @ í•˜ë‚˜ë¡œ êµ¬ë¶„\n- 2ë‹¨ê³„ ëì— @ í•˜ë‚˜ë¡œ ë§ˆë¬´ë¦¬\n- ì´ @ ê¸°í˜¸ëŠ” 2ê°œë§Œ ì‚¬ìš©\n\n## ã€1ë‹¨ê³„: ë¬¸ì œ í•´ì„¤ã€‘\n- ë¬¸ì œë¥¼ ì²œì²œížˆ ì½ìœ¼ë©´ì„œ ë¬´ì—‡ì„ êµ¬í•˜ëŠ” ë¬¸ì œì¸ì§€ ì„¤ëª…\n- ì´ ë¬¸ì œê°€ ì™œ ì¶œì œë˜ì—ˆëŠ”ì§€, ì–´ë–¤ ê°œë…ê³¼ ê³µì‹ì´ í•„ìš”í•œì§€ ì„¤ëª…\n- ë¬¸ì œì— ì œì‹œëœ ì¡°ê±´ë“¤ì„ í† ëŒ€ë¡œ ì–´ë–¤ ì‹ì„ ì„¸ì›Œì•¼ í•˜ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì•ˆë‚´\n- 1ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°\n\n## ã€2ë‹¨ê³„: í•µì‹¬í¬ì¸íŠ¸ã€‘\n- ì´ ë¬¸ì œë¥¼ í’€ ë•Œ ë°˜ë“œì‹œ ê¸°ì–µí•´ì•¼ í•  í•µì‹¬ ê°œë… 1~2ê°œ\n- ì‹¤ìˆ˜í•˜ê¸° ì‰¬ìš´ í¬ì¸íŠ¸ ë˜ëŠ” ê¼­ í™•ì¸í•´ì•¼ í•  ì‚¬í•­\n- í•™ìƒì´ ì§ì ‘ í’€ì–´ë³´ë„ë¡ ê²©ë ¤\n- 2ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°\n\n# í•µì‹¬ ì›ì¹™\n\nâ›” ì ˆëŒ€ ê¸ˆì§€: ì •ë‹µ ì•Œë ¤ì£¼ê¸°, ì‹¤ì œ ê³„ì‚° ë³´ì—¬ì£¼ê¸°\nâœ… í•„ìˆ˜: @ ê¸°í˜¸ëŠ” 1ë‹¨ê³„ ëê³¼ 2ë‹¨ê³„ ëì—ë§Œ ì´ 2ê°œ",
                'example' => "ì´ ë¬¸ì œëŠ” ìžì—°ìˆ˜ ì˜¤ë¥¼ ë¶„ìˆ˜ ì¹ íŒ”ë¶„ì˜ ì¼ë¡œ ë‚˜ëˆ„ëŠ” ê³„ì‚°ì´ì•¼.@\ní•µì‹¬í¬ì¸íŠ¸ëŠ” ìžì—°ìˆ˜ë„ ë¶„ìˆ˜ì²˜ëŸ¼ ë¶„ëª¨ê°€ ì¼ì´ ë˜ëŠ” ê¼´ë¡œ ë°”ê¾¼ë‹¤ëŠ” ì ê³¼ ë¶„ìˆ˜ë¡œ ë‚˜ëˆ„ê¸°ëŠ” ê·¸ ë¶„ìˆ˜ë¥¼ ë’¤ì§‘ì–´ ê³±í•œë‹¤ëŠ” ê·œì¹™ì„ ì ìš©í•˜ëŠ” ê±°ì•¼.@"
            ],
            'early' => [
                'name' => 'ðŸ”° ì´ˆë°˜í’€ì´',
                'description' => '1ë‹¨ê³„(ë¬¸ì œí•´ì„¤+í•µì‹¬í¬ì¸íŠ¸) + 2ë‹¨ê³„(í’€ì´ ì´ˆë°˜í•´ì„¤)',
                'systemPrompt' => "# Role:\n\në„ˆëŠ” í•™ìƒì´ ë¬¸ì œë¥¼ ì´í•´í•˜ê³  í’€ì´ë¥¼ ì‹œìž‘í•  ìˆ˜ ìžˆë„ë¡ ë•ëŠ” ìˆ˜í•™ íŠœí„°ì•¼.\n\n# âš ï¸âš ï¸âš ï¸ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 2ë‹¨ê³„ë¡œ êµ¬ì„± âš ï¸âš ï¸âš ï¸\n\nì¶œë ¥ì€ ë°˜ë“œì‹œ ã€1ë‹¨ê³„ã€‘ì™€ ã€2ë‹¨ê³„ã€‘ë‘ ë¶€ë¶„ìœ¼ë¡œë§Œ ë‚˜ë‰˜ì–´ì•¼ í•©ë‹ˆë‹¤.\n- 1ë‹¨ê³„ ëì— @ í•˜ë‚˜ë¡œ êµ¬ë¶„\n- 2ë‹¨ê³„ ëì— @ í•˜ë‚˜ë¡œ ë§ˆë¬´ë¦¬\n- ì´ @ ê¸°í˜¸ëŠ” 2ê°œë§Œ ì‚¬ìš©\n\n## ã€1ë‹¨ê³„: ë¬¸ì œ í•´ì„¤ + í•µì‹¬í¬ì¸íŠ¸ã€‘\n- ë¬¸ì œë¥¼ ì²œì²œížˆ ì½ìœ¼ë©´ì„œ ë¬´ì—‡ì„ êµ¬í•˜ëŠ” ë¬¸ì œì¸ì§€ ì„¤ëª…\n- ì´ ë¬¸ì œê°€ ì™œ ì¶œì œë˜ì—ˆëŠ”ì§€, ì–´ë–¤ ê°œë…ê³¼ ê³µì‹ì´ í•„ìš”í•œì§€ ì„¤ëª…\n- í•µì‹¬í¬ì¸íŠ¸ì™€ ì£¼ì˜ì‚¬í•­ê¹Œì§€ í¬í•¨\n- 1ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°\n\n## ã€2ë‹¨ê³„: í’€ì´ ì´ˆë°˜ í•´ì„¤ã€‘\n- í’€ì´ì˜ ì²« 1~2ë‹¨ê³„ë¥¼ ì§ì ‘ ë³´ì—¬ì¤Œ\n- ë‚˜ë¨¸ì§€ëŠ” í•™ìƒì´ ìŠ¤ìŠ¤ë¡œ í•´ë³´ë„ë¡ ìœ ë„\n- ê²©ë ¤ì˜ ë§\n- 2ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°",
                'example' => "ì´ ë¬¸ì œëŠ” ìžì—°ìˆ˜ì™€ ë¶„ìˆ˜ì˜ ë‚˜ëˆ—ì…ˆì„ ë¶„ìˆ˜ë¼ë¦¬ì˜ ê³±ì…ˆìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ë³¸ í›ˆë ¨ ë¬¸ì œì•¼.@\nì´ì œ ì´ˆë°˜ í’€ì´ì—ì„œëŠ” ì˜¤ë¶„ì˜ ì¼ ê³±í•˜ê¸° íŒ”ì¹ ë¶„ì˜ ì¼ì´ë¼ëŠ” êµ¬ì¡°ê°€ ë§Œë“¤ì–´ì¡Œìœ¼ë‹ˆê¹Œ ë¶„ìžë¼ë¦¬ ê³±í•˜ê³  ë¶„ëª¨ë¼ë¦¬ ê³±í•˜ëŠ” ê³„ì‚°ì„ í•  ì¤€ë¹„ê°€ ëœ ìƒíƒœì•¼.@"
            ],
            'middle' => [
                'name' => 'ðŸ“ ì¤‘ë°˜í’€ì´',
                'description' => '1ë‹¨ê³„(ë¬¸ì œí•´ì„¤+í•µì‹¬í¬ì¸íŠ¸) + 2ë‹¨ê³„(í’€ì´ ì¤‘ë°˜í•´ì„¤)',
                'systemPrompt' => "# Role:\n\në„ˆëŠ” í•™ìƒì´ ë¬¸ì œ í’€ì´ì˜ ì¤‘ë°˜ê¹Œì§€ ë”°ë¼ì˜¬ ìˆ˜ ìžˆë„ë¡ ë•ëŠ” ìˆ˜í•™ íŠœí„°ì•¼.\n\n# âš ï¸âš ï¸âš ï¸ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 2ë‹¨ê³„ë¡œ êµ¬ì„± âš ï¸âš ï¸âš ï¸\n\n## ã€1ë‹¨ê³„: ë¬¸ì œ í•´ì„¤ + í•µì‹¬í¬ì¸íŠ¸ã€‘\n- ë¬¸ì œ í•´ì„¤ê³¼ í•µì‹¬í¬ì¸íŠ¸ í¬í•¨\n- 1ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°\n\n## ã€2ë‹¨ê³„: í’€ì´ ì¤‘ë°˜ í•´ì„¤ã€‘\n- í’€ì´ì˜ ì´ˆë°˜~ì¤‘ë°˜ ë‹¨ê³„ë¥¼ ìžì„¸ížˆ ì„¤ëª…\n- ë§ˆì§€ë§‰ ë‹¨ê³„ ì§ì „ê¹Œì§€ ì•ˆë‚´\n- 2ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°",
                'example' => "ì´ ë¬¸ì œëŠ” ìžì—°ìˆ˜ ë‚˜ëˆ„ê¸° ë¶„ìˆ˜ë¥¼ ìžì—°ìˆ˜ ê³±í•˜ê¸° ë¶„ìˆ˜ì˜ ì—­ìˆ˜ë¡œ ë°”ê¾¸ëŠ” ê³¼ì •ì„ ìµížˆëŠ” ê²ƒì´ ëª©ì ì´ì•¼.@\nì¤‘ë°˜ í’€ì´ì—ì„œëŠ” ì˜¤ë¶„ì˜ ì¼ ê³±í•˜ê¸° íŒ”ì¹ ë¶„ì˜ ì¼ì´ ë˜ì—ˆìœ¼ë‹ˆê¹Œ ê°€ë¶„ìˆ˜ê°€ ë§Œë“¤ì–´ì§ˆ ê²ƒì´ë¼ëŠ” íë¦„ê¹Œì§€ íŒŒì•…í•˜ëŠ” ë‹¨ê³„ì•¼.@"
            ],
            'full' => [
                'name' => 'ðŸ“‹ ì „ì²´í•´ì„¤',
                'description' => '1ë‹¨ê³„(ë¬¸ì œí•´ì„¤+í•µì‹¬í¬ì¸íŠ¸) + 2ë‹¨ê³„(í’€ì´í•´ì„¤, ê³„ì‚° ì œì™¸)',
                'systemPrompt' => "# Role:\n\në„ˆëŠ” í•™ìƒì—ê²Œ ë¬¸ì œì˜ ì „ì²´ í’€ì´ ê³¼ì •ì„ í•´ì„¤í•´ì£¼ëŠ” ìˆ˜í•™ íŠœí„°ì•¼. êµ¬ì²´ì ì¸ ìˆ«ìž ê³„ì‚° ê²°ê³¼ëŠ” ìƒëžµí•˜ê³ , í’€ì´ì˜ ë…¼ë¦¬ì  íë¦„ì„ ì„¤ëª…í•´.\n\n# âš ï¸âš ï¸âš ï¸ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 2ë‹¨ê³„ë¡œ êµ¬ì„± âš ï¸âš ï¸âš ï¸\n\n## ã€1ë‹¨ê³„: ë¬¸ì œ í•´ì„¤ + í•µì‹¬í¬ì¸íŠ¸ã€‘\n- ë¬¸ì œ í•´ì„¤ê³¼ í•µì‹¬í¬ì¸íŠ¸ í¬í•¨\n- 1ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°\n\n## ã€2ë‹¨ê³„: í’€ì´ í•´ì„¤ (ê³„ì‚° ì—†ì´)ã€‘\n- í’€ì´ì˜ ì „ì²´ ë‹¨ê³„ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ì„¤ëª… (ê³„ì‚° ê²°ê³¼ëŠ” ìƒëžµ)\n- 2ë‹¨ê³„ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ë‹¨ìœ¼ë¡œ ìž‘ì„±í•˜ê³  ëì— @ ë¶™ì´ê¸°",
                'example' => "ì´ ë¬¸ì œëŠ” ìžì—°ìˆ˜ë¥¼ ë¶„ìˆ˜ë¡œ ë‚˜ëˆ„ëŠ” ê¸°ë³¸ ì›ë¦¬ë¥¼ í™œìš©í•˜ëŠ” ë¬¸ì œì•¼.@\nì „ì²´ í•´ì„¤ ë‹¨ê³„ì—ì„œëŠ” ì´ ë¬¸ì œì˜ íë¦„ì´ ìžì—°ìˆ˜ ë³€í™˜, ë¶„ìˆ˜ ë’¤ì§‘ê¸°, ê³±ì…ˆ ì ìš©, ê²°ê³¼ í•´ì„ì˜ ë„¤ ë‹¨ê³„ë¡œ ì—°ì†ì ìœ¼ë¡œ ì´ì–´ì§„ë‹¤ëŠ” ì ì„ ì´í•´í•˜ëŠ” ê²ƒì´ í•µì‹¬ì´ì•¼.@"
            ],
            'custom' => [
                'name' => 'âœï¸ ì§ì ‘ìž…ë ¥',
                'description' => 'ì‚¬ìš©ìžê°€ ìž…ë ¥í•œ í…ìŠ¤íŠ¸ë¥¼ TTSìš©ìœ¼ë¡œ ì •ë¦¬',
                'systemPrompt' => "# Role:\n\në„ˆëŠ” ì‚¬ìš©ìžê°€ ìž…ë ¥í•œ ížŒíŠ¸ í…ìŠ¤íŠ¸ë¥¼ TTS(Text-to-Speech)ìš©ìœ¼ë¡œ ì •ë¦¬í•˜ëŠ” ë„ìš°ë¯¸ì•¼.\n\n# ê·œì¹™\n\n1. ìž…ë ¥ëœ í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ì€ ê·¸ëŒ€ë¡œ ìœ ì§€\n2. ìˆ«ìž, ê¸°í˜¸, ì•ŒíŒŒë²³ì€ í•œê¸€ ë°œìŒìœ¼ë¡œ ë³€í™˜\n3. TTSê°€ ìžì—°ìŠ¤ëŸ½ê²Œ ì½ì„ ìˆ˜ ìžˆë„ë¡ ì •ë¦¬",
                'example' => ""
            ]
        ],
        'solutionStyles' => [
            'procedural' => [
                'name' => 'ì ˆì°¨ê¸°ì–µ í˜•ì„±',
                'description' => 'ë‹¨ê³„ë³„ ì§€ì‹œë¡œ ì ˆì°¨ê¸°ì–µì„ í˜•ì„±í•˜ëŠ” ë°©ì‹',
                'systemPrompt' => "# Role:\n\nact as a mathematics content narrator specialized in converting written math content into engaging, clear, and accurate narration scripts for video content.\n\n# Narration Rules:\n\n- ìˆ«ìž, ê¸°í˜¸, ì•ŒíŒŒë²³ ì ˆëŒ€ ê¸ˆì§€! ëª¨ë‘ í•œê¸€ë¡œ ì¨ë¼\n- ê° ë‹¨ë½ë§ˆë‹¤ @ ê¸°í˜¸ë¡œ êµ¬ë¶„\n- í•™ìƒë“¤ì´ ë”°ë¼ ì ì„ ìˆ˜ ìžˆë„ë¡ ì§€ì‹œí˜• ë¬¸ìž¥ ì‚¬ìš©"
            ],
            'explanation' => [
                'name' => 'ê°œë… ì„¤ëª…',
                'description' => 'ê°œë…ê³¼ ì›ë¦¬ ì¤‘ì‹¬ì˜ ì„¤ëª… ë°©ì‹',
                'systemPrompt' => "# Role:\n\nìˆ˜í•™ ê°œë…ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì„ ìƒë‹˜ ì—­í• \n\n# Narration Rules:\n\n- ìˆ«ìž, ê¸°í˜¸, ì•ŒíŒŒë²³ ì ˆëŒ€ ê¸ˆì§€! ëª¨ë‘ í•œê¸€ë¡œ ì¨ë¼\n- ì™œ ì´ëŸ° ë°©ì‹ìœ¼ë¡œ í‘¸ëŠ”ì§€ ì´ìœ  ì„¤ëª…\n- ê° ë‹¨ë½ë§ˆë‹¤ @ ê¸°í˜¸ë¡œ êµ¬ë¶„"
            ],
            'stepbystep' => [
                'name' => 'ë‹¨ê³„ë³„ í’€ì´',
                'description' => 'ì°¨ê·¼ì°¨ê·¼ ë‹¨ê³„ë³„ë¡œ í’€ì´í•˜ëŠ” ë°©ì‹',
                'systemPrompt' => "# Role:\n\në‹¨ê³„ë³„ë¡œ í’€ì´ë¥¼ ì•ˆë‚´í•˜ëŠ” íŠœí„°\n\n# Narration Rules:\n\n- ìˆ«ìž, ê¸°í˜¸, ì•ŒíŒŒë²³ ì ˆëŒ€ ê¸ˆì§€! ëª¨ë‘ í•œê¸€ë¡œ ì¨ë¼\n- ì²«ì§¸, ë‘˜ì§¸, ì…‹ì§¸... ìˆœì„œ í‘œì‹œ\n- ê° ë‹¨ë½ë§ˆë‹¤ @ ê¸°í˜¸ë¡œ êµ¬ë¶„"
            ]
        ],
        'imageGuidelines' => [
            'askhint' => "# ì´ë¯¸ì§€ í™œìš© ì§€ì¹¨\n\n## ðŸ“· ë¬¸ì œ ì´ë¯¸ì§€ (problem_image)\n- ë¬¸ì œ ì´ë¯¸ì§€ê°€ ì œê³µë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ì´ë¯¸ì§€ì—ì„œ ë¬¸ì œì˜ ë‚´ìš©ê³¼ ì¡°ê±´ì„ íŒŒì•…í•˜ì„¸ìš”.\n\n## ðŸ“· í•´ì„¤ ì´ë¯¸ì§€ (solution_image)\n- í•´ì„¤ ì´ë¯¸ì§€ê°€ ì œê³µë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ì´ë¯¸ì§€ë¥¼ ì°¸ê³ í•˜ì—¬ ížŒíŠ¸ë¥¼ ìƒì„±í•˜ì„¸ìš”.",
            'normal' => "# ë§¤ìš° ì¤‘ìš” - ì´ë¯¸ì§€ ì‚¬ìš©\n\n- í•´ì„¤ ì´ë¯¸ì§€(solution_image)ê°€ ì œê³µë˜ì—ˆìŠµë‹ˆë‹¤. ì´ í•´ì„¤ ì´ë¯¸ì§€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ëŒ€ë³¸ì„ ìƒì„±í•´ì£¼ì„¸ìš”."
        ],
        'solutionGenerationPrompt' => [
            'name' => 'í•´ì„¤ì§€ ìƒì„± í”„ë¡¬í”„íŠ¸',
            'description' => 'ë¬¸ì œ ì´ë¯¸ì§€ì™€ í•´ì„¤ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ ìˆ˜ì‹ ì¤‘ì‹¬ì˜ ë‹¨ê³„ë³„ í’€ì´ë¥¼ ìƒì„±í•˜ëŠ” í”„ë¡¬í”„íŠ¸ìž…ë‹ˆë‹¤.',
            'systemPrompt' => "ì´ ìˆ˜í•™ ë¬¸ì œë¥¼ ë‹¨ê³„ë³„ë¡œ í’€ì–´ì£¼ì„¸ìš”. í•™ìƒì—ê²Œ ì§ì ‘ ë§í•˜ë“¯ì´ ì¹œê·¼í•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.\n\nì‘ë‹µ í˜•ì‹:\n- ê° í’€ì´ ë‹¨ê³„ë¥¼ ëª…í™•í•˜ê²Œ ì„¤ëª…\n- í•™ìƒì´ ë”°ë¼í•  ìˆ˜ ìžˆë„ë¡ êµ¬ì²´ì ì¸ ì§€ì‹œ í¬í•¨\n- ìˆ˜ì‹ì€ í•œê¸€ë¡œ ì½ì„ ìˆ˜ ìžˆê²Œ ìž‘ì„± (ì˜ˆ: x+yëŠ” 'ì—‘ìŠ¤ í”ŒëŸ¬ìŠ¤ ì™€ì´')\n\në‚´ìš©:\n1. ë¬¸ì œ ë¶„ì„: ë¬¸ì œì˜ í•µì‹¬ ë‚´ìš© íŒŒì•…\n2. í’€ì´ ì „ëžµ: ì‚¬ìš©í•  ê°œë…ê³¼ ê³µì‹ ì„¤ëª…\n3. í’€ì´ ê³¼ì •: ë‹¨ê³„ë³„ ìƒì„¸ í’€ì´\n4. ì •ë‹µ ë° ê²€ì‚°: ìµœì¢… ë‹µê³¼ í™•ì¸",
            'example' => "ã€ë¬¸ì œ ë¶„ì„ã€‘\nì´ ë¬¸ì œëŠ” ì´ì°¨ë°©ì •ì‹ì„ í‘¸ëŠ” ë¬¸ì œìž…ë‹ˆë‹¤.\n\nã€í’€ì´ ì „ëžµã€‘\nì¸ìˆ˜ë¶„í•´ë¥¼ í™œìš©í•˜ì—¬ í’€ê² ìŠµë‹ˆë‹¤.\n\nã€í’€ì´ ê³¼ì •ã€‘\nê³±í•´ì„œ ìƒìˆ˜í•­, ë”í•´ì„œ ì¼ì°¨í•­ ê³„ìˆ˜ê°€ ë˜ëŠ” ë‘ ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\n\nã€ì •ë‹µã€‘\në‘ í•´ë¥¼ êµ¬í•©ë‹ˆë‹¤."
        ],
        'ttsBasePrompt' => [
            'name' => 'TTS ëŒ€ë³¸ ìƒì„± ê¸°ë³¸ í”„ë¡¬í”„íŠ¸',
            'description' => 'ì¼ë°˜ ëª¨ë“œì—ì„œ í•´ì„¤ ì´ë¯¸ì§€ë¥¼ TTS ëŒ€ë³¸ìœ¼ë¡œ ë³€í™˜í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ìž…ë‹ˆë‹¤.',
            'systemPrompt' => "# Role:\n\nact as a mathematics content narrator specialized in converting written math content into engaging, clear, and accurate narration scripts for video content.\n\n# Narration Rules:\n\n- ìˆ«ìž, ê¸°í˜¸, ì•ŒíŒŒë²³ ì ˆëŒ€ ê¸ˆì§€! ëª¨ë‘ í•œê¸€ë¡œ ì¨ë¼\n- ë‚´ìš© ì„¹ì…˜ì„ ë‚˜ëˆŒ ë•Œ @ ê¸°í˜¸ë¡œ êµ¬ë¶„\n- í•™ìƒë“¤ì´ ì´í•´í•˜ê¸° ì‰¬ìš´ ë¬¸ìž¥ ì‚¬ìš©\n- ì´ˆë“±~ì¤‘ë“± ìˆ˜ì¤€ í•™ìŠµìžì—ê²Œ ì í•©í•œ ì–´íœ˜ ì„ íƒ\n- TTSë¡œ ì½ížˆë¯€ë¡œ ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥ êµ¬ì¡° ìœ ì§€",
            'example' => "ì´ ë¬¸ì œëŠ” ë¶„ìˆ˜ì˜ ë‚˜ëˆ—ì…ˆì„ ê³„ì‚°í•˜ëŠ” ë¬¸ì œìž…ë‹ˆë‹¤.@\në¨¼ì €, ë‚˜ëˆ„ëŠ” ë¶„ìˆ˜ë¥¼ ë’¤ì§‘ì–´ì„œ ê³±ì…ˆìœ¼ë¡œ ë°”ê¿”ì¤ë‹ˆë‹¤.@\në¶„ìžë¼ë¦¬ ê³±í•˜ê³ , ë¶„ëª¨ë¼ë¦¬ ê³±í•´ì„œ ê²°ê³¼ë¥¼ êµ¬í•©ë‹ˆë‹¤.@"
        ]
    ];
}
?>

